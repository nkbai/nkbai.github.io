import{_ as a,c as e,o as n,a as s}from"./app.3dd4ae37.js";const m='{"title":"\u5C0F\u7A0B\u5E8F\u901A\u7528\u8D8A\u6743\u6F0F\u6D1E\u5206\u6790","description":"","frontmatter":{"title":"\u5C0F\u7A0B\u5E8F\u901A\u7528\u8D8A\u6743\u6F0F\u6D1E\u5206\u6790","date":"2022-08-21T13:57:03.000Z","hide":false,"tags":["security","app","android"],"categories":["\u6280\u672F\u76F8\u5173"]},"headers":[{"level":2,"title":"\u5FAE\u4FE1\u5C0F\u7A0B\u5E8F\u7684\u6F0F\u6D1E\u63CF\u8FF0","slug":"\u5FAE\u4FE1\u5C0F\u7A0B\u5E8F\u7684\u6F0F\u6D1E\u63CF\u8FF0"},{"level":2,"title":"tiktok\u7684\u6F0F\u6D1E","slug":"tiktok\u7684\u6F0F\u6D1E"},{"level":2,"title":"alipay\u7684\u6F0F\u6D1E","slug":"alipay\u7684\u6F0F\u6D1E"},{"level":2,"title":"\u5C0F\u7A0B\u5E8F \u8EAB\u4EFD\u6807\u8BC6","slug":"\u5C0F\u7A0B\u5E8F-\u8EAB\u4EFD\u6807\u8BC6"},{"level":2,"title":"\u51E0\u79CD\u8D8A\u6743\u573A\u666F","slug":"\u51E0\u79CD\u8D8A\u6743\u573A\u666F"},{"level":3,"title":"\u57FA\u4E8E\u57DF\u540D\u8BA4\u8BC1\u7684","slug":"\u57FA\u4E8E\u57DF\u540D\u8BA4\u8BC1\u7684"},{"level":3,"title":"\u901A\u8FC7frame\u6765\u8D8A\u6743","slug":"\u901A\u8FC7frame\u6765\u8D8A\u6743"},{"level":3,"title":"appid\u8D8A\u6743","slug":"appid\u8D8A\u6743"},{"level":3,"title":"Capability \u8D8A\u6743","slug":"capability-\u8D8A\u6743"},{"level":2,"title":"\u5176\u4ED6","slug":"\u5176\u4ED6"},{"level":3,"title":"\u4ECE\u4E00\u4E2A\u6F0F\u6D1E\u63A8\u5E7F\u5F00\u6765\u7684\u65B9\u6CD5\u8BBA","slug":"\u4ECE\u4E00\u4E2A\u6F0F\u6D1E\u63A8\u5E7F\u5F00\u6765\u7684\u65B9\u6CD5\u8BBA"},{"level":3,"title":"\u5206\u6790\u8FC7\u7A0B\u503C\u5F97\u5B66\u4E60","slug":"\u5206\u6790\u8FC7\u7A0B\u503C\u5F97\u5B66\u4E60"},{"level":3,"title":"\u6587\u7AE0\u63D0\u5230\u7684\u4E00\u4E2A\u4FEE\u590D\u5EFA\u8BAE","slug":"\u6587\u7AE0\u63D0\u5230\u7684\u4E00\u4E2A\u4FEE\u590D\u5EFA\u8BAE"}],"relativePath":"app_security/Identity_Confusion_in_WebView-based_Mobile_App-in-app_Ecosystems.md"}',t={},i=s(`<p>\u6587\u7AE0\u6765\u81EA:<a href="https://www.usenix.org/system/files/sec22-zhang-lei.pdf" target="_blank" rel="noopener noreferrer">https://www.usenix.org/system/files/sec22-zhang-lei.pdf</a></p><p>\u8FD9\u7BC7\u6587\u7AE0\u5206\u6790\u7684\u5BF9\u8C61\u662F\u5404\u79CD\u5C0F\u7A0B\u5E8F\u5E73\u53F0,\u6BD4\u5982\u5FAE\u4FE1,tiktok,\u5934\u6761\u7B49,\u8FD9\u4E9Bapp\u4E0A\u9762\u53EF\u4EE5\u8FD0\u884C\u5404\u79CD\u5C0F\u7A0B\u5E8F,\u4F46\u662F\u56E0\u4E3A\u5B9E\u73B0\u65B9\u5F0F\u5B58\u5728\u5404\u79CD\u5404\u6837\u7684\u95EE\u9898,\u5BFC\u81F4\u4E86\u8D8A\u6743\u6F0F\u6D1E.</p><p>\u6587\u7AE0\u5E94\u8BE5\u8BF4\u662F\u4ECE\u5FAE\u4FE1\u7684\u4E00\u4E2A\u6F0F\u6D1E\u63A8\u5E7F\u51FA\u53BB,\u4F5C\u4E3A\u56E0\u5B50,\u5206\u6790\u4E86\u4F17\u591A\u7684\u77E5\u540D\u5C0F\u7A0B\u5E8F\u5E73\u53F0,\u53D1\u73B0\u90FD\u5B58\u5728\u5404\u79CD\u5404\u6837\u7684\u95EE\u9898.</p><h2 id="\u5FAE\u4FE1\u5C0F\u7A0B\u5E8F\u7684\u6F0F\u6D1E\u63CF\u8FF0" tabindex="-1">\u5FAE\u4FE1\u5C0F\u7A0B\u5E8F\u7684\u6F0F\u6D1E\u63CF\u8FF0 <a class="header-anchor" href="#\u5FAE\u4FE1\u5C0F\u7A0B\u5E8F\u7684\u6F0F\u6D1E\u63CF\u8FF0" aria-hidden="true">#</a></h2><p><img alt="" data-src="img/weixin_pinduoduo.png" loading="lazy" class="lazy"></p><p>\u4E3B\u8981\u662F\u5B58\u5728\u4E09\u4E2A\u95EE\u9898:</p><ul><li><ol><li>\u5FAE\u4FE1\u5C0F\u7A0B\u5E8F\u5E73\u53F0\u57DF\u540D\u6821\u9A8C\u6709\u95EE\u9898,\u5BFC\u81F4\u8BEF\u62A5\u5176\u4ED6\u57DF\u540D\u7684\u7F51\u9875\u5F53\u505A\u62FC\u591A\u591A\u7684\u5C0F\u7A0B\u5E8F</li></ol></li><li><ol start="2"><li>\u62FC\u591A\u591A\u5C0F\u7A0B\u5E8F\u540E\u7AEFserver\u6CA1\u6709\u5BF9\u7B7E\u540Dapi\u8FD9\u4E48\u91CD\u8981\u7684api\u505A\u9274\u6743\u4FDD\u62A4</li></ol></li><li><ol start="3"><li>\u5FAE\u4FE1\u5C0F\u7A0B\u5E8F\u5E73\u53F0\u79C1\u6709api,\u4FDD\u62A4\u4E0D\u5230\u4F4D,\u53EF\u4EE5\u88AB\u5C0F\u7A0B\u5E8F\u8C03\u7528(\u4E0B\u8F7D,\u6309\u7167app\u7684. \u4F30\u8BA1\u5176\u4ED6\u5E73\u53F0\u591A\u534A\u4E5F\u6709\u8FD9\u6837\u7684\u529F\u80FD)</li></ol><h2 id="tiktok\u7684\u6F0F\u6D1E" tabindex="-1">tiktok\u7684\u6F0F\u6D1E <a class="header-anchor" href="#tiktok\u7684\u6F0F\u6D1E" aria-hidden="true">#</a></h2><p>\u201Cwindow.location.href = htttp://maliciousbenign.com\u201D. Since \u201Chtttp\u201D is not a supported scheme, this URL will trigger the race condition of onPageStarted.</p><h2 id="alipay\u7684\u6F0F\u6D1E" tabindex="-1">alipay\u7684\u6F0F\u6D1E <a class="header-anchor" href="#alipay\u7684\u6F0F\u6D1E" aria-hidden="true">#</a></h2><p>alipay\u7684\u95EE\u9898\u5728\u4E8Ehidden api(\u4E00\u4E2Arpc api) \u4E0D\u5E94\u8BE5\u88AB\u5C0F\u7A0B\u5E8F\u8C03\u7528,\u4F46\u662F\u6CA1\u6709\u505A\u4FDD\u62A4,\u5BFC\u81F4\u4EFB\u610F\u5C0F\u7A0B\u5E8F\u90FD\u53EF\u4EE5\u64CD\u4F5Crpc api.</p><h2 id="\u5C0F\u7A0B\u5E8F-\u8EAB\u4EFD\u6807\u8BC6" tabindex="-1">\u5C0F\u7A0B\u5E8F \u8EAB\u4EFD\u6807\u8BC6 <a class="header-anchor" href="#\u5C0F\u7A0B\u5E8F-\u8EAB\u4EFD\u6807\u8BC6" aria-hidden="true">#</a></h2><p>\u5E73\u53F0\u8BC6\u522B\u5C0F\u7A0B\u5E8F\u4E3B\u8981\u6709\u4E24\u4E2A:</p><ul><li>\u57DF\u540D \u9650\u5236\u52A0\u8F7D\u7684\u8303\u56F4</li><li>appid \u9650\u5236api\u7684\u8BBF\u95EE\u8303\u56F4</li><li>Capability \u7CBE\u7EC6\u5316\u6388\u6743,\u5C0F\u7A0B\u5E8F\u53EF\u4EE5\u8BBF\u95EE\u90A3\u4E9Bapi. \u53EA\u6709\u5FAE\u4FE1\u4EE5\u53CAUnionPay\u6709,\u5176\u4ED6\u90FD\u6CA1\u91C7\u7528.</li></ul></li></ul><h2 id="\u51E0\u79CD\u8D8A\u6743\u573A\u666F" tabindex="-1">\u51E0\u79CD\u8D8A\u6743\u573A\u666F <a class="header-anchor" href="#\u51E0\u79CD\u8D8A\u6743\u573A\u666F" aria-hidden="true">#</a></h2><h3 id="\u57FA\u4E8E\u57DF\u540D\u8BA4\u8BC1\u7684" tabindex="-1">\u57FA\u4E8E\u57DF\u540D\u8BA4\u8BC1\u7684 <a class="header-anchor" href="#\u57FA\u4E8E\u57DF\u540D\u8BA4\u8BC1\u7684" aria-hidden="true">#</a></h3><p>Domain Name Confusion</p><p><img alt="" data-src="img/webview_geturl.png" loading="lazy" class="lazy"></p><h4 id="\u5E38\u89C1\u7684\u57DF\u540D\u6821\u9A8C\u95EE\u9898" tabindex="-1">\u5E38\u89C1\u7684\u57DF\u540D\u6821\u9A8C\u95EE\u9898 <a class="header-anchor" href="#\u5E38\u89C1\u7684\u57DF\u540D\u6821\u9A8C\u95EE\u9898" aria-hidden="true">#</a></h4><h5 id="\u767D\u540D\u5355\u673A\u5236" tabindex="-1">\u767D\u540D\u5355\u673A\u5236 <a class="header-anchor" href="#\u767D\u540D\u5355\u673A\u5236" aria-hidden="true">#</a></h5><p>\u767D\u540D\u5355\u6821\u9A8C\u673A\u5236\u5728\u5C0F\u7A0B\u5E8F\u5E73\u53F0,\u4F46\u662F\u767D\u540D\u5355\u7684\u63D0\u4F9B\u65B9\u5728\u5C0F\u7A0B\u5E8F,\u4E24\u79CD\u5BF9\u4E8E\u6821\u9A8C\u89C4\u5219\u7684\u7406\u89E3\u4E0D\u4E00\u81F4,\u5BFC\u81F4\u51FA\u95EE\u9898. \u6BD4\u5982 \u5C0F\u7A0B\u5E8F\u5E73\u53F0\u4EE5endsWith\u6765\u6821\u9A8C\u5C0F\u7A0B\u5E8F\u63D0\u4F9B\u7684\u540D\u5355,<a href="http://xn--bengin-2e8i94c4v897gf0fftrnihw98e.com" target="_blank" rel="noopener noreferrer">\u4F46\u662F\u5C0F\u7A0B\u5E8F\u63D0\u4F9B\u4E86bengin.com</a>,\u5BFC\u81F4maliciousbenign.com\u53EF\u4EE5\u901A\u8FC7\u6821\u9A8C</p><h4 id="url-parsing\u6709\u95EE\u9898" tabindex="-1">url parsing\u6709\u95EE\u9898 <a class="header-anchor" href="#url-parsing\u6709\u95EE\u9898" aria-hidden="true">#</a></h4><p><a href="https://benign.com" target="_blank" rel="noopener noreferrer">https://benign.com</a>:x@ <a href="http://malicious.com" target="_blank" rel="noopener noreferrer">malicious.com</a><a href="http://xn--malicious-fv8of05aziugtwyuq9l3b8ngpr3g.com" target="_blank" rel="noopener noreferrer">\u6B63\u786E\u7684\u57DF\u540D\u5E94\u8BE5\u662Fmalicious.com</a>,<a href="http://xn--bengin-vy7in5etuk8pd808emj3f.com" target="_blank" rel="noopener noreferrer">\u4F46\u662F\u5374\u8BC6\u522B\u4E3Abengin.com</a>, \u591A\u534A\u89C1\u4E8E\u6B63\u5219\u8868\u8FBE\u5F0F\u8BC6\u522B.</p><h5 id="javascript-\u6CA1\u6709\u6B63\u786E\u8BC6\u522B" tabindex="-1">javascript:// \u6CA1\u6709\u6B63\u786E\u8BC6\u522B <a class="header-anchor" href="#javascript-\u6CA1\u6709\u6B63\u786E\u8BC6\u522B" aria-hidden="true">#</a></h5><p>\u76EE\u524D\u5E94\u8BE5\u6BD4\u8F83\u5C11\u624D\u5BF9,<code>loadUrl(&quot;javascript://alert(3)&quot;)</code></p><h5 id="\u5D4C\u5957iframe\u95EE\u9898" tabindex="-1">\u5D4C\u5957iframe\u95EE\u9898 <a class="header-anchor" href="#\u5D4C\u5957iframe\u95EE\u9898" aria-hidden="true">#</a></h5><p>evil \u6545\u610F\u5D4C\u5957\u4E00\u4E2A\u5408\u6CD5\u7684\u57DF\u540D,\u6216\u8005\u53CD\u8FC7\u6765,\u5408\u6CD5\u7684\u57DF\u540D\u6709\u6F0F\u6D1E,\u53EF\u4EE5\u5C06\u4E00\u4E2Aevil.com\u5D4C\u5957\u5728\u5B83\u7684iframe\u4E2D</p><h5 id="\u57DF\u540D\u8D8A\u6743\u7684poc" tabindex="-1">\u57DF\u540D\u8D8A\u6743\u7684poc <a class="header-anchor" href="#\u57DF\u540D\u8D8A\u6743\u7684poc" aria-hidden="true">#</a></h5><div class="language-javascript line-numbers-mode"><pre><code> <span class="token comment">//JavaScript</span>
window<span class="token punctuation">.</span><span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
res <span class="token operator">=</span> nativeInterface<span class="token punctuation">.</span><span class="token function">framelessPostMessage</span><span class="token punctuation">(</span>\u2019
<span class="token punctuation">{</span><span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string-property property">&quot;func&quot;</span><span class="token operator">:</span><span class="token string">&quot;authentication.getAuthToken&quot;</span><span class="token punctuation">,</span><span class="token string-property property">&quot; args&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;privileged.com&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">}</span>\u2019<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//res can be leaked to malicious server</span>
<span class="token operator">...</span> <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">&quot;https://privileged.com/&quot;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="\u901A\u8FC7frame\u6765\u8D8A\u6743" tabindex="-1">\u901A\u8FC7frame\u6765\u8D8A\u6743 <a class="header-anchor" href="#\u901A\u8FC7frame\u6765\u8D8A\u6743" aria-hidden="true">#</a></h3><p><a href="http://malicious.com" target="_blank" rel="noopener noreferrer">malicious.com</a> \u4F5C\u4E3A privileged.com\u7684\u4E00\u4E2Aiframe\u51FA\u73B0</p><p>\u56E0\u4E3A\u5C0F\u7A0B\u5E8F\u662F\u6BD4\u8F83\u5E7F\u6CDB\u7684,\u96BE\u514D\u6709\u67D0\u4E2A\u5C0F\u7A0B\u5E8F\u5B9E\u73B0\u4E0D\u4E25\u8C28,\u5B58\u5728\u8FD9\u6837\u7684\u95EE\u9898.</p><h3 id="appid\u8D8A\u6743" tabindex="-1">appid\u8D8A\u6743 <a class="header-anchor" href="#appid\u8D8A\u6743" aria-hidden="true">#</a></h3><p>\u5192\u5145\u5176\u4ED6\u5C0F\u7A0B\u5E8F,\u4E3E\u7684\u4F8B\u5B50\u90FD\u662F\u6839\u636E\u57DF\u540D\u6765\u505A\u5C0F\u7A0B\u5E8F\u8EAB\u4EFD\u5224\u65AD\u7684.</p><h3 id="capability-\u8D8A\u6743" tabindex="-1">Capability \u8D8A\u6743 <a class="header-anchor" href="#capability-\u8D8A\u6743" aria-hidden="true">#</a></h3><ul><li><ol><li>\u5C0F\u7A0B\u5E8F\u5E73\u53F0\u7684\u79C1\u6709api\u6CA1\u6709\u4FDD\u62A4\u597D</li></ol></li><li><ol start="2"><li>\u5C0F\u7A0B\u5E8F\u7684\u7279\u6743api,\u6BD4\u5982\u7B7E\u540Dapi,\u6CA1\u6709\u4FDD\u62A4\u597D.</li></ol></li></ul><h2 id="\u5176\u4ED6" tabindex="-1">\u5176\u4ED6 <a class="header-anchor" href="#\u5176\u4ED6" aria-hidden="true">#</a></h2><h3 id="\u4ECE\u4E00\u4E2A\u6F0F\u6D1E\u63A8\u5E7F\u5F00\u6765\u7684\u65B9\u6CD5\u8BBA" tabindex="-1">\u4ECE\u4E00\u4E2A\u6F0F\u6D1E\u63A8\u5E7F\u5F00\u6765\u7684\u65B9\u6CD5\u8BBA <a class="header-anchor" href="#\u4ECE\u4E00\u4E2A\u6F0F\u6D1E\u63A8\u5E7F\u5F00\u6765\u7684\u65B9\u6CD5\u8BBA" aria-hidden="true">#</a></h3><p>\u4ECE\u5FAE\u4FE1\u7684\u4E00\u4E2A\u6F0F\u6D1E,\u63A8\u5E7F\u5230\u6240\u6709\u5E73\u53F0,\u5982\u679C\u53EA\u662F\u5FAE\u4FE1\u7684\u4E00\u4E2A\u6F0F\u6D1E,\u662F\u5F62\u4E0D\u6210\u9AD8\u8D28\u91CF\u7684\u8BBA\u6587\u7684. \u5C0F\u7A0B\u5E8F\u672C\u8EAB\u662F\u4E00\u4E2A\u6BD4\u8F83\u5C0F\u7684\u9886\u57DF,\u4F46\u662F\u8FD1\u5E74\u6765\u9876\u7EA7app\u57FA\u672C\u90FD\u652F\u6301\u4E86\u8FD9\u4E2A\u7279\u6027,\u5BFC\u81F4\u5176\u5F71\u54CD\u8303\u56F4\u5176\u5B9E\u4E0D\u5C0F.</p><h3 id="\u5206\u6790\u8FC7\u7A0B\u503C\u5F97\u5B66\u4E60" tabindex="-1">\u5206\u6790\u8FC7\u7A0B\u503C\u5F97\u5B66\u4E60 <a class="header-anchor" href="#\u5206\u6790\u8FC7\u7A0B\u503C\u5F97\u5B66\u4E60" aria-hidden="true">#</a></h3><p>\u6BD4\u5982<code>Capability confusion analysis</code> :</p><ol><li>\u9759\u6001\u5206\u6790,\u63D0\u524D\u76F8\u90BB\u7684api</li><li>\u770B\u770B\u52A8\u6001\u8C03\u7528\u7684\u7ED3\u679C</li><li>\u5982\u679C\u67D0\u4E2Aapi\u603B\u662F\u5728privileged API\u4E4B\u524D\u88AB\u8C03\u7528,\u90A3\u4E48\u4ED6\u5C31\u662F\u4E00\u4E2Asecret api.</li></ol><h3 id="\u6587\u7AE0\u63D0\u5230\u7684\u4E00\u4E2A\u4FEE\u590D\u5EFA\u8BAE" tabindex="-1">\u6587\u7AE0\u63D0\u5230\u7684\u4E00\u4E2A\u4FEE\u590D\u5EFA\u8BAE <a class="header-anchor" href="#\u6587\u7AE0\u63D0\u5230\u7684\u4E00\u4E2A\u4FEE\u590D\u5EFA\u8BAE" aria-hidden="true">#</a></h3><p><a href="https://seclab.illinois.edu/wp-content/uploads/2016/10/draco-ccs-2016.pdf" target="_blank" rel="noopener noreferrer">A system for uniform and fine-grained access control for web code on android</a></p>`,37),p=[i];function r(o,l,c,d,u,h){return n(),e("div",null,p)}var b=a(t,[["render",r]]);export{m as __pageData,b as default};
