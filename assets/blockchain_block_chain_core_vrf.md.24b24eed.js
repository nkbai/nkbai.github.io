import{o as s,c as a,f as n,b as l,d as t,e}from"./app.9c6df70b.js";const m='{"title":"一篇文章搞懂VRF","description":"","frontmatter":{"title":"一篇文章搞懂VRF","date":"2019-06-16T03:57:03.000Z","draft":false,"markup":"mmark"},"headers":[{"level":2,"title":"一种错误的实现","slug":"一种错误的实现"},{"level":3,"title":"椭圆曲线签名算法原理","slug":"椭圆曲线签名算法原理"},{"level":3,"title":"比特币和以太坊中的数字签名可以做VRF么?","slug":"比特币和以太坊中的数字签名可以做vrf么"},{"level":2,"title":"一种正确的实现","slug":"一种正确的实现"},{"level":3,"title":"公式推导","slug":"公式推导"},{"level":2,"title":"在椭圆曲线上的实现","slug":"在椭圆曲线上的实现"},{"level":3,"title":"接口原型","slug":"接口原型"},{"level":3,"title":"使用方法","slug":"使用方法"},{"level":2,"title":"推荐实现","slug":"推荐实现"},{"level":3,"title":"1. 谷歌的keytransparency项目","slug":"_1-谷歌的keytransparency项目"},{"level":3,"title":"2. Spectrum上使用的VRF","slug":"_2-spectrum上使用的vrf"},{"level":3,"title":"3. witnet上的VRF","slug":"_3-witnet上的vrf"}],"relativePath":"blockchain/block_chain_core/vrf.md","lastUpdated":1599101312000}',p={},i=l("ul",null,[l("li",null,[l("a",{href:"#%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E6%90%9E%E6%87%82vrf"},"一篇文章搞懂VRF")])],-1),r=l("ul",null,[l("li",null,[l("a",{href:"#%E4%B8%80%E7%A7%8D%E9%94%99%E8%AF%AF%E7%9A%84%E5%AE%9E%E7%8E%B0"},"一种错误的实现"),l("ul",null,[l("li",null,[l("a",{href:"#%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF%E7%AD%BE%E5%90%8D%E7%AE%97%E6%B3%95%E5%8E%9F%E7%90%86"},"椭圆曲线签名算法原理"),l("ul",null,[l("li",null,[l("a",{href:"#%E9%82%A3%E4%B9%88%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF%E7%9A%84%E7%AD%BE%E5%90%8D%E5%8F%AF%E5%90%A6%E5%BD%93%E5%81%9Avrf%E5%91%A2"},"那么椭圆曲线的签名可否当做VRF呢?")])])]),l("li",null,[l("a",{href:"#%E6%AF%94%E7%89%B9%E5%B8%81%E5%92%8C%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%B8%AD%E7%9A%84%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D%E5%8F%AF%E4%BB%A5%E5%81%9Avrf%E4%B9%88"},"比特币和以太坊中的数字签名可以做VRF么?")])])]),l("li",null,[l("a",{href:"#%E4%B8%80%E7%A7%8D%E6%AD%A3%E7%A1%AE%E7%9A%84%E5%AE%9E%E7%8E%B0"},"一种正确的实现"),l("ul",null,[l("li",null,[l("a",{href:"#%E5%85%AC%E5%BC%8F%E6%8E%A8%E5%AF%BC"},"公式推导"),l("ul",null,[l("li",null,[l("a",{href:"#h1%E6%8A%8A%E4%BB%BB%E6%84%8F%E4%BF%A1%E6%81%AF%E6%98%A0%E5%B0%84%E5%88%B0%E6%9B%B2%E7%BA%BF%E4%B8%8A%E7%9A%84%E7%82%B9"},"H1:把任意信息映射到曲线上的点")]),l("li",null,[l("a",{href:"#h2-%E6%98%A0%E5%B0%84%E4%BB%BB%E6%84%8F%E4%BF%A1%E6%81%AF%E4%B8%BA1q"},"H2: 映射任意信息为(1,q)")]),l("li",null,[l("a",{href:"#%E8%AE%A1%E7%AE%97%E9%9A%8F%E6%9C%BA%E6%95%B0"},"计算随机数")]),l("li",null,[l("a",{href:"#%E9%9A%8F%E6%9C%BA%E6%95%B0%E7%9A%84proof"},"随机数的proof")]),l("li",null,[l("a",{href:"#%E5%A6%82%E4%BD%95%E9%AA%8C%E8%AF%81"},"如何验证")]),l("li",null,[l("a",{href:"#%E7%94%9F%E6%88%90gr-hr"},[t("生成"),l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msup",null,[l("mi",null,"g"),l("mi",null,"r")])]),l("annotation",{encoding:"application/x-tex"},"g^r")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.858832em","vertical-align":"-0.19444em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.664392em"}},[l("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])])])])])])])])]),t(" , "),l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msup",null,[l("mi",null,"h"),l("mi",null,"r")])]),l("annotation",{encoding:"application/x-tex"},"h^r")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.69444em","vertical-align":"0em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal"},"h"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.664392em"}},[l("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])])])])])])])])])])])])])])]),l("li",null,[l("a",{href:"#%E5%9C%A8%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF%E4%B8%8A%E7%9A%84%E5%AE%9E%E7%8E%B0"},"在椭圆曲线上的实现"),l("ul",null,[l("li",null,[l("a",{href:"#%E6%8E%A5%E5%8F%A3%E5%8E%9F%E5%9E%8B"},"接口原型")]),l("li",null,[l("a",{href:"#%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95"},"使用方法")])])]),l("li",null,[l("a",{href:"#%E6%8E%A8%E8%8D%90%E5%AE%9E%E7%8E%B0"},"推荐实现"),l("ul",null,[l("li",null,[l("a",{href:"#1-%E8%B0%B7%E6%AD%8C%E7%9A%84keytransparency%E9%A1%B9%E7%9B%AE"},"1. 谷歌的keytransparency项目")]),l("li",null,[l("a",{href:"#2-spectrum%E4%B8%8A%E4%BD%BF%E7%94%A8%E7%9A%84vrf"},"2. Spectrum上使用的VRF")]),l("li",null,[l("a",{href:"#3-witnet%E4%B8%8A%E7%9A%84vrf"},"3. witnet上的VRF")])])])],-1),c=l("p",null,"什么是VRF,VRF全称是verifiable random function ,也就是可验证随机数. 他有两个特性, 他产生的是随机数,第二还是可验证的.",-1),o=l("p",null,[t("我直接引用"),l("a",{href:"https://en.wikipedia.org/wiki/Verifiable_random_function",target:"_blank",rel:"noopener noreferrer"},"维基百科上的VRF"),t(",就是说针对一个输入x,一个私钥SK的拥有者可以计算"),l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"y"),l("mo",null,"="),l("mi",null,"F"),l("mi",null,"S"),l("mi",null,"K"),l("mo",{stretchy:"false"},"("),l("mi",null,"x"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"y=FSK(x)")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.625em","vertical-align":"-0.19444em"}}),l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"y"),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),l("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"FS"),l("span",{class:"mord mathnormal",style:{"margin-right":"0.07153em"}},"K"),l("span",{class:"mopen"},"("),l("span",{class:"mord mathnormal"},"x"),l("span",{class:"mclose"},")")])])]),t("和证明"),l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P"),l("mi",null,"S"),l("mi",null,"K"),l("mo",{stretchy:"false"},"("),l("mi",null,"x"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"PSK(x)")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),l("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"PS"),l("span",{class:"mord mathnormal",style:{"margin-right":"0.07153em"}},"K"),l("span",{class:"mopen"},"("),l("span",{class:"mord mathnormal"},"x"),l("span",{class:"mclose"},")")])])]),t(". 依据证明(proof)和SK对应的公钥PK("),l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P"),l("mi",null,"K"),l("mo",null,"="),l("msup",null,[l("mi",null,"g"),l("mrow",null,[l("mi",null,"S"),l("mi",null,"K")])])]),l("annotation",{encoding:"application/x-tex"},"PK=g^{SK}")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.68333em","vertical-align":"0em"}}),l("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"P"),l("span",{class:"mord mathnormal",style:{"margin-right":"0.07153em"}},"K"),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1.035771em","vertical-align":"-0.19444em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.8413309999999999em"}},[l("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.05764em"}},"S"),l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.07153em"}},"K")])])])])])])])])])])]),t("),任何人都可以验证y是被正确计算的,但是不能知道SK是什么.")],-1),h=l("p",null,"原文中提到了使用双线性映射来做这个事情,当然VRF可以有很多种不同的实现,只要满足上面提出的条件即可.一个是随机数,另一个是可验证.",-1),u=l("p",null,"简单解释一下:",-1),g=l("ol",null,[l("li",null,"验证人只知道x,在SK持有人没有广播之前不知道随机数是什么"),l("li",null,"SK持有人无法伪造随机数,一旦x确定,随机数也确定了. 这就是所谓的随机数(除了SK持有人之外,其他任何人事先不知道) 可验证(知道PK的任何人都知道SK生成的随机数是否合规)")],-1),d=l("h2",{id:"一种错误的实现"},[l("a",{class:"header-anchor",href:"#一种错误的实现","aria-hidden":"true"},"#"),t(" 一种错误的实现")],-1),y=l("p",null,"首先我们常用的数字签名可否用作VRF呢?",-1),k=l("h3",{id:"椭圆曲线签名算法原理"},[l("a",{class:"header-anchor",href:"#椭圆曲线签名算法原理","aria-hidden":"true"},"#"),t(" 椭圆曲线签名算法原理")],-1),b=l("p",null,[t("假设私钥为k,那么公钥"),l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"K"),l("mo",null,"="),l("mi",null,"k"),l("mi",null,"G")]),l("annotation",{encoding:"application/x-tex"},"K=kG")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.68333em","vertical-align":"0em"}}),l("span",{class:"mord mathnormal",style:{"margin-right":"0.07153em"}},"K"),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.69444em","vertical-align":"0em"}}),l("span",{class:"mord mathnormal",style:{"margin-right":"0.03148em"}},"k"),l("span",{class:"mord mathnormal"},"G")])])]),t(",其中G为G点(就是椭圆曲线的公共参数,可以忽略). 签名的过程如下:")],-1),v=l("ol",null,[l("li",null,[t("选择随机数r,计算"),l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P"),l("mo",null,"="),l("mi",null,"r"),l("mi",null,"G")]),l("annotation",{encoding:"application/x-tex"},"P=rG")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.68333em","vertical-align":"0em"}}),l("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"P"),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.68333em","vertical-align":"0em"}}),l("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"r"),l("span",{class:"mord mathnormal"},"G")])])]),t(",P实际上就是曲线上的一个点")]),l("li",null,[t("计算"),l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"s"),l("mo",null,"="),l("mfrac",null,[l("mrow",null,[l("mi",null,"m"),l("mo",null,"+"),l("mi",null,"k"),l("mi",null,"x")]),l("mi",null,"r")])]),l("annotation",{encoding:"application/x-tex"},"s=\\frac {m+kx} r")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.43056em","vertical-align":"0em"}}),l("span",{class:"mord mathnormal"},"s"),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1.2251079999999999em","vertical-align":"-0.345em"}}),l("span",{class:"mord"},[l("span",{class:"mopen nulldelimiter"}),l("span",{class:"mfrac"},[l("span",{class:"vlist-t vlist-t2"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.8801079999999999em"}},[l("span",{style:{top:"-2.6550000000000002em"}},[l("span",{class:"pstrut",style:{height:"3em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])]),l("span",{style:{top:"-3.23em"}},[l("span",{class:"pstrut",style:{height:"3em"}}),l("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),l("span",{style:{top:"-3.394em"}},[l("span",{class:"pstrut",style:{height:"3em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mtight"},[l("span",{class:"mord mathnormal mtight"},"m"),l("span",{class:"mbin mtight"},"+"),l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k"),l("span",{class:"mord mathnormal mtight"},"x")])])])]),l("span",{class:"vlist-s"},"​")]),l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.345em"}},[l("span")])])])]),l("span",{class:"mclose nulldelimiter"})])])])]),t(",其中m就是公共信息,比如是一个以太坊交易的Hash值. 这里的x是P的x坐标.")]),l("li",null,"将消息m和签名{rG,s}发送给接收方 接收方在事先知道公钥K的情况下,就很容易验证签名和m是否是对应关系. 验证签名的过程: 计算$\\frac {mG} s + \\frac {xK} s $,然后与rG比较,如果相等说明是对应关系.其中x是rG这个点的x坐标")],-1),f=l("p",null,"为什么这样可以呢,来看一下简单的推导过程:",-1),E=t(" \\begin{eqnarray} & \\frac {mG} s + \\frac {xK} s \\\\ =& \\frac {mG} s + \\frac {x(kG)} s \\\\ =& \\frac {(m+xk)G} s \\\\ =& \\frac {r(m+xk)G} {m+kx} \\\\ =& rG \\end{eqnarray} "),x=l("p",null,[l("strong",null,[t("注意: "),l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"s"),l("mo",null,"="),l("mfrac",null,[l("mrow",null,[l("mi",null,"m"),l("mo",null,"+"),l("mi",null,"k"),l("mi",null,"x")]),l("mi",null,"r")])]),l("annotation",{encoding:"application/x-tex"},"s=\\frac {m+kx} r")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.43056em","vertical-align":"0em"}}),l("span",{class:"mord mathnormal"},"s"),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1.2251079999999999em","vertical-align":"-0.345em"}}),l("span",{class:"mord"},[l("span",{class:"mopen nulldelimiter"}),l("span",{class:"mfrac"},[l("span",{class:"vlist-t vlist-t2"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.8801079999999999em"}},[l("span",{style:{top:"-2.6550000000000002em"}},[l("span",{class:"pstrut",style:{height:"3em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])]),l("span",{style:{top:"-3.23em"}},[l("span",{class:"pstrut",style:{height:"3em"}}),l("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),l("span",{style:{top:"-3.394em"}},[l("span",{class:"pstrut",style:{height:"3em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mtight"},[l("span",{class:"mord mathnormal mtight"},"m"),l("span",{class:"mbin mtight"},"+"),l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k"),l("span",{class:"mord mathnormal mtight"},"x")])])])]),l("span",{class:"vlist-s"},"​")]),l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.345em"}},[l("span")])])])]),l("span",{class:"mclose nulldelimiter"})])])])])])],-1),w=l("h4",{id:"那么椭圆曲线的签名可否当做vrf呢"},[l("a",{class:"header-anchor",href:"#那么椭圆曲线的签名可否当做vrf呢","aria-hidden":"true"},"#"),t(" 那么椭圆曲线的签名可否当做VRF呢?")],-1),z=l("p",null,[t("首先第一点,固定m以后,如果其他人不知道签名人对应的私钥是什么,那么他们确实不知道产生的随机数会是什么样子. 同时验证人如果知道私钥对应的公钥,也很容易确定私钥是否是对m签的名. 所以看起来签名是可以用作VRF的. 但是问题出在签名过程中的随机数r,因为r是随机的,所以每次签名的结果{rG,s}完全是随机的,那么这就给随机数生成方选择随机数的机会. 也就是说一开始定义的"),l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"y"),l("mo",null,"="),l("mi",null,"F"),l("mi",null,"S"),l("mi",null,"K"),l("mo",{stretchy:"false"},"("),l("mi",null,"x"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"y=FSK(x)")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.625em","vertical-align":"-0.19444em"}}),l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"y"),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),l("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"FS"),l("span",{class:"mord mathnormal",style:{"margin-right":"0.07153em"}},"K"),l("span",{class:"mopen"},"("),l("span",{class:"mord mathnormal"},"x"),l("span",{class:"mclose"},")")])])]),t(",这里的x到y的映射是不固定的,这不符合函数的定义.")],-1),A=e('<h3 id="比特币和以太坊中的数字签名可以做vrf么"><a class="header-anchor" href="#比特币和以太坊中的数字签名可以做vrf么" aria-hidden="true">#</a> 比特币和以太坊中的数字签名可以做VRF么?</h3><p>这个问题答案肯定是和前一个一样的,不可以. 但是为什么还有此一问呢,那是因为很多人观察到的签名和我刚刚讲的并不一致. 什么意思呢? 就是对于相同的内容,如果私钥相同,那么无论你尝试签名多少次,其结果都是一样的,和我们刚刚讲的原理似乎并不一致. 感兴趣的小伙伴可以自行编码验证. 这又是为什么呢? 那是因为<a href="https://tools.ietf.org/html/rfc6979" target="_blank" rel="noopener noreferrer">RFC6979</a>在作怪,签名结果之所以每次都不一样,就是因为随机数r,如果r固定下来,那么自然签名就不会变了.这实际上就是RFC6979在做的事,他给出了一个固定计算r的方法. 至于为什么这么复杂的计算r,为什么不固定采用一个数字比如3,这主要是考虑到可能泄露私钥的安全性问题. 这些看起来没什么问题,关键是验证者无法验证私钥拥有者有没有按照RFC6979的规则来生成签名,这就导致了私钥拥有者可以选择随机数</p><h2 id="一种正确的实现"><a class="header-anchor" href="#一种正确的实现" aria-hidden="true">#</a> 一种正确的实现</h2><p>前文给出了一个错误的思路,关键就在于他给出的随机数是受私钥持有者控制的,如果能把这个因素去掉,是否就可以行了呢?</p><h3 id="公式推导"><a class="header-anchor" href="#公式推导" aria-hidden="true">#</a> 公式推导</h3><h4 id="h1-把任意信息映射到曲线上的点"><a class="header-anchor" href="#h1-把任意信息映射到曲线上的点" aria-hidden="true">#</a> H1:把任意信息映射到曲线上的点</h4><p>思路也很简单,将Hash(m)(<strong>注意是256位hash</strong>)作为曲线上的X,然后带入上述椭圆曲线公式,求出相应的Y即可.</p><h4 id="h2-映射任意信息为-1-q"><a class="header-anchor" href="#h2-映射任意信息为-1-q" aria-hidden="true">#</a> H2: 映射任意信息为(1,q)</h4><p>这个也很简答,就是Hash(...) mod q即可.</p><h4 id="计算随机数"><a class="header-anchor" href="#计算随机数" aria-hidden="true">#</a> 计算随机数</h4>',10),B=l("p",null,[l("span",{class:"katex-display"},[l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[l("semantics",null,[l("mrow",null,[l("mi",null,"h"),l("mo",null,"="),l("msub",null,[l("mi",null,"H"),l("mn",null,"1")]),l("mo",{stretchy:"false"},"("),l("mi",null,"m"),l("mo",{stretchy:"false"},")"),l("mspace",{linebreak:"newline"}),l("mi",null,"v"),l("mo",null,"="),l("mi",null,"V"),l("mi",null,"R"),l("msub",null,[l("mi",null,"F"),l("mi",null,"k")]),l("mo",{stretchy:"false"},"("),l("mi",null,"m"),l("mo",{stretchy:"false"},")"),l("mo",null,"="),l("msup",null,[l("mi",null,"h"),l("mi",null,"k")])]),l("annotation",{encoding:"application/x-tex"},"h=H_1(m) \\\\ v=VRF_k(m)=h^k ")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.69444em","vertical-align":"0em"}}),l("span",{class:"mord mathnormal"},"h"),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.08125em"}},"H"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t vlist-t2"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.30110799999999993em"}},[l("span",{style:{top:"-2.5500000000000003em","margin-left":"-0.08125em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mtight"},"1")])])]),l("span",{class:"vlist-s"},"​")]),l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.15em"}},[l("span")])])])])]),l("span",{class:"mopen"},"("),l("span",{class:"mord mathnormal"},"m"),l("span",{class:"mclose"},")")]),l("span",{class:"mspace newline"}),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.43056em","vertical-align":"0em"}}),l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"v"),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),l("span",{class:"mord mathnormal",style:{"margin-right":"0.22222em"}},"V"),l("span",{class:"mord mathnormal",style:{"margin-right":"0.00773em"}},"R"),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"F"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t vlist-t2"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.33610799999999996em"}},[l("span",{style:{top:"-2.5500000000000003em","margin-left":"-0.13889em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k")])])]),l("span",{class:"vlist-s"},"​")]),l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.15em"}},[l("span")])])])])]),l("span",{class:"mopen"},"("),l("span",{class:"mord mathnormal"},"m"),l("span",{class:"mclose"},")"),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.8991079999999999em","vertical-align":"0em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal"},"h"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.8991079999999999em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k")])])])])])])])])])])])],-1),F=l("p",null,[t("这里的v是完全确定的,就是"),l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msup",null,[l("mi",null,"h"),l("mi",null,"k")])]),l("annotation",{encoding:"application/x-tex"},"h^k")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.849108em","vertical-align":"0em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal"},"h"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.849108em"}},[l("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k")])])])])])])])])])]),t(",满足了函数的确定性,但是怎么可验证呢?")],-1),_=l("h4",{id:"随机数的proof"},[l("a",{class:"header-anchor",href:"#随机数的proof","aria-hidden":"true"},"#"),t(" 随机数的proof")],-1),M=l("p",null,"随机生成一个r,然后计算:",-1),S=l("p",null,[l("span",{class:"katex-display"},[l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[l("semantics",null,[l("mrow",null,[l("mi",null,"s"),l("mo",null,"="),l("msub",null,[l("mi",null,"H"),l("mn",null,"2")]),l("mo",{stretchy:"false"},"("),l("mi",null,"g"),l("mo",{separator:"true"},","),l("mi",null,"h"),l("mo",{separator:"true"},","),l("mi",null,"G"),l("mo",{separator:"true"},","),l("mi",null,"v"),l("mo",{separator:"true"},","),l("msup",null,[l("mi",null,"g"),l("mi",null,"r")]),l("mo",{separator:"true"},","),l("msup",null,[l("mi",null,"h"),l("mi",null,"r")]),l("mo",{stretchy:"false"},")"),l("mspace",{linebreak:"newline"}),l("mi",null,"t"),l("mo",null,"="),l("mi",null,"r"),l("mo",null,"−"),l("mi",null,"s"),l("mi",null,"k"),l("mo",{stretchy:"false"},"("),l("mi",null,"m"),l("mi",null,"o"),l("mi",null,"d"),l("mi",null,"p"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"s=H_2(g,h,G,v,g^r,h^r) \\\\ t=r-sk (mod p) ")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.43056em","vertical-align":"0em"}}),l("span",{class:"mord mathnormal"},"s"),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.08125em"}},"H"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t vlist-t2"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.30110799999999993em"}},[l("span",{style:{top:"-2.5500000000000003em","margin-left":"-0.08125em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mtight"},"2")])])]),l("span",{class:"vlist-s"},"​")]),l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.15em"}},[l("span")])])])])]),l("span",{class:"mopen"},"("),l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),l("span",{class:"mpunct"},","),l("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),l("span",{class:"mord mathnormal"},"h"),l("span",{class:"mpunct"},","),l("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),l("span",{class:"mord mathnormal"},"G"),l("span",{class:"mpunct"},","),l("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"v"),l("span",{class:"mpunct"},","),l("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.7143919999999999em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])])])])])]),l("span",{class:"mpunct"},","),l("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal"},"h"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.7143919999999999em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])])])])])]),l("span",{class:"mclose"},")")]),l("span",{class:"mspace newline"}),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.61508em","vertical-align":"0em"}}),l("span",{class:"mord mathnormal"},"t"),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.66666em","vertical-align":"-0.08333em"}}),l("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"r"),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),l("span",{class:"mbin"},"−"),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),l("span",{class:"mord mathnormal"},"s"),l("span",{class:"mord mathnormal",style:{"margin-right":"0.03148em"}},"k"),l("span",{class:"mopen"},"("),l("span",{class:"mord mathnormal"},"m"),l("span",{class:"mord mathnormal"},"o"),l("span",{class:"mord mathnormal"},"d"),l("span",{class:"mord mathnormal"},"p"),l("span",{class:"mclose"},")")])])])])],-1),V=e('<p>然后把(v,s,t)一起打包发给验证方,</p><h4 id="如何验证"><a class="header-anchor" href="#如何验证" aria-hidden="true">#</a> 如何验证</h4><p>上述信息中已知的有:</p><ol><li>g: 曲线公共参数</li><li>h: H1(m) ,因为m已知,Hash方法也是已知</li><li>G: 公钥</li><li>v: 随机数,验证方明文收到</li><li>t: 验证法明文收到</li><li>s: 验证法明文收到</li></ol>',4),R=l("h4",{id:"生成"},[l("a",{class:"header-anchor",href:"#生成","aria-hidden":"true"},"#"),t(" 生成"),l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msup",null,[l("mi",null,"g"),l("mi",null,"r")])]),l("annotation",{encoding:"application/x-tex"},"g^r")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.858832em","vertical-align":"-0.19444em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.664392em"}},[l("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])])])])])])])])]),t(" , "),l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msup",null,[l("mi",null,"h"),l("mi",null,"r")])]),l("annotation",{encoding:"application/x-tex"},"h^r")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.69444em","vertical-align":"0em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal"},"h"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.664392em"}},[l("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])])])])])])])])])],-1),K=l("p",null,[l("span",{class:"katex-display"},[l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[l("semantics",null,[l("mrow",null,[l("msup",null,[l("mi",null,"g"),l("mi",null,"r")]),l("mo",null,"="),l("msup",null,[l("mi",null,"g"),l("mrow",null,[l("mi",null,"t"),l("mo",null,"+"),l("mi",null,"k"),l("mi",null,"s")])]),l("mo",null,"="),l("msup",null,[l("mi",null,"g"),l("mi",null,"t")]),l("mo",null,"⋅"),l("msup",null,[l("mi",null,"g"),l("mrow",null,[l("mi",null,"k"),l("mi",null,"s")])]),l("mo",null,"="),l("msup",null,[l("mi",null,"g"),l("mi",null,"t")]),l("mo",null,"⋅"),l("msup",null,[l("msup",null,[l("mi",null,"g"),l("mi",null,"k")]),l("mi",null,"s")]),l("mo",null,"="),l("msup",null,[l("mi",null,"g"),l("mi",null,"t")]),l("mo",null,"⋅"),l("msup",null,[l("mi",null,"G"),l("mi",null,"s")])]),l("annotation",{encoding:"application/x-tex"},"g^r =g^{t+ks} =g^t \\cdot g^{ks} =g^t \\cdot {g^k}^s =g^t \\cdot G^s ")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.9088319999999999em","vertical-align":"-0.19444em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.7143919999999999em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])])])])])]),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1.093548em","vertical-align":"-0.19444em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.8991079999999999em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mtight"},[l("span",{class:"mord mathnormal mtight"},"t"),l("span",{class:"mbin mtight"},"+"),l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k"),l("span",{class:"mord mathnormal mtight"},"s")])])])])])])])]),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1.037996em","vertical-align":"-0.19444em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.843556em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight"},"t")])])])])])])]),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),l("span",{class:"mbin"},"⋅"),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1.093548em","vertical-align":"-0.19444em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.8991079999999999em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k"),l("span",{class:"mord mathnormal mtight"},"s")])])])])])])])]),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1.037996em","vertical-align":"-0.19444em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.843556em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight"},"t")])])])])])])]),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),l("span",{class:"mbin"},"⋅"),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1.14784em","vertical-align":"-0.19444em"}}),l("span",{class:"mord"},[l("span",{class:"mord"},[l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.8991079999999999em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k")])])])])])])])]),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.9533999999999999em"}},[l("span",{style:{top:"-3.352008em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight"},"s")])])])])])])]),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1.037996em","vertical-align":"-0.19444em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.843556em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight"},"t")])])])])])])]),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),l("span",{class:"mbin"},"⋅"),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.7143919999999999em","vertical-align":"0em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal"},"G"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.7143919999999999em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight"},"s")])])])])])])])])])])])],-1),P=l("p",null,[l("span",{class:"katex-display"},[l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[l("semantics",null,[l("mrow",null,[l("msup",null,[l("mi",null,"h"),l("mi",null,"r")]),l("mo",null,"="),l("msup",null,[l("mi",null,"h"),l("mrow",null,[l("mi",null,"t"),l("mo",null,"+"),l("mi",null,"k"),l("mi",null,"s")])]),l("mo",null,"="),l("msup",null,[l("mi",null,"h"),l("mi",null,"t")]),l("mo",null,"⋅"),l("msup",null,[l("mi",null,"h"),l("mrow",null,[l("mi",null,"k"),l("mi",null,"s")])]),l("mo",null,"="),l("msup",null,[l("mi",null,"h"),l("mi",null,"t")]),l("mo",null,"⋅"),l("msup",null,[l("msup",null,[l("mi",null,"h"),l("mi",null,"k")]),l("mi",null,"s")]),l("mo",null,"="),l("msup",null,[l("mi",null,"h"),l("mi",null,"t")]),l("mo",null,"⋅"),l("msup",null,[l("mi",null,"v"),l("mi",null,"s")])]),l("annotation",{encoding:"application/x-tex"},"h^r =h^{t+ks} =h^t \\cdot h^{ks} =h^t \\cdot {h^k}^s =h^t \\cdot v^s ")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.7143919999999999em","vertical-align":"0em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal"},"h"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.7143919999999999em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])])])])])]),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.8991079999999999em","vertical-align":"0em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal"},"h"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.8991079999999999em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mtight"},[l("span",{class:"mord mathnormal mtight"},"t"),l("span",{class:"mbin mtight"},"+"),l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k"),l("span",{class:"mord mathnormal mtight"},"s")])])])])])])])]),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.843556em","vertical-align":"0em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal"},"h"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.843556em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight"},"t")])])])])])])]),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),l("span",{class:"mbin"},"⋅"),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.8991079999999999em","vertical-align":"0em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal"},"h"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.8991079999999999em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k"),l("span",{class:"mord mathnormal mtight"},"s")])])])])])])])]),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.843556em","vertical-align":"0em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal"},"h"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.843556em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight"},"t")])])])])])])]),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),l("span",{class:"mbin"},"⋅"),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.9533999999999999em","vertical-align":"0em"}}),l("span",{class:"mord"},[l("span",{class:"mord"},[l("span",{class:"mord"},[l("span",{class:"mord mathnormal"},"h"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.8991079999999999em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k")])])])])])])])]),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.9533999999999999em"}},[l("span",{style:{top:"-3.352008em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight"},"s")])])])])])])]),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.843556em","vertical-align":"0em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal"},"h"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.843556em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight"},"t")])])])])])])]),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),l("span",{class:"mbin"},"⋅"),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.7143919999999999em","vertical-align":"0em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"v"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.7143919999999999em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight"},"s")])])])])])])])])])])])],-1),G=l("p",null,[t("虽然验证人不知道k,也不知道r,但是知道h,g,G,v,s,t所以他可以计算出"),l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"s"),l("mn",null,"2"),l("mo",null,"="),l("msub",null,[l("mi",null,"H"),l("mn",null,"2")]),l("mo",{stretchy:"false"},"("),l("mi",null,"g"),l("mo",{separator:"true"},","),l("mi",null,"h"),l("mo",{separator:"true"},","),l("mi",null,"G"),l("mo",{separator:"true"},","),l("mi",null,"v"),l("mo",{separator:"true"},","),l("msup",null,[l("mi",null,"g"),l("mi",null,"t")]),l("mo",null,"⋅"),l("msup",null,[l("mi",null,"G"),l("mi",null,"s")]),l("mo",{separator:"true"},","),l("msup",null,[l("mi",null,"h"),l("mi",null,"t")]),l("mo",null,"⋅"),l("msup",null,[l("mi",null,"v"),l("mi",null,"s")]),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"s2=H_2(g , h ,G , v , g^t \\cdot G^s , h^t \\cdot v^s)")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.64444em","vertical-align":"0em"}}),l("span",{class:"mord mathnormal"},"s"),l("span",{class:"mord"},"2"),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1.043556em","vertical-align":"-0.25em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.08125em"}},"H"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t vlist-t2"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.30110799999999993em"}},[l("span",{style:{top:"-2.5500000000000003em","margin-left":"-0.08125em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mtight"},"2")])])]),l("span",{class:"vlist-s"},"​")]),l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.15em"}},[l("span")])])])])]),l("span",{class:"mopen"},"("),l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),l("span",{class:"mpunct"},","),l("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),l("span",{class:"mord mathnormal"},"h"),l("span",{class:"mpunct"},","),l("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),l("span",{class:"mord mathnormal"},"G"),l("span",{class:"mpunct"},","),l("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"v"),l("span",{class:"mpunct"},","),l("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.7935559999999999em"}},[l("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight"},"t")])])])])])])]),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),l("span",{class:"mbin"},"⋅"),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.9879959999999999em","vertical-align":"-0.19444em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal"},"G"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.664392em"}},[l("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight"},"s")])])])])])])]),l("span",{class:"mpunct"},","),l("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal"},"h"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.7935559999999999em"}},[l("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight"},"t")])])])])])])]),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),l("span",{class:"mbin"},"⋅"),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"v"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.664392em"}},[l("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight"},"s")])])])])])])]),l("span",{class:"mclose"},")")])])]),t(" . 然后验证s2是否和s相等,如果相等,那就是k持有人按照规则计算出的随机数")],-1),T=e('<h2 id="在椭圆曲线上的实现"><a class="header-anchor" href="#在椭圆曲线上的实现" aria-hidden="true">#</a> 在椭圆曲线上的实现</h2><p>这里专门说的是比特币和以太坊上采用椭圆曲线S256,这根曲线.</p><h3 id="接口原型"><a class="header-anchor" href="#接口原型" aria-hidden="true">#</a> 接口原型</h3><div class="language-go line-numbers-mode"><pre><code><span class="token comment">// A VRF is a pseudorandom function f_k from a secret key k, such that that</span>\n<span class="token comment">// knowledge of k not only enables one to evaluate f_k at for any message m,</span>\n<span class="token comment">// but also to provide an NP-proof that the value f_k(m) is indeed correct</span>\n<span class="token comment">// without compromising the unpredictability of f_k for any m&#39; != m.</span>\n<span class="token comment">// http://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&amp;arnumber=814584</span>\n\n<span class="token comment">// PrivateKey supports evaluating the VRF function.</span>\n<span class="token keyword">type</span> PrivateKey <span class="token keyword">interface</span> <span class="token punctuation">{</span>\n\t<span class="token comment">// Evaluate returns the output of H(f_k(m)) and its proof.</span>\n\t<span class="token function">Evaluate</span><span class="token punctuation">(</span>m <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>index <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> proof <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span>\n\t<span class="token comment">// Public returns the corresponding public key.</span>\n\t<span class="token function">Public</span><span class="token punctuation">(</span><span class="token punctuation">)</span> crypto<span class="token punctuation">.</span>PublicKey\n<span class="token punctuation">}</span>\n\n<span class="token comment">// PublicKey supports verifying output from the VRF function.</span>\n<span class="token keyword">type</span> PublicKey <span class="token keyword">interface</span> <span class="token punctuation">{</span>\n\t<span class="token comment">// ProofToHash verifies the NP-proof supplied by Proof and outputs Index.</span>\n\t<span class="token function">ProofToHash</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> proof <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>index <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="使用方法"><a class="header-anchor" href="#使用方法" aria-hidden="true">#</a> 使用方法</h3><div class="language-go line-numbers-mode"><pre><code><span class="token keyword">func</span> <span class="token function">TestVRFForS256</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">//私钥持有人</span>\n\tkey<span class="token punctuation">,</span> err <span class="token operator">:=</span> crypto<span class="token punctuation">.</span><span class="token function">GenerateKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n\t<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>\n\t\tt<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>\n\t\t<span class="token keyword">return</span>\n\t<span class="token punctuation">}</span>\n\tk<span class="token punctuation">,</span> err <span class="token operator">:=</span> <span class="token function">NewVRFSigner</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>\n\t<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>\n\t\tt<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>\n\t\t<span class="token keyword">return</span>\n    <span class="token punctuation">}</span>\n    <span class="token comment">//验证人,只知道公钥</span>\n\tpk<span class="token punctuation">,</span> err <span class="token operator">:=</span> <span class="token function">NewVRFVerifier</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>key<span class="token punctuation">.</span>PublicKey<span class="token punctuation">)</span>\n\t<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>\n\t\tt<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>\n\t\t<span class="token keyword">return</span>\n\t<span class="token punctuation">}</span>\n\tmsg <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">&quot;data1&quot;</span><span class="token punctuation">)</span>\n\tindex<span class="token punctuation">,</span> proof <span class="token operator">:=</span> k<span class="token punctuation">.</span><span class="token function">Evaluate</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>\n\tindex2<span class="token punctuation">,</span> err <span class="token operator">:=</span> pk<span class="token punctuation">.</span><span class="token function">ProofToHash</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span> proof<span class="token punctuation">)</span>\n\n\t<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>\n\t\tt<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>\n\t<span class="token punctuation">}</span>\n\t<span class="token keyword">if</span> index2 <span class="token operator">!=</span> index <span class="token punctuation">{</span>\n\t\tt<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token string">&quot;index not equal&quot;</span><span class="token punctuation">)</span>\n\t<span class="token punctuation">}</span>\n\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h2 id="推荐实现"><a class="header-anchor" href="#推荐实现" aria-hidden="true">#</a> 推荐实现</h2><h3 id="_1-谷歌的keytransparency项目"><a class="header-anchor" href="#_1-谷歌的keytransparency项目" aria-hidden="true">#</a> 1. 谷歌的keytransparency项目</h3><p><a href="https://github.com/google/keytransparency/tree/master/core/crypto/vrf" target="_blank" rel="noopener noreferrer">google VRF</a> 注意这里面使用的曲线是P256,不是比特币和以太坊使用的S256,实现语言是go语言</p><h3 id="_2-spectrum上使用的vrf"><a class="header-anchor" href="#_2-spectrum上使用的vrf" aria-hidden="true">#</a> 2. Spectrum上使用的VRF</h3><p><a href="https://github.com/SmartMeshFoundation/Spectrum/tree/master/crypto/vrf" target="_blank" rel="noopener noreferrer">Spectrum VRF</a> 这个项目是在参考项目1基础之上改进得来,他使用的是S256这根曲线,实现语言也是go语言,好处是直接可以在项目中集成.</p><h3 id="_3-witnet上的vrf"><a class="header-anchor" href="#_3-witnet上的vrf" aria-hidden="true">#</a> 3. witnet上的VRF</h3><p><a href="https://github.com/witnet/vrf-rs" target="_blank" rel="noopener noreferrer">witnet VRF</a> 这个项目使用rust开发,同时支持P256,S256两根曲线.因为用rust开发,可以方便与其他语言集成,并且性能很高.</p>',13);p.render=function(l,t,e,m,p,D){return s(),a("div",null,[n(' @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} '),n(" code_chunk_output "),i,r,n(" /code_chunk_output "),c,o,h,u,g,d,y,k,b,v,f,E,x,w,z,A,B,F,_,M,S,V,R,K,P,G,T])};export{m as __pageData,p as default};
