import{o as s,c as a,f as n,b as l,d as t,e}from"./app.7522cc54.js";const m='{"title":"一篇文章搞懂VRF","description":"","frontmatter":{"title":"一篇文章搞懂VRF","date":"2019-06-16T03:57:03.000Z","draft":false,"markup":"mmark"},"headers":[{"level":2,"title":"一种错误的实现","slug":"一种错误的实现"},{"level":3,"title":"椭圆曲线签名算法原理","slug":"椭圆曲线签名算法原理"},{"level":3,"title":"比特币和以太坊中的数字签名可以做VRF么?","slug":"比特币和以太坊中的数字签名可以做vrf么"},{"level":2,"title":"一种正确的实现","slug":"一种正确的实现"},{"level":3,"title":"公式推导","slug":"公式推导"},{"level":2,"title":"在椭圆曲线上的实现","slug":"在椭圆曲线上的实现"},{"level":3,"title":"接口原型","slug":"接口原型"},{"level":3,"title":"使用方法","slug":"使用方法"},{"level":2,"title":"推荐实现","slug":"推荐实现"},{"level":3,"title":"1. 谷歌的keytransparency项目","slug":"_1-谷歌的keytransparency项目"},{"level":3,"title":"2. Spectrum上使用的VRF","slug":"_2-spectrum上使用的vrf"},{"level":3,"title":"3. witnet上的VRF","slug":"_3-witnet上的vrf"}],"relativePath":"block_chain_core/vrf.md","lastUpdated":1599101312000}',p={},i=l("ul",null,[l("li",null,[l("a",{href:"#%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E6%90%9E%E6%87%82vrf"},"一篇文章搞懂VRF")])],-1),r=l("ul",null,[l("li",null,[l("a",{href:"#%E4%B8%80%E7%A7%8D%E9%94%99%E8%AF%AF%E7%9A%84%E5%AE%9E%E7%8E%B0"},"一种错误的实现"),l("ul",null,[l("li",null,[l("a",{href:"#%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF%E7%AD%BE%E5%90%8D%E7%AE%97%E6%B3%95%E5%8E%9F%E7%90%86"},"椭圆曲线签名算法原理"),l("ul",null,[l("li",null,[l("a",{href:"#%E9%82%A3%E4%B9%88%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF%E7%9A%84%E7%AD%BE%E5%90%8D%E5%8F%AF%E5%90%A6%E5%BD%93%E5%81%9Avrf%E5%91%A2"},"那么椭圆曲线的签名可否当做VRF呢?")])])]),l("li",null,[l("a",{href:"#%E6%AF%94%E7%89%B9%E5%B8%81%E5%92%8C%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%B8%AD%E7%9A%84%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D%E5%8F%AF%E4%BB%A5%E5%81%9Avrf%E4%B9%88"},"比特币和以太坊中的数字签名可以做VRF么?")])])]),l("li",null,[l("a",{href:"#%E4%B8%80%E7%A7%8D%E6%AD%A3%E7%A1%AE%E7%9A%84%E5%AE%9E%E7%8E%B0"},"一种正确的实现"),l("ul",null,[l("li",null,[l("a",{href:"#%E5%85%AC%E5%BC%8F%E6%8E%A8%E5%AF%BC"},"公式推导"),l("ul",null,[l("li",null,[l("a",{href:"#h1%E6%8A%8A%E4%BB%BB%E6%84%8F%E4%BF%A1%E6%81%AF%E6%98%A0%E5%B0%84%E5%88%B0%E6%9B%B2%E7%BA%BF%E4%B8%8A%E7%9A%84%E7%82%B9"},"H1:把任意信息映射到曲线上的点")]),l("li",null,[l("a",{href:"#h2-%E6%98%A0%E5%B0%84%E4%BB%BB%E6%84%8F%E4%BF%A1%E6%81%AF%E4%B8%BA1q"},"H2: 映射任意信息为(1,q)")]),l("li",null,[l("a",{href:"#%E8%AE%A1%E7%AE%97%E9%9A%8F%E6%9C%BA%E6%95%B0"},"计算随机数")]),l("li",null,[l("a",{href:"#%E9%9A%8F%E6%9C%BA%E6%95%B0%E7%9A%84proof"},"随机数的proof")]),l("li",null,[l("a",{href:"#%E5%A6%82%E4%BD%95%E9%AA%8C%E8%AF%81"},"如何验证")]),l("li",null,[l("a",{href:"#%E7%94%9F%E6%88%90gr-hr"},[t("生成"),l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msup",null,[l("mi",null,"g"),l("mi",null,"r")])]),l("annotation",{encoding:"application/x-tex"},"g^r")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.858832em","vertical-align":"-0.19444em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.664392em"}},[l("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])])])])])])])])]),t(" , "),l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msup",null,[l("mi",null,"h"),l("mi",null,"r")])]),l("annotation",{encoding:"application/x-tex"},"h^r")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.69444em","vertical-align":"0em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal"},"h"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.664392em"}},[l("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])])])])])])])])])])])])])])]),l("li",null,[l("a",{href:"#%E5%9C%A8%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF%E4%B8%8A%E7%9A%84%E5%AE%9E%E7%8E%B0"},"在椭圆曲线上的实现"),l("ul",null,[l("li",null,[l("a",{href:"#%E6%8E%A5%E5%8F%A3%E5%8E%9F%E5%9E%8B"},"接口原型")]),l("li",null,[l("a",{href:"#%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95"},"使用方法")])])]),l("li",null,[l("a",{href:"#%E6%8E%A8%E8%8D%90%E5%AE%9E%E7%8E%B0"},"推荐实现"),l("ul",null,[l("li",null,[l("a",{href:"#1-%E8%B0%B7%E6%AD%8C%E7%9A%84keytransparency%E9%A1%B9%E7%9B%AE"},"1. 谷歌的keytransparency项目")]),l("li",null,[l("a",{href:"#2-spectrum%E4%B8%8A%E4%BD%BF%E7%94%A8%E7%9A%84vrf"},"2. Spectrum上使用的VRF")]),l("li",null,[l("a",{href:"#3-witnet%E4%B8%8A%E7%9A%84vrf"},"3. witnet上的VRF")])])])],-1),c=l("p",null,"什么是VRF,VRF全称是verifiable random function ,也就是可验证随机数. 他有两个特性, 他产生的是随机数,第二还是可验证的.",-1),o=l("p",null,[t("我直接引用"),l("a",{href:"https://en.wikipedia.org/wiki/Verifiable_random_function",target:"_blank",rel:"noopener noreferrer"},"维基百科上的VRF"),t(",就是说针对一个输入x,一个私钥SK的拥有者可以计算"),l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"y"),l("mo",null,"="),l("mi",null,"F"),l("mi",null,"S"),l("mi",null,"K"),l("mo",{stretchy:"false"},"("),l("mi",null,"x"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"y=FSK(x)")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.625em","vertical-align":"-0.19444em"}}),l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"y"),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),l("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"FS"),l("span",{class:"mord mathnormal",style:{"margin-right":"0.07153em"}},"K"),l("span",{class:"mopen"},"("),l("span",{class:"mord mathnormal"},"x"),l("span",{class:"mclose"},")")])])]),t("和证明"),l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P"),l("mi",null,"S"),l("mi",null,"K"),l("mo",{stretchy:"false"},"("),l("mi",null,"x"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"PSK(x)")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),l("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"PS"),l("span",{class:"mord mathnormal",style:{"margin-right":"0.07153em"}},"K"),l("span",{class:"mopen"},"("),l("span",{class:"mord mathnormal"},"x"),l("span",{class:"mclose"},")")])])]),t(". 依据证明(proof)和SK对应的公钥PK("),l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P"),l("mi",null,"K"),l("mo",null,"="),l("msup",null,[l("mi",null,"g"),l("mrow",null,[l("mi",null,"S"),l("mi",null,"K")])])]),l("annotation",{encoding:"application/x-tex"},"PK=g^{SK}")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.68333em","vertical-align":"0em"}}),l("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"P"),l("span",{class:"mord mathnormal",style:{"margin-right":"0.07153em"}},"K"),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1.035771em","vertical-align":"-0.19444em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.8413309999999999em"}},[l("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.05764em"}},"S"),l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.07153em"}},"K")])])])])])])])])])])]),t("),任何人都可以验证y是被正确计算的,但是不能知道SK是什么.")],-1),h=l("p",null,"原文中提到了使用双线性映射来做这个事情,当然VRF可以有很多种不同的实现,只要满足上面提出的条件即可.一个是随机数,另一个是可验证.",-1),u=l("p",null,"简单解释一下:",-1),g=l("ol",null,[l("li",null,"验证人只知道x,在SK持有人没有广播之前不知道随机数是什么"),l("li",null,"SK持有人无法伪造随机数,一旦x确定,随机数也确定了. 这就是所谓的随机数(除了SK持有人之外,其他任何人事先不知道) 可验证(知道PK的任何人都知道SK生成的随机数是否合规)")],-1),d=l("h2",{id:"一种错误的实现"},[l("a",{class:"header-anchor",href:"#一种错误的实现","aria-hidden":"true"},"#"),t(" 一种错误的实现")],-1),y=l("p",null,"首先我们常用的数字签名可否用作VRF呢?",-1),k=l("h3",{id:"椭圆曲线签名算法原理"},[l("a",{class:"header-anchor",href:"#椭圆曲线签名算法原理","aria-hidden":"true"},"#"),t(" 椭圆曲线签名算法原理")],-1),v=l("p",null,[t("假设私钥为k,那么公钥"),l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"K"),l("mo",null,"="),l("mi",null,"k"),l("mi",null,"G")]),l("annotation",{encoding:"application/x-tex"},"K=kG")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.68333em","vertical-align":"0em"}}),l("span",{class:"mord mathnormal",style:{"margin-right":"0.07153em"}},"K"),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.69444em","vertical-align":"0em"}}),l("span",{class:"mord mathnormal",style:{"margin-right":"0.03148em"}},"k"),l("span",{class:"mord mathnormal"},"G")])])]),t(",其中G为G点(就是椭圆曲线的公共参数,可以忽略). 签名的过程如下:")],-1),b=l("ol",null,[l("li",null,[t("选择随机数r,计算"),l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P"),l("mo",null,"="),l("mi",null,"r"),l("mi",null,"G")]),l("annotation",{encoding:"application/x-tex"},"P=rG")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.68333em","vertical-align":"0em"}}),l("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"P"),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.68333em","vertical-align":"0em"}}),l("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"r"),l("span",{class:"mord mathnormal"},"G")])])]),t(",P实际上就是曲线上的一个点")]),l("li",null,[t("计算"),l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"s"),l("mo",null,"="),l("mfrac",null,[l("mrow",null,[l("mi",null,"m"),l("mo",null,"+"),l("mi",null,"k"),l("mi",null,"x")]),l("mi",null,"r")])]),l("annotation",{encoding:"application/x-tex"},"s=\\frac {m+kx} r")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.43056em","vertical-align":"0em"}}),l("span",{class:"mord mathnormal"},"s"),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1.2251079999999999em","vertical-align":"-0.345em"}}),l("span",{class:"mord"},[l("span",{class:"mopen nulldelimiter"}),l("span",{class:"mfrac"},[l("span",{class:"vlist-t vlist-t2"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.8801079999999999em"}},[l("span",{style:{top:"-2.6550000000000002em"}},[l("span",{class:"pstrut",style:{height:"3em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])]),l("span",{style:{top:"-3.23em"}},[l("span",{class:"pstrut",style:{height:"3em"}}),l("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),l("span",{style:{top:"-3.394em"}},[l("span",{class:"pstrut",style:{height:"3em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mtight"},[l("span",{class:"mord mathnormal mtight"},"m"),l("span",{class:"mbin mtight"},"+"),l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k"),l("span",{class:"mord mathnormal mtight"},"x")])])])]),l("span",{class:"vlist-s"},"​")]),l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.345em"}},[l("span")])])])]),l("span",{class:"mclose nulldelimiter"})])])])]),t(",其中m就是公共信息,比如是一个以太坊交易的Hash值. 这里的x是P的x坐标.")]),l("li",null,"将消息m和签名{rG,s}发送给接收方 接收方在事先知道公钥K的情况下,就很容易验证签名和m是否是对应关系. 验证签名的过程: 计算$\\frac {mG} s + \\frac {xK} s $,然后与rG比较,如果相等说明是对应关系.其中x是rG这个点的x坐标")],-1),f=l("p",null,"为什么这样可以呢,来看一下简单的推导过程:",-1),E=t(" \\begin{eqnarray} & \\frac {mG} s + \\frac {xK} s \\\\ =& \\frac {mG} s + \\frac {x(kG)} s \\\\ =& \\frac {(m+xk)G} s \\\\ =& \\frac {r(m+xk)G} {m+kx} \\\\ =& rG \\end{eqnarray} "),x=l("p",null,[l("strong",null,[t("注意: "),l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"s"),l("mo",null,"="),l("mfrac",null,[l("mrow",null,[l("mi",null,"m"),l("mo",null,"+"),l("mi",null,"k"),l("mi",null,"x")]),l("mi",null,"r")])]),l("annotation",{encoding:"application/x-tex"},"s=\\frac {m+kx} r")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.43056em","vertical-align":"0em"}}),l("span",{class:"mord mathnormal"},"s"),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1.2251079999999999em","vertical-align":"-0.345em"}}),l("span",{class:"mord"},[l("span",{class:"mopen nulldelimiter"}),l("span",{class:"mfrac"},[l("span",{class:"vlist-t vlist-t2"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.8801079999999999em"}},[l("span",{style:{top:"-2.6550000000000002em"}},[l("span",{class:"pstrut",style:{height:"3em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])]),l("span",{style:{top:"-3.23em"}},[l("span",{class:"pstrut",style:{height:"3em"}}),l("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),l("span",{style:{top:"-3.394em"}},[l("span",{class:"pstrut",style:{height:"3em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mtight"},[l("span",{class:"mord mathnormal mtight"},"m"),l("span",{class:"mbin mtight"},"+"),l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k"),l("span",{class:"mord mathnormal mtight"},"x")])])])]),l("span",{class:"vlist-s"},"​")]),l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.345em"}},[l("span")])])])]),l("span",{class:"mclose nulldelimiter"})])])])])])],-1),w=l("h4",{id:"那么椭圆曲线的签名可否当做vrf呢"},[l("a",{class:"header-anchor",href:"#那么椭圆曲线的签名可否当做vrf呢","aria-hidden":"true"},"#"),t(" 那么椭圆曲线的签名可否当做VRF呢?")],-1),z=l("p",null,[t("首先第一点,固定m以后,如果其他人不知道签名人对应的私钥是什么,那么他们确实不知道产生的随机数会是什么样子. 同时验证人如果知道私钥对应的公钥,也很容易确定私钥是否是对m签的名. 所以看起来签名是可以用作VRF的. 但是问题出在签名过程中的随机数r,因为r是随机的,所以每次签名的结果{rG,s}完全是随机的,那么这就给随机数生成方选择随机数的机会. 也就是说一开始定义的"),l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"y"),l("mo",null,"="),l("mi",null,"F"),l("mi",null,"S"),l("mi",null,"K"),l("mo",{stretchy:"false"},"("),l("mi",null,"x"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"y=FSK(x)")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.625em","vertical-align":"-0.19444em"}}),l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"y"),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),l("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"FS"),l("span",{class:"mord mathnormal",style:{"margin-right":"0.07153em"}},"K"),l("span",{class:"mopen"},"("),l("span",{class:"mord mathnormal"},"x"),l("span",{class:"mclose"},")")])])]),t(",这里的x到y的映射是不固定的,这不符合函数的定义.")],-1),A=e('',10),B=l("p",null,[l("span",{class:"katex-display"},[l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[l("semantics",null,[l("mrow",null,[l("mi",null,"h"),l("mo",null,"="),l("msub",null,[l("mi",null,"H"),l("mn",null,"1")]),l("mo",{stretchy:"false"},"("),l("mi",null,"m"),l("mo",{stretchy:"false"},")"),l("mspace",{linebreak:"newline"}),l("mi",null,"v"),l("mo",null,"="),l("mi",null,"V"),l("mi",null,"R"),l("msub",null,[l("mi",null,"F"),l("mi",null,"k")]),l("mo",{stretchy:"false"},"("),l("mi",null,"m"),l("mo",{stretchy:"false"},")"),l("mo",null,"="),l("msup",null,[l("mi",null,"h"),l("mi",null,"k")])]),l("annotation",{encoding:"application/x-tex"},"h=H_1(m) \\\\ v=VRF_k(m)=h^k ")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.69444em","vertical-align":"0em"}}),l("span",{class:"mord mathnormal"},"h"),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.08125em"}},"H"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t vlist-t2"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.30110799999999993em"}},[l("span",{style:{top:"-2.5500000000000003em","margin-left":"-0.08125em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mtight"},"1")])])]),l("span",{class:"vlist-s"},"​")]),l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.15em"}},[l("span")])])])])]),l("span",{class:"mopen"},"("),l("span",{class:"mord mathnormal"},"m"),l("span",{class:"mclose"},")")]),l("span",{class:"mspace newline"}),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.43056em","vertical-align":"0em"}}),l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"v"),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),l("span",{class:"mord mathnormal",style:{"margin-right":"0.22222em"}},"V"),l("span",{class:"mord mathnormal",style:{"margin-right":"0.00773em"}},"R"),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"F"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t vlist-t2"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.33610799999999996em"}},[l("span",{style:{top:"-2.5500000000000003em","margin-left":"-0.13889em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k")])])]),l("span",{class:"vlist-s"},"​")]),l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.15em"}},[l("span")])])])])]),l("span",{class:"mopen"},"("),l("span",{class:"mord mathnormal"},"m"),l("span",{class:"mclose"},")"),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.8991079999999999em","vertical-align":"0em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal"},"h"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.8991079999999999em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k")])])])])])])])])])])])],-1),F=l("p",null,[t("这里的v是完全确定的,就是"),l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msup",null,[l("mi",null,"h"),l("mi",null,"k")])]),l("annotation",{encoding:"application/x-tex"},"h^k")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.849108em","vertical-align":"0em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal"},"h"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.849108em"}},[l("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k")])])])])])])])])])]),t(",满足了函数的确定性,但是怎么可验证呢?")],-1),_=l("h4",{id:"随机数的proof"},[l("a",{class:"header-anchor",href:"#随机数的proof","aria-hidden":"true"},"#"),t(" 随机数的proof")],-1),M=l("p",null,"随机生成一个r,然后计算:",-1),S=l("p",null,[l("span",{class:"katex-display"},[l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[l("semantics",null,[l("mrow",null,[l("mi",null,"s"),l("mo",null,"="),l("msub",null,[l("mi",null,"H"),l("mn",null,"2")]),l("mo",{stretchy:"false"},"("),l("mi",null,"g"),l("mo",{separator:"true"},","),l("mi",null,"h"),l("mo",{separator:"true"},","),l("mi",null,"G"),l("mo",{separator:"true"},","),l("mi",null,"v"),l("mo",{separator:"true"},","),l("msup",null,[l("mi",null,"g"),l("mi",null,"r")]),l("mo",{separator:"true"},","),l("msup",null,[l("mi",null,"h"),l("mi",null,"r")]),l("mo",{stretchy:"false"},")"),l("mspace",{linebreak:"newline"}),l("mi",null,"t"),l("mo",null,"="),l("mi",null,"r"),l("mo",null,"−"),l("mi",null,"s"),l("mi",null,"k"),l("mo",{stretchy:"false"},"("),l("mi",null,"m"),l("mi",null,"o"),l("mi",null,"d"),l("mi",null,"p"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"s=H_2(g,h,G,v,g^r,h^r) \\\\ t=r-sk (mod p) ")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.43056em","vertical-align":"0em"}}),l("span",{class:"mord mathnormal"},"s"),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.08125em"}},"H"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t vlist-t2"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.30110799999999993em"}},[l("span",{style:{top:"-2.5500000000000003em","margin-left":"-0.08125em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mtight"},"2")])])]),l("span",{class:"vlist-s"},"​")]),l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.15em"}},[l("span")])])])])]),l("span",{class:"mopen"},"("),l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),l("span",{class:"mpunct"},","),l("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),l("span",{class:"mord mathnormal"},"h"),l("span",{class:"mpunct"},","),l("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),l("span",{class:"mord mathnormal"},"G"),l("span",{class:"mpunct"},","),l("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"v"),l("span",{class:"mpunct"},","),l("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.7143919999999999em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])])])])])]),l("span",{class:"mpunct"},","),l("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal"},"h"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.7143919999999999em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])])])])])]),l("span",{class:"mclose"},")")]),l("span",{class:"mspace newline"}),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.61508em","vertical-align":"0em"}}),l("span",{class:"mord mathnormal"},"t"),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.66666em","vertical-align":"-0.08333em"}}),l("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"r"),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),l("span",{class:"mbin"},"−"),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),l("span",{class:"mord mathnormal"},"s"),l("span",{class:"mord mathnormal",style:{"margin-right":"0.03148em"}},"k"),l("span",{class:"mopen"},"("),l("span",{class:"mord mathnormal"},"m"),l("span",{class:"mord mathnormal"},"o"),l("span",{class:"mord mathnormal"},"d"),l("span",{class:"mord mathnormal"},"p"),l("span",{class:"mclose"},")")])])])])],-1),V=e('',4),R=l("h4",{id:"生成"},[l("a",{class:"header-anchor",href:"#生成","aria-hidden":"true"},"#"),t(" 生成"),l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msup",null,[l("mi",null,"g"),l("mi",null,"r")])]),l("annotation",{encoding:"application/x-tex"},"g^r")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.858832em","vertical-align":"-0.19444em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.664392em"}},[l("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])])])])])])])])]),t(" , "),l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msup",null,[l("mi",null,"h"),l("mi",null,"r")])]),l("annotation",{encoding:"application/x-tex"},"h^r")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.69444em","vertical-align":"0em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal"},"h"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.664392em"}},[l("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])])])])])])])])])],-1),K=l("p",null,[l("span",{class:"katex-display"},[l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[l("semantics",null,[l("mrow",null,[l("msup",null,[l("mi",null,"g"),l("mi",null,"r")]),l("mo",null,"="),l("msup",null,[l("mi",null,"g"),l("mrow",null,[l("mi",null,"t"),l("mo",null,"+"),l("mi",null,"k"),l("mi",null,"s")])]),l("mo",null,"="),l("msup",null,[l("mi",null,"g"),l("mi",null,"t")]),l("mo",null,"⋅"),l("msup",null,[l("mi",null,"g"),l("mrow",null,[l("mi",null,"k"),l("mi",null,"s")])]),l("mo",null,"="),l("msup",null,[l("mi",null,"g"),l("mi",null,"t")]),l("mo",null,"⋅"),l("msup",null,[l("msup",null,[l("mi",null,"g"),l("mi",null,"k")]),l("mi",null,"s")]),l("mo",null,"="),l("msup",null,[l("mi",null,"g"),l("mi",null,"t")]),l("mo",null,"⋅"),l("msup",null,[l("mi",null,"G"),l("mi",null,"s")])]),l("annotation",{encoding:"application/x-tex"},"g^r =g^{t+ks} =g^t \\cdot g^{ks} =g^t \\cdot {g^k}^s =g^t \\cdot G^s ")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.9088319999999999em","vertical-align":"-0.19444em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.7143919999999999em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])])])])])]),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1.093548em","vertical-align":"-0.19444em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.8991079999999999em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mtight"},[l("span",{class:"mord mathnormal mtight"},"t"),l("span",{class:"mbin mtight"},"+"),l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k"),l("span",{class:"mord mathnormal mtight"},"s")])])])])])])])]),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1.037996em","vertical-align":"-0.19444em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.843556em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight"},"t")])])])])])])]),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),l("span",{class:"mbin"},"⋅"),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1.093548em","vertical-align":"-0.19444em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.8991079999999999em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k"),l("span",{class:"mord mathnormal mtight"},"s")])])])])])])])]),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1.037996em","vertical-align":"-0.19444em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.843556em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight"},"t")])])])])])])]),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),l("span",{class:"mbin"},"⋅"),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1.14784em","vertical-align":"-0.19444em"}}),l("span",{class:"mord"},[l("span",{class:"mord"},[l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.8991079999999999em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k")])])])])])])])]),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.9533999999999999em"}},[l("span",{style:{top:"-3.352008em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight"},"s")])])])])])])]),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1.037996em","vertical-align":"-0.19444em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.843556em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight"},"t")])])])])])])]),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),l("span",{class:"mbin"},"⋅"),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.7143919999999999em","vertical-align":"0em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal"},"G"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.7143919999999999em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight"},"s")])])])])])])])])])])])],-1),P=l("p",null,[l("span",{class:"katex-display"},[l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[l("semantics",null,[l("mrow",null,[l("msup",null,[l("mi",null,"h"),l("mi",null,"r")]),l("mo",null,"="),l("msup",null,[l("mi",null,"h"),l("mrow",null,[l("mi",null,"t"),l("mo",null,"+"),l("mi",null,"k"),l("mi",null,"s")])]),l("mo",null,"="),l("msup",null,[l("mi",null,"h"),l("mi",null,"t")]),l("mo",null,"⋅"),l("msup",null,[l("mi",null,"h"),l("mrow",null,[l("mi",null,"k"),l("mi",null,"s")])]),l("mo",null,"="),l("msup",null,[l("mi",null,"h"),l("mi",null,"t")]),l("mo",null,"⋅"),l("msup",null,[l("msup",null,[l("mi",null,"h"),l("mi",null,"k")]),l("mi",null,"s")]),l("mo",null,"="),l("msup",null,[l("mi",null,"h"),l("mi",null,"t")]),l("mo",null,"⋅"),l("msup",null,[l("mi",null,"v"),l("mi",null,"s")])]),l("annotation",{encoding:"application/x-tex"},"h^r =h^{t+ks} =h^t \\cdot h^{ks} =h^t \\cdot {h^k}^s =h^t \\cdot v^s ")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.7143919999999999em","vertical-align":"0em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal"},"h"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.7143919999999999em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])])])])])]),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.8991079999999999em","vertical-align":"0em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal"},"h"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.8991079999999999em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mtight"},[l("span",{class:"mord mathnormal mtight"},"t"),l("span",{class:"mbin mtight"},"+"),l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k"),l("span",{class:"mord mathnormal mtight"},"s")])])])])])])])]),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.843556em","vertical-align":"0em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal"},"h"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.843556em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight"},"t")])])])])])])]),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),l("span",{class:"mbin"},"⋅"),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.8991079999999999em","vertical-align":"0em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal"},"h"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.8991079999999999em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k"),l("span",{class:"mord mathnormal mtight"},"s")])])])])])])])]),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.843556em","vertical-align":"0em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal"},"h"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.843556em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight"},"t")])])])])])])]),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),l("span",{class:"mbin"},"⋅"),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.9533999999999999em","vertical-align":"0em"}}),l("span",{class:"mord"},[l("span",{class:"mord"},[l("span",{class:"mord"},[l("span",{class:"mord mathnormal"},"h"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.8991079999999999em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k")])])])])])])])]),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.9533999999999999em"}},[l("span",{style:{top:"-3.352008em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight"},"s")])])])])])])]),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.843556em","vertical-align":"0em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal"},"h"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.843556em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight"},"t")])])])])])])]),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),l("span",{class:"mbin"},"⋅"),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.7143919999999999em","vertical-align":"0em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"v"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.7143919999999999em"}},[l("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight"},"s")])])])])])])])])])])])],-1),G=l("p",null,[t("虽然验证人不知道k,也不知道r,但是知道h,g,G,v,s,t所以他可以计算出"),l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"s"),l("mn",null,"2"),l("mo",null,"="),l("msub",null,[l("mi",null,"H"),l("mn",null,"2")]),l("mo",{stretchy:"false"},"("),l("mi",null,"g"),l("mo",{separator:"true"},","),l("mi",null,"h"),l("mo",{separator:"true"},","),l("mi",null,"G"),l("mo",{separator:"true"},","),l("mi",null,"v"),l("mo",{separator:"true"},","),l("msup",null,[l("mi",null,"g"),l("mi",null,"t")]),l("mo",null,"⋅"),l("msup",null,[l("mi",null,"G"),l("mi",null,"s")]),l("mo",{separator:"true"},","),l("msup",null,[l("mi",null,"h"),l("mi",null,"t")]),l("mo",null,"⋅"),l("msup",null,[l("mi",null,"v"),l("mi",null,"s")]),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"s2=H_2(g , h ,G , v , g^t \\cdot G^s , h^t \\cdot v^s)")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.64444em","vertical-align":"0em"}}),l("span",{class:"mord mathnormal"},"s"),l("span",{class:"mord"},"2"),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),l("span",{class:"mrel"},"="),l("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1.043556em","vertical-align":"-0.25em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.08125em"}},"H"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t vlist-t2"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.30110799999999993em"}},[l("span",{style:{top:"-2.5500000000000003em","margin-left":"-0.08125em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mtight"},"2")])])]),l("span",{class:"vlist-s"},"​")]),l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.15em"}},[l("span")])])])])]),l("span",{class:"mopen"},"("),l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),l("span",{class:"mpunct"},","),l("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),l("span",{class:"mord mathnormal"},"h"),l("span",{class:"mpunct"},","),l("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),l("span",{class:"mord mathnormal"},"G"),l("span",{class:"mpunct"},","),l("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"v"),l("span",{class:"mpunct"},","),l("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.7935559999999999em"}},[l("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight"},"t")])])])])])])]),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),l("span",{class:"mbin"},"⋅"),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.9879959999999999em","vertical-align":"-0.19444em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal"},"G"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.664392em"}},[l("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight"},"s")])])])])])])]),l("span",{class:"mpunct"},","),l("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal"},"h"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.7935559999999999em"}},[l("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight"},"t")])])])])])])]),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),l("span",{class:"mbin"},"⋅"),l("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),l("span",{class:"mord"},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"v"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.664392em"}},[l("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight"},[l("span",{class:"mord mathnormal mtight"},"s")])])])])])])]),l("span",{class:"mclose"},")")])])]),t(" . 然后验证s2是否和s相等,如果相等,那就是k持有人按照规则计算出的随机数")],-1),T=e('',13);p.render=function(l,t,e,m,p,D){return s(),a("div",null,[n(' @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} '),n(" code_chunk_output "),i,r,n(" /code_chunk_output "),c,o,h,u,g,d,y,k,v,b,f,E,x,w,z,A,B,F,_,M,S,V,R,K,P,G,T])};export{m as __pageData,p as default};
