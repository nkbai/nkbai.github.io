import{_ as t,c as l,o as e,a as n,d as s,e as a}from"./app.eda6f95c.js";const L='{"title":"9.libra\u4E2D\u7684vrf","description":"","frontmatter":{"title":"9.libra\u4E2D\u7684vrf","date":"2019-07-05T01:55:01.000Z","draft":false,"tags":["rust","blockchain","libra"],"series":["libra"],"categories":["\u6280\u672F\u76F8\u5173"]},"headers":[{"level":2,"title":"1. ED25519","slug":"_1-ed25519"},{"level":2,"title":"2. \u4EC0\u4E48\u662FVRF","slug":"_2-\u4EC0\u4E48\u662Fvrf"},{"level":2,"title":"3. Libra\u4E2DVRF\u7684\u5B9E\u73B0","slug":"_3-libra\u4E2Dvrf\u7684\u5B9E\u73B0"},{"level":3,"title":"3.1 \u63A8\u5BFC\u4E2D\u7528\u5230\u7684\u7B26\u53F7\u7684\u542B\u4E49","slug":"_3-1-\u63A8\u5BFC\u4E2D\u7528\u5230\u7684\u7B26\u53F7\u7684\u542B\u4E49"},{"level":3,"title":"3.2 \u751F\u6210\u8FC7\u7A0B","slug":"_3-2-\u751F\u6210\u8FC7\u7A0B"},{"level":3,"title":"3.3 \u9A8C\u8BC1\u7684\u8FC7\u7A0B","slug":"_3-3-\u9A8C\u8BC1\u7684\u8FC7\u7A0B"},{"level":2,"title":"4. \u7ED3\u675F\u8BED","slug":"_4-\u7ED3\u675F\u8BED"}],"relativePath":"blockchain/libra/9.libria_vrf.md"}',p={},c=n('<p>Libra\u4E2D\u91C7\u7528\u7684\u692D\u5706\u66F2\u7EBF\u662FED25519,\u800C\u4E0D\u662F\u50CF\u4EE5\u592A\u574A\u6BD4\u7279\u5E01\u4F7F\u7528\u7684\u662Fsecp256k1. \u867D\u7136\u6709\u4E0D\u540C,\u4F46\u662F\u4ECE\u672C\u8D28\u4E0A\u6765\u8BF4\u4ED6\u4EEC\u90FD\u662F\u692D\u5706\u66F2\u7EBF,\u57FA\u672C\u6027\u8D28\u90FD\u662F\u5B8C\u5168\u76F8\u540C\u7684.\u56E0\u6B64\u9002\u7528\u4E8ES256\u66F2\u7EBF\u7684VRF\u7B97\u6CD5\u5728Libra\u4E2D\u4E5F\u662F\u76F8\u901A\u7684.</p><h2 id="_1-ed25519" tabindex="-1">1. ED25519 <a class="header-anchor" href="#_1-ed25519" aria-hidden="true">#</a></h2><p><a href="http://ed25519.cr.yp.to/Ed25519%E6%98%AF%E4%B8%80%E4%B8%AA%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D%E7%AE%97%E6%B3%95%EF%BC%8C%E7%AD%BE%E5%90%8D%E5%92%8C%E9%AA%8C%E8%AF%81%E7%9A%84%E6%80%A7%E8%83%BD%E9%83%BD%E6%9E%81%E9%AB%98%EF%BC%8C" target="_blank" rel="noopener noreferrer">http://ed25519.cr.yp.to/Ed25519\u662F\u4E00\u4E2A\u6570\u5B57\u7B7E\u540D\u7B97\u6CD5\uFF0C\u7B7E\u540D\u548C\u9A8C\u8BC1\u7684\u6027\u80FD\u90FD\u6781\u9AD8\uFF0C</a> \u4E00\u4E2A4\u68382.4GHz \u7684 Westmere cpu\uFF0C\u6BCF\u79D2\u53EF\u4EE5\u9A8C\u8BC1 71000 \u4E2A\u7B7E\u540D\uFF0C\u5B89\u5168\u6027\u6781\u9AD8\uFF0C\u7B49\u4EF7\u4E8ERSA\u7EA63000-bit\u3002\u7B7E\u540D\u8FC7\u7A0B\u4E0D\u4F9D\u8D56\u968F\u673A\u6570\u751F\u6210\u5668\uFF0C\u4E0D\u4F9D\u8D56hash\u51FD\u6570\u7684\u9632\u78B0\u649E\u6027\uFF0C\u6CA1\u6709\u65F6\u95F4\u901A\u9053\u653B\u51FB\u7684\u95EE\u9898\uFF0C\u5E76\u4E14\u7B7E\u540D\u5F88\u5C0F\uFF0C\u53EA\u670964\u5B57\u8282\uFF0C\u516C\u94A5\u4E5F\u5F88\u5C0F\uFF0C\u53EA\u670932\u5B57\u8282\u3002 \u90E8\u7F72\u60C5 \u51B5\uFF1A<a href="http://ianix.com/pub/ed25519-deployment.html" target="_blank" rel="noopener noreferrer">http://ianix.com/pub/ed25519-deployment.html</a></p><p>\u540C\u65F6\u5728zcash\u4E2D\u7B7E\u540D\u4F7F\u7528\u4E86ED25519,\u4E5F\u5C31\u662F\u5728\u9690\u79C1\u4EA4\u6613\u65B9\u9762,ED25519\u4E5F\u6709\u5176\u72EC\u7279\u5E94\u7528\u4E4B\u5904,\u8FD9\u5E94\u8BE5\u4E5F\u662F\u4E3B\u6253\u9690\u79C1\u724C\u7684Libra\u91C7\u7528\u5B83\u7684\u539F\u56E0.</p><h2 id="_2-\u4EC0\u4E48\u662Fvrf" tabindex="-1">2. \u4EC0\u4E48\u662FVRF <a class="header-anchor" href="#_2-\u4EC0\u4E48\u662Fvrf" aria-hidden="true">#</a></h2><p>\u5185\u5BB9\u4E3B\u8981\u6765\u81EA\u6211\u7684\u53E6\u4E00\u7BC7\u6587\u7AE0<a href="http://stevenbai.top/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%8A%80%E6%9C%AF/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E6%90%9E%E6%87%82vrf/" target="_blank" rel="noopener noreferrer">\u4E00\u7BC7\u6587\u7AE0\u641E\u61C2VRF</a></p><p>VRF\u5168\u79F0\u662Fverifiable random function ,\u4E5F\u5C31\u662F\u53EF\u9A8C\u8BC1\u968F\u673A\u6570. \u4ED6\u6709\u4E24\u4E2A\u7279\u6027, \u4ED6\u4EA7\u751F\u7684\u662F\u968F\u673A\u6570,\u7B2C\u4E8C\u8FD8\u662F\u53EF\u9A8C\u8BC1\u7684.</p>',7),i=s("p",null,[a("\u6211\u76F4\u63A5\u5F15\u7528"),s("a",{href:"https://en.wikipedia.org/wiki/Verifiable_random_function",target:"_blank",rel:"noopener noreferrer"},"\u7EF4\u57FA\u767E\u79D1\u4E0A\u7684VRF"),a(",\u5C31\u662F\u8BF4\u9488\u5BF9\u4E00\u4E2A\u8F93\u5165x,\u4E00\u4E2A\u79C1\u94A5SK\u7684\u62E5\u6709\u8005\u53EF\u4EE5\u8BA1\u7B97"),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"y"),s("mo",null,"="),s("mi",null,"F"),s("mi",null,"S"),s("mi",null,"K"),s("mo",{stretchy:"false"},"("),s("mi",null,"x"),s("mo",{stretchy:"false"},")")]),s("annotation",{encoding:"application/x-tex"},"y=FSK(x)")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.625em","vertical-align":"-0.19444em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"y"),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"FS"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.07153em"}},"K"),s("span",{class:"mopen"},"("),s("span",{class:"mord mathnormal"},"x"),s("span",{class:"mclose"},")")])])]),a("\u548C\u8BC1\u660E"),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"P"),s("mi",null,"S"),s("mi",null,"K"),s("mo",{stretchy:"false"},"("),s("mi",null,"x"),s("mo",{stretchy:"false"},")")]),s("annotation",{encoding:"application/x-tex"},"PSK(x)")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"PS"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.07153em"}},"K"),s("span",{class:"mopen"},"("),s("span",{class:"mord mathnormal"},"x"),s("span",{class:"mclose"},")")])])]),a(". \u4F9D\u636E\u8BC1\u660E(proof)\u548CSK\u5BF9\u5E94\u7684\u516C\u94A5PK("),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"P"),s("mi",null,"K"),s("mo",null,"="),s("msup",null,[s("mi",null,"g"),s("mrow",null,[s("mi",null,"S"),s("mi",null,"K")])])]),s("annotation",{encoding:"application/x-tex"},"PK=g^{SK}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.68333em","vertical-align":"0em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"P"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.07153em"}},"K"),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1.035771em","vertical-align":"-0.19444em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8413309999999999em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.07153em"}},"K")])])])])])])])])])])]),a("),\u4EFB\u4F55\u4EBA\u90FD\u53EF\u4EE5\u9A8C\u8BC1y\u662F\u88AB\u6B63\u786E\u8BA1\u7B97\u7684,\u4F46\u662F\u4E0D\u80FD\u77E5\u9053SK\u662F\u4EC0\u4E48.")],-1),m=n('<p>\u539F\u6587\u4E2D\u63D0\u5230\u4E86\u4F7F\u7528\u53CC\u7EBF\u6027\u6620\u5C04\u6765\u505A\u8FD9\u4E2A\u4E8B\u60C5,\u5F53\u7136VRF\u53EF\u4EE5\u6709\u5F88\u591A\u79CD\u4E0D\u540C\u7684\u5B9E\u73B0,\u53EA\u8981\u6EE1\u8DB3\u4E0A\u9762\u63D0\u51FA\u7684\u6761\u4EF6\u5373\u53EF.\u4E00\u4E2A\u662F\u968F\u673A\u6570,\u53E6\u4E00\u4E2A\u662F\u53EF\u9A8C\u8BC1.</p><p>\u7B80\u5355\u89E3\u91CA\u4E00\u4E0B:</p><ol><li>\u9A8C\u8BC1\u4EBA\u53EA\u77E5\u9053x,\u5728SK\u6301\u6709\u4EBA\u6CA1\u6709\u5E7F\u64AD\u4E4B\u524D\u4E0D\u77E5\u9053\u968F\u673A\u6570\u662F\u4EC0\u4E48</li><li>SK\u6301\u6709\u4EBA\u65E0\u6CD5\u4F2A\u9020\u968F\u673A\u6570,\u4E00\u65E6x\u786E\u5B9A,\u968F\u673A\u6570\u4E5F\u786E\u5B9A\u4E86. \u8FD9\u5C31\u662F\u6240\u8C13\u7684\u968F\u673A\u6570(\u9664\u4E86SK\u6301\u6709\u4EBA\u4E4B\u5916,\u5176\u4ED6\u4EFB\u4F55\u4EBA\u4E8B\u5148\u4E0D\u77E5\u9053) \u53EF\u9A8C\u8BC1(\u77E5\u9053PK\u7684\u4EFB\u4F55\u4EBA\u90FD\u77E5\u9053SK\u751F\u6210\u7684\u968F\u673A\u6570\u662F\u5426\u5408\u89C4)</li></ol><h2 id="_3-libra\u4E2Dvrf\u7684\u5B9E\u73B0" tabindex="-1">3. Libra\u4E2DVRF\u7684\u5B9E\u73B0 <a class="header-anchor" href="#_3-libra\u4E2Dvrf\u7684\u5B9E\u73B0" aria-hidden="true">#</a></h2><p>Libra\u4E2D\u5BF9\u4E8EVRF\u7684\u5B9E\u73B0\u4F9D\u636E\u6765\u81EA\u4E8E<a href="https://tools.ietf.org/html/draft-irtf-cfrg-vrf-04" target="_blank" rel="noopener noreferrer"> Verifiable Random Functions (VRFs) draft-irtf-cfrg-vrf-04</a> \u611F\u5174\u8DA3\u7684\u53EF\u4EE5\u8BFB\u8BFB\u8FD9\u7BC7\u6807\u51C6\u8349\u6848</p><h3 id="_3-1-\u63A8\u5BFC\u4E2D\u7528\u5230\u7684\u7B26\u53F7\u7684\u542B\u4E49" tabindex="-1">3.1 \u63A8\u5BFC\u4E2D\u7528\u5230\u7684\u7B26\u53F7\u7684\u542B\u4E49 <a class="header-anchor" href="#_3-1-\u63A8\u5BFC\u4E2D\u7528\u5230\u7684\u7B26\u53F7\u7684\u542B\u4E49" aria-hidden="true">#</a></h3>',6),o=s("p",null,[a("B:ED25519\u66F2\u7EBF\u4E2D\u7684\u57FA\u70B9 SK:\u79C1\u94A5 x:\u53EF\u4EE5\u8BA4\u4E3A\u662F\u79C1\u94A5,\u6216\u8005\u6709\u79C1\u94A5\u63A8\u5BFC\u51FA\u6765. Y:\u516C\u94A5,\u5176\u4E2D"),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"Y"),s("mo",null,"="),s("msup",null,[s("mi",null,"B"),s("mi",null,"x")])]),s("annotation",{encoding:"application/x-tex"},"Y=B^x")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.68333em","vertical-align":"0em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.22222em"}},"Y"),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.68333em","vertical-align":"0em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.05017em"}},"B"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.664392em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"x")])])])])])])])])])]),a(" \u5927\u5C0F\u7684\u5B57\u6BCD\u90FD\u8868\u793A\u66F2\u7EBF\u4E0A\u7684\u70B9,\u5C0F\u5199\u5B57\u6BCD\u8868\u793A\u5927\u6574\u6570 \u53E6\u5916\u9700\u8981\u77E5\u9053\u5728ECDSA\u4E2D: 1.\u5982\u679C\u4E00\u4E2A\u6574\u6570\u4E58\u4EE5\u4E00\u4E2A\u70B9,\u5B9E\u9645\u4E0A\u8868\u793A\u51FA\u6765\u5C31\u662F\u6307\u6570,\u6BD4\u5982x*B="),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msup",null,[s("mi",null,"B"),s("mi",null,"x")])]),s("annotation",{encoding:"application/x-tex"},"B^x")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.68333em","vertical-align":"0em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.05017em"}},"B"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.664392em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"x")])])])])])])])])])]),a(" 2. \u4E24\u4E2A\u70B9\u76F8\u51CF\u5219\u8868\u793A\u9664\u6CD5,\u6BD4\u5982H-B="),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mfrac",null,[s("mi",null,"H"),s("mi",null,"B")])]),s("annotation",{encoding:"application/x-tex"},"\\frac H B")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1.217331em","vertical-align":"-0.345em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.872331em"}},[s("span",{style:{top:"-2.6550000000000002em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.05017em"}},"B")])])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.394em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.08125em"}},"H")])])])]),s("span",{class:"vlist-s"},"\u200B")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.345em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})])])])])],-1),r=n(`<h3 id="_3-2-\u751F\u6210\u8FC7\u7A0B" tabindex="-1">3.2 \u751F\u6210\u8FC7\u7A0B <a class="header-anchor" href="#_3-2-\u751F\u6210\u8FC7\u7A0B" aria-hidden="true">#</a></h3><p>\u4E5F\u5C31\u662F\u8BC1\u660E\u65B9\u6309\u7167\u751F\u6210\u4E00\u4E2A\u968F\u673A\u6570,\u5E76\u7ED9\u51FA\u8BC1\u660E,\u8FD9\u4E2A\u968F\u673A\u6570\u5C31\u662F\u6309\u7167\u6211\u4EEC\u786E\u5B9A\u7684\u89C4\u5219\u751F\u6210\u7684.</p><h4 id="_3-2-1-h1-\u628A\u4EFB\u610F\u4FE1\u606F\u6620\u5C04\u5230\u66F2\u7EBF\u4E0A\u7684\u70B9" tabindex="-1">3.2.1 H1:\u628A\u4EFB\u610F\u4FE1\u606F\u6620\u5C04\u5230\u66F2\u7EBF\u4E0A\u7684\u70B9 <a class="header-anchor" href="#_3-2-1-h1-\u628A\u4EFB\u610F\u4FE1\u606F\u6620\u5C04\u5230\u66F2\u7EBF\u4E0A\u7684\u70B9" aria-hidden="true">#</a></h4><p>\u601D\u8DEF\u4E5F\u5F88\u7B80\u5355,\u5C06Hash(m)(<strong>\u6CE8\u610F\u662F256\u4F4Dhash</strong>)\u4F5C\u4E3A\u66F2\u7EBF\u4E0A\u7684X,\u7136\u540E\u5E26\u5165\u4E0A\u8FF0\u692D\u5706\u66F2\u7EBF\u516C\u5F0F,\u6C42\u51FA\u76F8\u5E94\u7684Y\u5373\u53EF. \u5177\u4F53\u5BF9\u5E94\u4EE3\u7801\u4E2D\u5C31\u662F<code>hash_to_curve</code></p><div class="language-rust line-numbers-mode"><pre><code>    <span class="token comment">//self\u662F\u79C1\u94A5,alpha\u5C31\u662FVRF\u7684\u8F93\u5165\u6E90</span>
    <span class="token keyword">pub</span><span class="token punctuation">(</span><span class="token keyword">super</span><span class="token punctuation">)</span> <span class="token keyword">fn</span> <span class="token function-definition function">hash_to_curve</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> alpha<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token keyword">u8</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">EdwardsPoint</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> <span class="token keyword">mut</span> result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0u8</span><span class="token punctuation">;</span> <span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> <span class="token keyword">mut</span> counter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> <span class="token keyword">mut</span> wrapped_point<span class="token punctuation">:</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">EdwardsPoint</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token class-name">None</span><span class="token punctuation">;</span>

        <span class="token keyword">while</span> wrapped_point<span class="token punctuation">.</span><span class="token function">is_none</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            result<span class="token punctuation">.</span><span class="token function">copy_from_slice</span><span class="token punctuation">(</span>
                <span class="token operator">&amp;</span><span class="token class-name">Sha512</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">chain</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token constant">SUITE</span><span class="token punctuation">,</span> <span class="token constant">ONE</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">chain</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">as_bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">chain</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>alpha<span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">chain</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token punctuation">[</span>counter<span class="token punctuation">]</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">..</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//\u8FD9\u91CC\u7528\u7684\u662Fsha512,\u4F46\u662F\u53EA\u53D6\u4E86\u524D\u534A\u90E8\u5206,\u56E0\u6B64\u662F256\u4F4D</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
            wrapped_point <span class="token operator">=</span> <span class="token class-name">CompressedEdwardsY</span><span class="token punctuation">::</span><span class="token function">from_slice</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">decompress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            counter <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        wrapped_point<span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mul_by_cofactor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h4 id="_3-2-2-h2-\u5C06\u4E00\u7CFB\u5217\u70B9hash\u4E3A\u4E00\u4E2A\u5927\u6574\u6570" tabindex="-1">3.2.2 H2: \u5C06\u4E00\u7CFB\u5217\u70B9Hash\u4E3A\u4E00\u4E2A\u5927\u6574\u6570 <a class="header-anchor" href="#_3-2-2-h2-\u5C06\u4E00\u7CFB\u5217\u70B9hash\u4E3A\u4E00\u4E2A\u5927\u6574\u6570" aria-hidden="true">#</a></h4><p>\u8FD9\u4E2A\u5C31\u66F4\u7B80\u5355\u4E86,\u5C06\u8FD9\u4E9B\u70B9\u5E8F\u5217\u5316,\u7136\u540EHash,\u5C31\u5F97\u5230\u4E00\u4E2A\u5927\u6574\u6570. \u53EA\u662F\u9700\u8981\u6CE8\u610F\u7684\u662F\u8FD9\u4E2A\u5927\u6574\u6570\u9700\u8981\u6A21\u4E0A\u66F2\u7EBF\u7684\u9636.</p><div class="language-rust line-numbers-mode"><pre><code><span class="token keyword">pub</span><span class="token punctuation">(</span><span class="token keyword">super</span><span class="token punctuation">)</span> <span class="token keyword">fn</span> <span class="token function-definition function">hash_points</span><span class="token punctuation">(</span>points<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token class-name">EdwardsPoint</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> ed25519_Scalar <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0u8</span><span class="token punctuation">;</span> <span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> hash <span class="token operator">=</span> <span class="token class-name">Sha512</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">chain</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token constant">SUITE</span><span class="token punctuation">,</span> <span class="token constant">TWO</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> point <span class="token keyword">in</span> points<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        hash <span class="token operator">=</span> hash<span class="token punctuation">.</span><span class="token function">chain</span><span class="token punctuation">(</span>point<span class="token punctuation">.</span><span class="token function">compress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">to_bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    result<span class="token punctuation">[</span><span class="token punctuation">..</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">copy_from_slice</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>hash<span class="token punctuation">.</span><span class="token function">result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">..</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ed25519_Scalar<span class="token punctuation">::</span><span class="token function">from_bits</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token comment">//\u8FD9\u91CC\u5B9E\u9645\u4E0A\u5BF9\u57FA\u70B9\u5C31\u662F\u53D6\u6A21</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="_3-2-3-ecvrf-nonce-generation" tabindex="-1">3.2.3 ECVRF_nonce_generation <a class="header-anchor" href="#_3-2-3-ecvrf-nonce-generation" aria-hidden="true">#</a></h4><p>\u6839\u636E\u79C1\u94A5\u548C\u5F85\u7B7E\u540D\u4FE1\u606F\u5BFC\u51FA\u4E00\u4E2A\u786E\u5B9A\u7684\u5927\u6574\u6570. \u8FD9\u91CC\u7684nonce\u662F\u4ECE\u79C1\u94A5\u63A8\u5BFC\u51FA\u6765\u7684,h_point\u5219\u662F\u4E0B\u6587\u4E2D\u7528\u5230\u7684H.</p><div class="language-rust line-numbers-mode"><pre><code><span class="token keyword">pub</span><span class="token punctuation">(</span><span class="token keyword">super</span><span class="token punctuation">)</span> <span class="token keyword">fn</span> <span class="token function-definition function">nonce_generation_bytes</span><span class="token punctuation">(</span>nonce<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token keyword">u8</span><span class="token punctuation">;</span> <span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span> h_point<span class="token punctuation">:</span> <span class="token class-name">EdwardsPoint</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token punctuation">[</span><span class="token keyword">u8</span><span class="token punctuation">;</span> <span class="token number">64</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> k_buf <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0u8</span><span class="token punctuation">;</span> <span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    k_buf<span class="token punctuation">.</span><span class="token function">copy_from_slice</span><span class="token punctuation">(</span>
        <span class="token operator">&amp;</span><span class="token class-name">Sha512</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">chain</span><span class="token punctuation">(</span>nonce<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">chain</span><span class="token punctuation">(</span>h_point<span class="token punctuation">.</span><span class="token function">compress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">as_bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">..</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//\u751F\u6210\u601D\u8DEF\u4E5F\u5F88\u7B80\u5355,\u5C31\u662FHash\u4E00\u4E0B,\u5C31\u53EF\u4EE5\u5F97\u5230\u4E00\u4E2A\u5927\u6574\u6570</span>
    k_buf
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="_3-2-4-\u751F\u6210\u968F\u673A\u6570\u4EE5\u53CA\u8BC1\u660E" tabindex="-1">3.2.4 \u751F\u6210\u968F\u673A\u6570\u4EE5\u53CA\u8BC1\u660E <a class="header-anchor" href="#_3-2-4-\u751F\u6210\u968F\u673A\u6570\u4EE5\u53CA\u8BC1\u660E" aria-hidden="true">#</a></h4>`,12),u=s("p",null,[s("span",{class:"katex-display"},[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("semantics",null,[s("mrow",null,[s("mi",null,"H"),s("mo",null,"="),s("mi",null,"H"),s("mn",null,"1"),s("mo",{stretchy:"false"},"("),s("mi",null,"\u03B1"),s("mo",{stretchy:"false"},")"),s("mspace",{linebreak:"newline"}),s("mi",null,"k"),s("mo",null,"="),s("mi",null,"E"),s("mi",null,"C"),s("mi",null,"V"),s("mi",null,"R"),s("mi",null,"F"),s("mi",{mathvariant:"normal"},"_"),s("mi",null,"n"),s("mi",null,"o"),s("mi",null,"n"),s("mi",null,"c"),s("mi",null,"e"),s("mi",{mathvariant:"normal"},"_"),s("mi",null,"g"),s("mi",null,"e"),s("mi",null,"n"),s("mi",null,"e"),s("mi",null,"r"),s("mi",null,"a"),s("mi",null,"t"),s("mi",null,"i"),s("mi",null,"o"),s("mi",null,"n"),s("mo",{stretchy:"false"},"("),s("mi",null,"S"),s("mi",null,"K"),s("mo",{separator:"true"},","),s("mi",null,"H"),s("mo",{stretchy:"false"},")"),s("mspace",{linebreak:"newline"}),s("mi",{mathvariant:"normal"},"\u0393"),s("mo",null,"="),s("msup",null,[s("mi",null,"H"),s("mi",null,"x")]),s("mspace",{linebreak:"newline"}),s("mi",null,"c"),s("mo",null,"="),s("mi",null,"H"),s("mn",null,"2"),s("mo",{stretchy:"false"},"("),s("mi",null,"H"),s("mo",{separator:"true"},","),s("mi",{mathvariant:"normal"},"\u0393"),s("mo",{separator:"true"},","),s("msup",null,[s("mi",null,"B"),s("mi",null,"k")]),s("mo",{separator:"true"},","),s("msup",null,[s("mi",null,"H"),s("mi",null,"k")]),s("mo",{stretchy:"false"},")"),s("mspace",{linebreak:"newline"}),s("mi",null,"s"),s("mo",null,"="),s("mi",null,"k"),s("mo",null,"+"),s("mi",null,"c"),s("mi",null,"x")]),s("annotation",{encoding:"application/x-tex"},"H=H1(\\alpha) \\\\ k=ECVRF\\_nonce\\_generation(SK,H) \\\\ \\Gamma =H^x \\\\ c=H2(H,\\Gamma,B^k,H^k) \\\\ s=k+cx ")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.68333em","vertical-align":"0em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.08125em"}},"H"),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.08125em"}},"H"),s("span",{class:"mord"},"1"),s("span",{class:"mopen"},"("),s("span",{class:"mord mathnormal",style:{"margin-right":"0.0037em"}},"\u03B1"),s("span",{class:"mclose"},")")]),s("span",{class:"mspace newline"}),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.69444em","vertical-align":"0em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03148em"}},"k"),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1.06em","vertical-align":"-0.31em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.07153em"}},"EC"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.22222em"}},"V"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"RF"),s("span",{class:"mord",style:{"margin-right":"0.02778em"}},"_"),s("span",{class:"mord mathnormal"},"n"),s("span",{class:"mord mathnormal"},"o"),s("span",{class:"mord mathnormal"},"n"),s("span",{class:"mord mathnormal"},"ce"),s("span",{class:"mord",style:{"margin-right":"0.02778em"}},"_"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),s("span",{class:"mord mathnormal"},"e"),s("span",{class:"mord mathnormal"},"n"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"er"),s("span",{class:"mord mathnormal"},"a"),s("span",{class:"mord mathnormal"},"t"),s("span",{class:"mord mathnormal"},"i"),s("span",{class:"mord mathnormal"},"o"),s("span",{class:"mord mathnormal"},"n"),s("span",{class:"mopen"},"("),s("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.07153em"}},"K"),s("span",{class:"mpunct"},","),s("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.08125em"}},"H"),s("span",{class:"mclose"},")")]),s("span",{class:"mspace newline"}),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.68333em","vertical-align":"0em"}}),s("span",{class:"mord"},"\u0393"),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.7143919999999999em","vertical-align":"0em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.08125em"}},"H"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.7143919999999999em"}},[s("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"x")])])])])])])])]),s("span",{class:"mspace newline"}),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.43056em","vertical-align":"0em"}}),s("span",{class:"mord mathnormal"},"c"),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1.149108em","vertical-align":"-0.25em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.08125em"}},"H"),s("span",{class:"mord"},"2"),s("span",{class:"mopen"},"("),s("span",{class:"mord mathnormal",style:{"margin-right":"0.08125em"}},"H"),s("span",{class:"mpunct"},","),s("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),s("span",{class:"mord"},"\u0393"),s("span",{class:"mpunct"},","),s("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.05017em"}},"B"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8991079999999999em"}},[s("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k")])])])])])])]),s("span",{class:"mpunct"},","),s("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.08125em"}},"H"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8991079999999999em"}},[s("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k")])])])])])])]),s("span",{class:"mclose"},")")]),s("span",{class:"mspace newline"}),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.43056em","vertical-align":"0em"}}),s("span",{class:"mord mathnormal"},"s"),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.77777em","vertical-align":"-0.08333em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03148em"}},"k"),s("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),s("span",{class:"mbin"},"+"),s("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.43056em","vertical-align":"0em"}}),s("span",{class:"mord mathnormal"},"c"),s("span",{class:"mord mathnormal"},"x")])])])])],-1),h=s("p",null,[a("\u7136\u540E\u5C06Proof={"),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",{mathvariant:"normal"},"\u0393")]),s("annotation",{encoding:"application/x-tex"},"\\Gamma")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.68333em","vertical-align":"0em"}}),s("span",{class:"mord"},"\u0393")])])]),a(",c,s}\u53D1\u7ED9\u9A8C\u8BC1\u65B9. \u8BC1\u660E\u5176\u5B9E\u5C31\u662F\u60F3\u8BC1\u660E\u6211\u8FD9\u91CC\u7684"),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",{mathvariant:"normal"},"\u0393"),s("mo",null,"="),s("msup",null,[s("mi",null,"H"),s("mi",null,"x")])]),s("annotation",{encoding:"application/x-tex"},"\\Gamma=H^x")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.68333em","vertical-align":"0em"}}),s("span",{class:"mord"},"\u0393"),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.68333em","vertical-align":"0em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.08125em"}},"H"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.664392em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"x")])])])])])])])])])]),a(",\u800C\u4E0D\u662F\u901A\u8FC7\u4EC0\u4E48\u5176\u4ED6\u65B9\u5F0F\u5F97\u5230\u7684.")],-1),g=n(`<div class="language-rust line-numbers-mode"><pre><code><span class="token comment">/// A longer private key which is slightly optimized for proof generation.</span>
<span class="token comment">///</span>
<span class="token comment">/// This is similar in structure to ed25519_dalek::ExpandedSecretKey. It can be produced from</span>
<span class="token comment">/// a VRFPrivateKey.</span>
<span class="token keyword">pub</span> <span class="token keyword">struct</span> <span class="token type-definition class-name">VRFExpandedPrivateKey</span> <span class="token punctuation">{</span>
    <span class="token keyword">pub</span><span class="token punctuation">(</span><span class="token keyword">super</span><span class="token punctuation">)</span> key<span class="token punctuation">:</span> ed25519_Scalar<span class="token punctuation">,</span>
    <span class="token keyword">pub</span><span class="token punctuation">(</span><span class="token keyword">super</span><span class="token punctuation">)</span> nonce<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token keyword">u8</span><span class="token punctuation">;</span> <span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token comment">/// Produces a proof for an input (using the expanded private key)</span>
    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">prove</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> pk<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">VRFPublicKey</span><span class="token punctuation">,</span> alpha<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token keyword">u8</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Proof</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> h_point <span class="token operator">=</span> pk<span class="token punctuation">.</span><span class="token function">hash_to_curve</span><span class="token punctuation">(</span>alpha<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//k\u5B9E\u9645\u4E0A\u662F\u4E00\u4E2A\u968F\u673A\u6570,\u8FD9\u91CC\u91C7\u7528RFC6979\u4E2D\u7684\u89C4\u5219\u662F\u4E3A\u4E86\u8BA9\u6BCF\u6B21\u751F\u6210\u7684proof\u90FD\u5B8C\u5168\u4E00\u6837,</span>
        <span class="token comment">// \u6BD4\u7279\u5E01\u4EE5\u592A\u574A\u7B7E\u540D\u4E2D\u4E5F\u662F\u8FD9\u4E48\u4F7F\u7528\u7684. \u4F46\u662F\u5982\u679C\u4F60\u975E\u8981\u7528\u4E00\u4E2A\u968F\u673A\u6570,\u522B\u4EBA\u4E5F\u6CA1\u529E\u6CD5,</span>
        <span class="token comment">// \u5E76\u4E14\u5B8C\u5168\u884C\u5F97\u901A</span>
        <span class="token keyword">let</span> k_scalar <span class="token operator">=</span>
            ed25519_Scalar<span class="token punctuation">::</span><span class="token function">from_bytes_mod_order_wide</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token function">nonce_generation_bytes</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>nonce<span class="token punctuation">,</span> h_point<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//nonce\u7531\u79C1\u94A5hash\u540E\u751F\u6210,\u53EF\u4EE5\u8BA4\u4E3A\u79C1\u94A5\u786E\u5B9A\u4E86,nonce\u5C31\u786E\u5B9A\u4E86,\u800Ch_point\u548C\u7B7E\u540D\u4E2D\u7684\u7528\u6CD5\u662F\u4E00\u6837\u7684,</span>
        <span class="token comment">// \u5C31\u662F\u5F85\u7B7E\u540D\u4FE1\u606F        \u56E0\u6B64\u539F\u6587\u4E2D\u5171\u8BC6\u662F\u8FD9\u6837\u7684:k = ECVRF_nonce_generation(SK,</span>
        <span class="token comment">// h_string)</span>

        <span class="token comment">//Gamma = x*H</span>
        <span class="token keyword">let</span> gamma <span class="token operator">=</span> h_point <span class="token operator">*</span> <span class="token keyword">self</span><span class="token punctuation">.</span>key<span class="token punctuation">;</span>
        <span class="token comment">//        c = ECVRF_hash_points(H, Gamma, k*B, k*H)</span>
        <span class="token keyword">let</span> c_scalar <span class="token operator">=</span> <span class="token function">hash_points</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token punctuation">[</span>
            h_point<span class="token punctuation">,</span>
            gamma<span class="token punctuation">,</span>
            <span class="token constant">ED25519_BASEPOINT_POINT</span> <span class="token operator">*</span> k_scalar<span class="token punctuation">,</span>
            h_point <span class="token operator">*</span> k_scalar<span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//s = (k + c*x) mod q</span>
        <span class="token comment">//proof={gama,c,s}</span>
        <span class="token class-name">Proof</span> <span class="token punctuation">{</span>
            gamma<span class="token punctuation">,</span> <span class="token comment">//\u8FD9\u4E5F\u662FVRF\u751F\u6210\u7684\u968F\u673A\u6570</span>
            c<span class="token punctuation">:</span> c_scalar<span class="token punctuation">,</span>
            s<span class="token punctuation">:</span> k_scalar <span class="token operator">+</span> c_scalar <span class="token operator">*</span> <span class="token keyword">self</span><span class="token punctuation">.</span>key<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><p>\u9700\u8981\u8865\u5145\u8BF4\u660E\u7684\u662F\u9A8C\u8BC1\u65B9\u4E0D\u53EF\u80FD\u77E5\u9053:</p>`,2),k=s("ol",null,[s("li",null,"\u79C1\u94A5\u4E5F\u5C31\u662Fx"),s("li",null,[a("k,\u8FD9\u662F\u8BC1\u660E\u65B9\u7528ECVRF_nonce_generation\u751F\u6210\u7684 \u867D\u7136\u968F\u673A\u6570\u7528"),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",{mathvariant:"normal"},"\u0393")]),s("annotation",{encoding:"application/x-tex"},"\\Gamma")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.68333em","vertical-align":"0em"}}),s("span",{class:"mord"},"\u0393")])])]),a("\u4E5F\u5C31\u662F\u66F2\u7EBF\u4E0A\u7684\u4E00\u4E2A\u70B9\u6765\u8868\u793A,\u4F46\u662F\u5F88\u5BB9\u6613\u901A\u8FC7Hash\u8BA1\u7B97\u8F6C\u6362\u6210\u4E00\u4E2A\u5927\u6574\u6570")])],-1),d=s("h3",{id:"_3-3-\u9A8C\u8BC1\u7684\u8FC7\u7A0B",tabindex:"-1"},[a("3.3 \u9A8C\u8BC1\u7684\u8FC7\u7A0B "),s("a",{class:"header-anchor",href:"#_3-3-\u9A8C\u8BC1\u7684\u8FC7\u7A0B","aria-hidden":"true"},"#")],-1),y=s("p",null,"\u5DF2\u77E5\u4FE1\u606F:",-1),b=s("ol",null,[s("li",null,"Y:\u516C\u94A5"),s("li",null,[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"\u03B1")]),s("annotation",{encoding:"application/x-tex"},"\\alpha")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.43056em","vertical-align":"0em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.0037em"}},"\u03B1")])])]),a(":VRF\u8F93\u5165\u6E90")]),s("li",null,[a("Proof:{"),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",{mathvariant:"normal"},"\u0393")]),s("annotation",{encoding:"application/x-tex"},"\\Gamma")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.68333em","vertical-align":"0em"}}),s("span",{class:"mord"},"\u0393")])])]),a(",c,s}")])],-1),v=s("p",null,[s("span",{class:"katex-display"},[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("semantics",null,[s("mrow",null,[s("mi",null,"H"),s("mo",null,"="),s("mi",null,"H"),s("mn",null,"1"),s("mo",{stretchy:"false"},"("),s("mi",null,"\u03B1"),s("mo",{stretchy:"false"},")"),s("mspace",{linebreak:"newline"}),s("mi",null,"U"),s("mo",null,"="),s("mfrac",null,[s("msup",null,[s("mi",null,"B"),s("mi",null,"s")]),s("msup",null,[s("mi",null,"Y"),s("mi",null,"c")])]),s("mspace",{linebreak:"newline"}),s("mi",null,"V"),s("mo",null,"="),s("mfrac",null,[s("msup",null,[s("mi",null,"H"),s("mi",null,"s")]),s("msup",null,[s("mi",{mathvariant:"normal"},"\u0393"),s("mi",null,"c")])]),s("mspace",{linebreak:"newline"}),s("msup",null,[s("mi",null,"c"),s("mo",{mathvariant:"normal",lspace:"0em",rspace:"0em"},"\u2032")]),s("mo",null,"="),s("mi",null,"H"),s("mn",null,"2"),s("mo",{stretchy:"false"},"("),s("mi",null,"H"),s("mo",{separator:"true"},","),s("mi",{mathvariant:"normal"},"\u0393"),s("mo",{separator:"true"},","),s("mi",null,"U"),s("mo",{separator:"true"},","),s("mi",null,"V"),s("mo",{stretchy:"false"},")")]),s("annotation",{encoding:"application/x-tex"},"H=H1(\\alpha) \\\\ U=\\frac {B^s} {Y^c} \\\\ V=\\frac {H^s} {\\Gamma^c} \\\\ c'=H2(H,\\Gamma,U,V) ")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.68333em","vertical-align":"0em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.08125em"}},"H"),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.08125em"}},"H"),s("span",{class:"mord"},"1"),s("span",{class:"mopen"},"("),s("span",{class:"mord mathnormal",style:{"margin-right":"0.0037em"}},"\u03B1"),s("span",{class:"mclose"},")")]),s("span",{class:"mspace newline"}),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.68333em","vertical-align":"0em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.10903em"}},"U"),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"2.04633em","vertical-align":"-0.686em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"1.36033em"}},[s("span",{style:{top:"-2.314em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.22222em"}},"Y"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.590392em"}},[s("span",{style:{top:"-2.9890000000000003em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"c")])])])])])])])])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.677em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.05017em"}},"B"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.664392em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"s")])])])])])])])])])]),s("span",{class:"vlist-s"},"\u200B")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.686em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})])]),s("span",{class:"mspace newline"}),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.68333em","vertical-align":"0em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.22222em"}},"V"),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"2.04633em","vertical-align":"-0.686em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"1.36033em"}},[s("span",{style:{top:"-2.314em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord"},"\u0393"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.590392em"}},[s("span",{style:{top:"-2.9890000000000003em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"c")])])])])])])])])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.677em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.08125em"}},"H"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.664392em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"s")])])])])])])])])])]),s("span",{class:"vlist-s"},"\u200B")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.686em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})])]),s("span",{class:"mspace newline"}),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.801892em","vertical-align":"0em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"c"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.801892em"}},[s("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},"\u2032")])])])])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.08125em"}},"H"),s("span",{class:"mord"},"2"),s("span",{class:"mopen"},"("),s("span",{class:"mord mathnormal",style:{"margin-right":"0.08125em"}},"H"),s("span",{class:"mpunct"},","),s("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),s("span",{class:"mord"},"\u0393"),s("span",{class:"mpunct"},","),s("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.10903em"}},"U"),s("span",{class:"mpunct"},","),s("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.22222em"}},"V"),s("span",{class:"mclose"},")")])])])])],-1),_=s("p",null,[s("strong",null,[a("\u5982\u679Cc'\u548Cc\u76F8\u7B49,\u5219\u8BA4\u53EF"),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",{mathvariant:"normal"},"\u0393")]),s("annotation",{encoding:"application/x-tex"},"\\Gamma")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.68333em","vertical-align":"0em"}}),s("span",{class:"mord"},"\u0393")])])]),a("\u5C31\u662F\u8BC1\u660E\u65B9\u6309\u7167\u89C4\u5219\u751F\u4EA7\u7684\u968F\u673A\u6570.")])],-1),f=s("p",null,"\u8FD9\u91CC\u5728\u8BA1\u7B97c'\u548C\u8BC1\u660E\u65B9\u8BA1\u7B97c\u7684\u8FC7\u7A0B\u4E0D\u4E00\u6837\u7684\u5BF9\u65B9\u53EA\u6709\u4E24\u5904:",-1),w=s("ol",null,[s("li",null,[a("\u7528U\u6765\u4EE3\u66FF\u4E86"),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msup",null,[s("mi",null,"B"),s("mi",null,"k")])]),s("annotation",{encoding:"application/x-tex"},"B^k")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.849108em","vertical-align":"0em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.05017em"}},"B"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.849108em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k")])])])])])])])])])]),a(",")]),s("li",null,[a("\u7528V\u4EE3\u66FF\u4E86"),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msup",null,[s("mi",null,"H"),s("mi",null,"k")])]),s("annotation",{encoding:"application/x-tex"},"H^k")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.849108em","vertical-align":"0em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.08125em"}},"H"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.849108em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k")])])])])])])])])])])])],-1),x=s("p",null,"\u63A5\u4E0B\u6765\u6211\u4EEC\u8981\u8BC1\u660E,\u4E24\u8005\u90FD\u662F\u76F8\u7B49\u7684.",-1),z=s("h4",{id:"_3-3-1-\u8BC1\u660Eu",tabindex:"-1"},[a("3.3.1 \u8BC1\u660EU="),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msup",null,[s("mi",null,"B"),s("mi",null,"k")])]),s("annotation",{encoding:"application/x-tex"},"B^k")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.849108em","vertical-align":"0em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.05017em"}},"B"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.849108em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k")])])])])])])])])])]),a(),s("a",{class:"header-anchor",href:"#_3-3-1-\u8BC1\u660Eu","aria-hidden":"true"},"#")],-1),H=s("p",null,[s("span",{class:"katex-display"},[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("semantics",null,[s("mrow",null,[s("mi",null,"U"),s("mo",null,"="),s("mfrac",null,[s("msup",null,[s("mi",null,"B"),s("mi",null,"s")]),s("msup",null,[s("mi",null,"Y"),s("mi",null,"c")])]),s("mspace",{linebreak:"newline"}),s("mo",null,"="),s("mfrac",null,[s("msup",null,[s("mi",null,"B"),s("mrow",null,[s("mi",null,"k"),s("mo",null,"+"),s("mi",null,"c"),s("mi",null,"x")])]),s("msup",null,[s("mi",null,"Y"),s("mi",null,"c")])]),s("mspace",{linebreak:"newline"}),s("mo",null,"="),s("mfrac",null,[s("msup",null,[s("mi",null,"B"),s("mrow",null,[s("mi",null,"k"),s("mo",null,"+"),s("mi",null,"c"),s("mi",null,"x")])]),s("msup",null,[s("msup",null,[s("mi",null,"B"),s("mi",null,"x")]),s("mi",null,"c")])]),s("mspace",{linebreak:"newline"}),s("mo",null,"="),s("mfrac",null,[s("msup",null,[s("mi",null,"B"),s("mrow",null,[s("mi",null,"k"),s("mo",null,"+"),s("mi",null,"c"),s("mi",null,"x")])]),s("msup",null,[s("mi",null,"B"),s("mrow",null,[s("mi",null,"c"),s("mi",null,"x")])])]),s("mspace",{linebreak:"newline"}),s("mo",null,"="),s("msup",null,[s("mi",null,"B"),s("mi",null,"k")])]),s("annotation",{encoding:"application/x-tex"},"U=\\frac {B^s} {Y^c} \\\\ =\\frac {B^{k+cx}} {Y^c} \\\\ =\\frac {B^{k+cx}} {{B^x}^c} \\\\ =\\frac {B^{k+cx}} {B^{cx}} \\\\ =B^k ")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.68333em","vertical-align":"0em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.10903em"}},"U"),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"2.04633em","vertical-align":"-0.686em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"1.36033em"}},[s("span",{style:{top:"-2.314em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.22222em"}},"Y"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.590392em"}},[s("span",{style:{top:"-2.9890000000000003em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"c")])])])])])])])])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.677em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.05017em"}},"B"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.664392em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"s")])])])])])])])])])]),s("span",{class:"vlist-s"},"\u200B")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.686em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})])]),s("span",{class:"mspace newline"}),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.36687em","vertical-align":"0em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"2.2121079999999997em","vertical-align":"-0.686em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"1.5261079999999998em"}},[s("span",{style:{top:"-2.314em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.22222em"}},"Y"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.590392em"}},[s("span",{style:{top:"-2.9890000000000003em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"c")])])])])])])])])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.677em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.05017em"}},"B"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8491079999999999em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k"),s("span",{class:"mbin mtight"},"+"),s("span",{class:"mord mathnormal mtight"},"c"),s("span",{class:"mord mathnormal mtight"},"x")])])])])])])])])])])]),s("span",{class:"vlist-s"},"\u200B")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.686em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})])]),s("span",{class:"mspace newline"}),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.36687em","vertical-align":"0em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"2.2121079999999997em","vertical-align":"-0.686em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"1.5261079999999998em"}},[s("span",{style:{top:"-2.314em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.05017em"}},"B"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.590392em"}},[s("span",{style:{top:"-2.9890000000000003em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"x")])])])])])])])]),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.737622em"}},[s("span",{style:{top:"-3.1362300000000003em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"c")])])])])])])])])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.677em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.05017em"}},"B"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8491079999999999em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k"),s("span",{class:"mbin mtight"},"+"),s("span",{class:"mord mathnormal mtight"},"c"),s("span",{class:"mord mathnormal mtight"},"x")])])])])])])])])])])]),s("span",{class:"vlist-s"},"\u200B")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.686em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})])]),s("span",{class:"mspace newline"}),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.36687em","vertical-align":"0em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"2.2121079999999997em","vertical-align":"-0.686em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"1.5261079999999998em"}},[s("span",{style:{top:"-2.314em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.05017em"}},"B"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.590392em"}},[s("span",{style:{top:"-2.9890000000000003em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight"},"c"),s("span",{class:"mord mathnormal mtight"},"x")])])])])])])])])])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.677em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.05017em"}},"B"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8491079999999999em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k"),s("span",{class:"mbin mtight"},"+"),s("span",{class:"mord mathnormal mtight"},"c"),s("span",{class:"mord mathnormal mtight"},"x")])])])])])])])])])])]),s("span",{class:"vlist-s"},"\u200B")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.686em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})])]),s("span",{class:"mspace newline"}),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.36687em","vertical-align":"0em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8991079999999999em","vertical-align":"0em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.05017em"}},"B"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8991079999999999em"}},[s("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k")])])])])])])])])])])])],-1),E=s("h4",{id:"_3-3-2-\u8BC1\u660Ev",tabindex:"-1"},[a("3.3.2 \u8BC1\u660EV="),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msup",null,[s("mi",null,"H"),s("mi",null,"k")])]),s("annotation",{encoding:"application/x-tex"},"H^k")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.849108em","vertical-align":"0em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.08125em"}},"H"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.849108em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k")])])])])])])])])])]),a(),s("a",{class:"header-anchor",href:"#_3-3-2-\u8BC1\u660Ev","aria-hidden":"true"},"#")],-1),B=s("p",null,[s("span",{class:"katex-display"},[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("semantics",null,[s("mrow",null,[s("mi",null,"V"),s("mo",null,"="),s("mfrac",null,[s("msup",null,[s("mi",null,"H"),s("mi",null,"s")]),s("msup",null,[s("mi",{mathvariant:"normal"},"\u0393"),s("mi",null,"c")])]),s("mspace",{linebreak:"newline"}),s("mo",null,"="),s("mfrac",null,[s("msup",null,[s("mi",null,"H"),s("mrow",null,[s("mi",null,"k"),s("mo",null,"+"),s("mi",null,"c"),s("mi",null,"x")])]),s("msup",null,[s("mi",{mathvariant:"normal"},"\u0393"),s("mi",null,"c")])]),s("mspace",{linebreak:"newline"}),s("mo",null,"="),s("mfrac",null,[s("msup",null,[s("mi",null,"H"),s("mrow",null,[s("mi",null,"k"),s("mo",null,"+"),s("mi",null,"c"),s("mi",null,"x")])]),s("msup",null,[s("msup",null,[s("mi",null,"H"),s("mi",null,"x")]),s("mi",null,"c")])]),s("mspace",{linebreak:"newline"}),s("mo",null,"="),s("mfrac",null,[s("msup",null,[s("mi",null,"H"),s("mrow",null,[s("mi",null,"k"),s("mo",null,"+"),s("mi",null,"c"),s("mi",null,"x")])]),s("msup",null,[s("mi",null,"H"),s("mrow",null,[s("mi",null,"c"),s("mi",null,"x")])])]),s("mspace",{linebreak:"newline"}),s("mo",null,"="),s("msup",null,[s("mi",null,"H"),s("mi",null,"k")])]),s("annotation",{encoding:"application/x-tex"},"V=\\frac {H^s} {\\Gamma^c} \\\\ = \\frac {H^{k+cx}} {\\Gamma^c} \\\\ = \\frac {H^{k+cx}} {{H^x}^c} \\\\ = \\frac {H^{k+cx}} {H^{cx}} \\\\ = H^k ")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.68333em","vertical-align":"0em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.22222em"}},"V"),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"2.04633em","vertical-align":"-0.686em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"1.36033em"}},[s("span",{style:{top:"-2.314em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord"},"\u0393"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.590392em"}},[s("span",{style:{top:"-2.9890000000000003em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"c")])])])])])])])])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.677em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.08125em"}},"H"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.664392em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"s")])])])])])])])])])]),s("span",{class:"vlist-s"},"\u200B")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.686em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})])]),s("span",{class:"mspace newline"}),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.36687em","vertical-align":"0em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"2.2121079999999997em","vertical-align":"-0.686em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"1.5261079999999998em"}},[s("span",{style:{top:"-2.314em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord"},"\u0393"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.590392em"}},[s("span",{style:{top:"-2.9890000000000003em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"c")])])])])])])])])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.677em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.08125em"}},"H"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8491079999999999em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k"),s("span",{class:"mbin mtight"},"+"),s("span",{class:"mord mathnormal mtight"},"c"),s("span",{class:"mord mathnormal mtight"},"x")])])])])])])])])])])]),s("span",{class:"vlist-s"},"\u200B")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.686em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})])]),s("span",{class:"mspace newline"}),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.36687em","vertical-align":"0em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"2.2121079999999997em","vertical-align":"-0.686em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"1.5261079999999998em"}},[s("span",{style:{top:"-2.314em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.08125em"}},"H"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.590392em"}},[s("span",{style:{top:"-2.9890000000000003em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"x")])])])])])])])]),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.737622em"}},[s("span",{style:{top:"-3.1362300000000003em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"c")])])])])])])])])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.677em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.08125em"}},"H"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8491079999999999em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k"),s("span",{class:"mbin mtight"},"+"),s("span",{class:"mord mathnormal mtight"},"c"),s("span",{class:"mord mathnormal mtight"},"x")])])])])])])])])])])]),s("span",{class:"vlist-s"},"\u200B")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.686em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})])]),s("span",{class:"mspace newline"}),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.36687em","vertical-align":"0em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"2.2121079999999997em","vertical-align":"-0.686em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"1.5261079999999998em"}},[s("span",{style:{top:"-2.314em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.08125em"}},"H"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.590392em"}},[s("span",{style:{top:"-2.9890000000000003em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight"},"c"),s("span",{class:"mord mathnormal mtight"},"x")])])])])])])])])])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.677em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.08125em"}},"H"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8491079999999999em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k"),s("span",{class:"mbin mtight"},"+"),s("span",{class:"mord mathnormal mtight"},"c"),s("span",{class:"mord mathnormal mtight"},"x")])])])])])])])])])])]),s("span",{class:"vlist-s"},"\u200B")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.686em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})])]),s("span",{class:"mspace newline"}),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.36687em","vertical-align":"0em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8991079999999999em","vertical-align":"0em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.08125em"}},"H"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8991079999999999em"}},[s("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k")])])])])])])])])])])])],-1),M=n(`<h4 id="_3-3-3-\u5B9E\u73B0\u8FC7\u7A0B" tabindex="-1">3.3.3 \u5B9E\u73B0\u8FC7\u7A0B <a class="header-anchor" href="#_3-3-3-\u5B9E\u73B0\u8FC7\u7A0B" aria-hidden="true">#</a></h4><div class="language-rust line-numbers-mode"><pre><code>
<span class="token comment">/// An ECVRF public key</span>
<span class="token attribute attr-name">#[derive(Serialize, Deserialize, Deref, Debug, PartialEq, Eq)]</span>
<span class="token keyword">pub</span> <span class="token keyword">struct</span> <span class="token type-definition class-name">VRFPublicKey</span><span class="token punctuation">(</span>ed25519_PublicKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token comment">/// Given a [\`Proof\`] and an input, returns whether or not the proof is valid for the input</span>
    <span class="token comment">/// and public key</span>
    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">verify</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> proof<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Proof</span><span class="token punctuation">,</span> alpha<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token keyword">u8</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">//\u540C\u6837\u5C06\u5DF2\u77E5\u7684\u786E\u5B9A\u4FE1\u606Falpha\u6620\u5C04\u5230H\u70B9</span>
        <span class="token keyword">let</span> h_point <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">hash_to_curve</span><span class="token punctuation">(</span>alpha<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//PK:\u662F\u516C\u94A5</span>
        <span class="token keyword">let</span> pk_point <span class="token operator">=</span> <span class="token class-name">CompressedEdwardsY</span><span class="token punctuation">::</span><span class="token function">from_slice</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">as_bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">decompress</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//c&#39; = ECVRF_hash_points(H, Gamma, U, V)</span>
        <span class="token keyword">let</span> cprime <span class="token operator">=</span> <span class="token function">hash_points</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token punctuation">[</span>
            h_point<span class="token punctuation">,</span>
            proof<span class="token punctuation">.</span>gamma<span class="token punctuation">,</span>
            <span class="token constant">ED25519_BASEPOINT_POINT</span> <span class="token operator">*</span> proof<span class="token punctuation">.</span>s <span class="token operator">-</span> pk_point <span class="token operator">*</span> proof<span class="token punctuation">.</span>c<span class="token punctuation">,</span> <span class="token comment">//U=s*B - c*Y</span>
            h_point <span class="token operator">*</span> proof<span class="token punctuation">.</span>s <span class="token operator">-</span> proof<span class="token punctuation">.</span>gamma <span class="token operator">*</span> proof<span class="token punctuation">.</span>c<span class="token punctuation">,</span>              <span class="token comment">//V= s*H - c*Gamma</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//\u76F8\u7B49\u5219\u6709\u6548,\u4E0D\u7B49\u5219\u65E0\u6548</span>
        <span class="token keyword">if</span> proof<span class="token punctuation">.</span>c <span class="token operator">==</span> cprime <span class="token punctuation">{</span>
            <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token macro property">bail!</span><span class="token punctuation">(</span><span class="token string">&quot;The proof failed to verify for this public key&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h2 id="_4-\u7ED3\u675F\u8BED" tabindex="-1">4. \u7ED3\u675F\u8BED <a class="header-anchor" href="#_4-\u7ED3\u675F\u8BED" aria-hidden="true">#</a></h2><p>VRF\u662F\u4E00\u4E2A\u597D\u4E1C\u897F,\u7ED9\u533A\u5757\u94FE\u5E26\u6765\u4E86\u53EF\u9884\u6D4B\u7684\u4F2A\u968F\u673A\u6027. \u4E0D\u8FC7\u5728Libra\u4E2D\u53F7\u79F0\u81EA\u5DF1\u4F7F\u7528\u4E86VRF,\u5E76\u4E14\u4E5F\u5728\u4EE3\u7801\u4E2D\u770B\u5230\u4E86\u5B9E\u73B0.\u5C31\u662F\u6CA1\u6709\u627E\u5230\u4F7F\u7528\u7684\u5730\u65B9,\u53EF\u80FD\u662F\u6211\u7684\u627E\u6CD5\u4E0D\u5BF9? \u6211\u770B\u7684\u4EE3\u7801\u7248\u672C\u662F<a href="https://github.com/libra/libra/tree/d324ce75cc9bcc6777a2b45c756f4df2f47c4ef3/crypto" target="_blank" rel="noopener noreferrer">d324ce75cc9bcc6777a2b45c756f4df2f47c4ef3</a></p>`,4),V=[c,i,m,o,r,u,h,g,k,d,y,b,v,_,f,w,x,z,H,E,B,M];function S(P,T,A,F,R,K){return e(),l("div",null,V)}var D=t(p,[["render",S]]);export{L as __pageData,D as default};
