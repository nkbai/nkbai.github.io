import{_ as t,c as p,o as e,a,d as s,e as n}from"./app.be400e50.js";const z='{"title":"ECC\u7B7E\u540D\u4E2D\u968F\u673A\u6570\u4E0D\u968F\u673A\u7684\u5371\u5BB3","description":"","frontmatter":{"title":"ECC\u7B7E\u540D\u4E2D\u968F\u673A\u6570\u4E0D\u968F\u673A\u7684\u5371\u5BB3","date":"2020-09-03T00:57:03.000Z","draft":false,"markup":"mmark"},"headers":[{"level":3,"title":"\u692D\u5706\u66F2\u7EBF\u7B7E\u540D\u7B97\u6CD5\u539F\u7406","slug":"\u692D\u5706\u66F2\u7EBF\u7B7E\u540D\u7B97\u6CD5\u539F\u7406"},{"level":3,"title":"go\u5B9E\u73B0\u7684\u7B7E\u540D","slug":"go\u5B9E\u73B0\u7684\u7B7E\u540D"},{"level":3,"title":"go\u5B9E\u73B0\u7684\u7B7E\u540D\u9A8C\u8BC1\u8FC7\u7A0B","slug":"go\u5B9E\u73B0\u7684\u7B7E\u540D\u9A8C\u8BC1\u8FC7\u7A0B"},{"level":3,"title":"\u4F7F\u7528\u4E86\u76F8\u540C\u7684\u968F\u673A\u6570n,\u4E3A\u4EC0\u4E48\u80FD\u63A8\u51FA\u79C1\u94A5","slug":"\u4F7F\u7528\u4E86\u76F8\u540C\u7684\u968F\u673A\u6570n-\u4E3A\u4EC0\u4E48\u80FD\u63A8\u51FA\u79C1\u94A5"},{"level":3,"title":"\u9A8C\u8BC1","slug":"\u9A8C\u8BC1"}],"relativePath":"blockchain/block_chain_core/ecc_signature_random.md"}',l={},c=a('<ul><li><a href="#%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF%E7%AD%BE%E5%90%8D%E7%AE%97%E6%B3%95%E5%8E%9F%E7%90%86">\u692D\u5706\u66F2\u7EBF\u7B7E\u540D\u7B97\u6CD5\u539F\u7406</a></li><li><a href="#go%E5%AE%9E%E7%8E%B0%E7%9A%84%E7%AD%BE%E5%90%8D">go\u5B9E\u73B0\u7684\u7B7E\u540D</a></li><li><a href="#go%E5%AE%9E%E7%8E%B0%E7%9A%84%E7%AD%BE%E5%90%8D%E9%AA%8C%E8%AF%81%E8%BF%87%E7%A8%8B">go\u5B9E\u73B0\u7684\u7B7E\u540D\u9A8C\u8BC1\u8FC7\u7A0B</a></li><li><a href="#%E4%BD%BF%E7%94%A8%E4%BA%86%E7%9B%B8%E5%90%8C%E7%9A%84%E9%9A%8F%E6%9C%BA%E6%95%B0n%E4%B8%BA%E4%BB%80%E4%B9%88%E8%83%BD%E6%8E%A8%E5%87%BA%E7%A7%81%E9%92%A5">\u4F7F\u7528\u4E86\u76F8\u540C\u7684\u968F\u673A\u6570n,\u4E3A\u4EC0\u4E48\u80FD\u63A8\u51FA\u79C1\u94A5</a></li><li><a href="#%E9%AA%8C%E8%AF%81">\u9A8C\u8BC1</a></li></ul><p>\u5982\u679C\u4F7F\u7528\u4E86\u76F8\u540C\u7684\u968F\u673A\u6570,\u4E3A\u4EC0\u4E48\u4F1A\u6CC4\u9732\u79C1\u94A5.</p><h3 id="\u692D\u5706\u66F2\u7EBF\u7B7E\u540D\u7B97\u6CD5\u539F\u7406" tabindex="-1">\u692D\u5706\u66F2\u7EBF\u7B7E\u540D\u7B97\u6CD5\u539F\u7406 <a class="header-anchor" href="#\u692D\u5706\u66F2\u7EBF\u7B7E\u540D\u7B97\u6CD5\u539F\u7406" aria-hidden="true">#</a></h3>',3),o=s("p",null,[n("\u5047\u8BBE\u79C1\u94A5\u4E3Ak,\u90A3\u4E48\u516C\u94A5"),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"K"),s("mo",null,"="),s("mi",null,"k"),s("mi",null,"G")]),s("annotation",{encoding:"application/x-tex"},"K=kG")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.68333em","vertical-align":"0em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.07153em"}},"K"),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.69444em","vertical-align":"0em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03148em"}},"k"),s("span",{class:"mord mathnormal"},"G")])])]),n(",\u5176\u4E2DG\u4E3AG\u70B9(\u5C31\u662F\u692D\u5706\u66F2\u7EBF\u7684\u516C\u5171\u53C2\u6570,\u53EF\u4EE5\u5FFD\u7565). \u7B7E\u540D\u7684\u8FC7\u7A0B\u5982\u4E0B:")],-1),u=s("ol",null,[s("li",null,[n("\u9009\u62E9\u968F\u673A\u6570n,\u8BA1\u7B97"),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"P"),s("mo",null,"="),s("mi",null,"n"),s("mi",null,"G")]),s("annotation",{encoding:"application/x-tex"},"P=nG")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.68333em","vertical-align":"0em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"P"),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.68333em","vertical-align":"0em"}}),s("span",{class:"mord mathnormal"},"n"),s("span",{class:"mord mathnormal"},"G")])])]),n(",P\u5B9E\u9645\u4E0A\u5C31\u662F\u66F2\u7EBF\u4E0A\u7684\u4E00\u4E2A\u70B9")]),s("li",null,[n("\u8BA1\u7B97"),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"s"),s("mo",null,"="),s("mfrac",null,[s("mrow",null,[s("mi",null,"m"),s("mo",null,"+"),s("mi",null,"k"),s("mi",null,"r")]),s("mi",null,"n")])]),s("annotation",{encoding:"application/x-tex"},"s=\\frac {m+kr} n")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.43056em","vertical-align":"0em"}}),s("span",{class:"mord mathnormal"},"s"),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1.2251079999999999em","vertical-align":"-0.345em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8801079999999999em"}},[s("span",{style:{top:"-2.6550000000000002em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight"},"n")])])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.394em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight"},"m"),s("span",{class:"mbin mtight"},"+"),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k"),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])])]),s("span",{class:"vlist-s"},"\u200B")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.345em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})])])])]),n(",\u5176\u4E2Dm\u5C31\u662F\u516C\u5171\u4FE1\u606F,\u6BD4\u5982\u662F\u4E00\u4E2A\u4EE5\u592A\u574A\u4EA4\u6613\u7684Hash\u503C. \u8FD9\u91CC\u7684r\u662FP\u7684x\u5750\u6807.")]),s("li",null,"\u5C06\u6D88\u606Fm\u548C\u7B7E\u540D{r,s}\u53D1\u9001\u7ED9\u63A5\u6536\u65B9 \u63A5\u6536\u65B9\u5728\u4E8B\u5148\u77E5\u9053\u516C\u94A5K\u7684\u60C5\u51B5\u4E0B,\u5C31\u5F88\u5BB9\u6613\u9A8C\u8BC1\u7B7E\u540D\u548Cm\u662F\u5426\u662F\u5BF9\u5E94\u5173\u7CFB. \u9A8C\u8BC1\u7B7E\u540D\u7684\u8FC7\u7A0B: \u8BA1\u7B97$\\frac {mG} s + \\frac {rK} s $,\u7136\u540E\u4E0EnG\u6BD4\u8F83,\u5982\u679C\u76F8\u7B49\u8BF4\u660E\u662F\u5BF9\u5E94\u5173\u7CFB.\u5176\u4E2Dr\u662FnG\u8FD9\u4E2A\u70B9\u7684x\u5750\u6807")],-1),i=s("p",null,"\u4E3A\u4EC0\u4E48\u8FD9\u6837\u53EF\u4EE5\u5462,\u6765\u770B\u4E00\u4E0B\u7B80\u5355\u7684\u63A8\u5BFC\u8FC7\u7A0B:",-1),r=n(" \\begin{eqnarray} & \\frac {mG} s + \\frac {rK} s \\\\ =& \\frac {mG} s + \\frac {r(kG)} s \\\\ =& \\frac {(m+rk)G} s \\\\ =& \\frac {n(m+rk)G} {m+kr} \\\\ =& nG \\end{eqnarray} "),m=s("p",null,[s("strong",null,[n("\u6CE8\u610F: "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"s"),s("mo",null,"="),s("mfrac",null,[s("mrow",null,[s("mi",null,"m"),s("mo",null,"+"),s("mi",null,"k"),s("mi",null,"r")]),s("mi",null,"n")])]),s("annotation",{encoding:"application/x-tex"},"s=\\frac {m+kr} n")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.43056em","vertical-align":"0em"}}),s("span",{class:"mord mathnormal"},"s"),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1.2251079999999999em","vertical-align":"-0.345em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8801079999999999em"}},[s("span",{style:{top:"-2.6550000000000002em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight"},"n")])])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.394em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight"},"m"),s("span",{class:"mbin mtight"},"+"),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k"),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])])]),s("span",{class:"vlist-s"},"\u200B")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.345em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})])])])])])],-1),k=a(`<h3 id="go\u5B9E\u73B0\u7684\u7B7E\u540D" tabindex="-1">go\u5B9E\u73B0\u7684\u7B7E\u540D <a class="header-anchor" href="#go\u5B9E\u73B0\u7684\u7B7E\u540D" aria-hidden="true">#</a></h3><p>\u4EE5\u4E0B\u4EE3\u7801\u6765\u81EA<a href="https://github.com/btcsuite/btcd/blob/master/btcec/signature.go" target="_blank" rel="noopener noreferrer">btcd</a></p><div class="language-go line-numbers-mode"><pre><code><span class="token comment">// signRFC6979 generates a deterministic ECDSA signature according to RFC 6979 and BIP 62.</span>
<span class="token keyword">func</span> <span class="token function">signRFC6979</span><span class="token punctuation">(</span>privateKey <span class="token operator">*</span>PrivateKey<span class="token punctuation">,</span> hash <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>Signature<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

	privkey <span class="token operator">:=</span> privateKey<span class="token punctuation">.</span><span class="token function">ToECDSA</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	N <span class="token operator">:=</span> <span class="token function">S256</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>N
	halfOrder <span class="token operator">:=</span> <span class="token function">S256</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>halfOrder
	k <span class="token operator">:=</span> <span class="token function">nonceRFC6979</span><span class="token punctuation">(</span>privkey<span class="token punctuation">.</span>D<span class="token punctuation">,</span> hash<span class="token punctuation">)</span> <span class="token comment">//\u8FD9\u91CC\u7684k\u5BF9\u5E94\u7684\u662F\u4E0A\u8FF0\u516C\u5F0F\u4E2D\u7684n</span>
	inv <span class="token operator">:=</span> <span class="token function">new</span><span class="token punctuation">(</span>big<span class="token punctuation">.</span>Int<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ModInverse</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> N<span class="token punctuation">)</span> <span class="token comment">//n^(-1)</span>
	r<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> privkey<span class="token punctuation">.</span>Curve<span class="token punctuation">.</span><span class="token function">ScalarBaseMult</span><span class="token punctuation">(</span>k<span class="token punctuation">.</span><span class="token function">Bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//r\u662F\u4E0A\u8FF0\u516C\u5F0F\u4E2D\u7684r,\u5C31\u662FP\u7684x\u5750\u6807</span>
	r<span class="token punctuation">.</span><span class="token function">Mod</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> N<span class="token punctuation">)</span> <span class="token comment">//r%N</span>

	<span class="token keyword">if</span> r<span class="token punctuation">.</span><span class="token function">Sign</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;calculated R is zero&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	e <span class="token operator">:=</span> <span class="token function">hashToInt</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> privkey<span class="token punctuation">.</span>Curve<span class="token punctuation">)</span> <span class="token comment">//\u8FD9\u4E2Ae\u53EF\u4EE5\u8BA4\u4E3A\u662F\u4EE3\u7B7E\u540D\u6D88\u606Fm,\u8FD9\u91CC\u662F\u5C06hash\u8F6C\u6362\u6210\u4E00\u4E2A256\u4F4D\u7684\u6574\u6570\u6765\u53C2\u4E0E\u8BA1\u7B97</span>
	s <span class="token operator">:=</span> <span class="token function">new</span><span class="token punctuation">(</span>big<span class="token punctuation">.</span>Int<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Mul</span><span class="token punctuation">(</span>privkey<span class="token punctuation">.</span>D<span class="token punctuation">,</span> r<span class="token punctuation">)</span> <span class="token comment">//s=rG</span>
	s<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> e<span class="token punctuation">)</span> <span class="token comment">// s=s+e</span>
	s<span class="token punctuation">.</span><span class="token function">Mul</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> inv<span class="token punctuation">)</span> <span class="token comment">//s=s*(n^(-1))</span>
	s<span class="token punctuation">.</span><span class="token function">Mod</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> N<span class="token punctuation">)</span> <span class="token comment">//s=s%N  \u8FD9\u4E94\u884C\u4EE3\u7801\u5C31\u662F\u8BA1\u7B97\`$s=\\frac {m+kr} n$\`</span>

	<span class="token keyword">if</span> s<span class="token punctuation">.</span><span class="token function">Cmp</span><span class="token punctuation">(</span>halfOrder<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">{</span> 
		s<span class="token punctuation">.</span><span class="token function">Sub</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span> s<span class="token punctuation">)</span> <span class="token comment">//s\u4E0D\u80FD\u8D85\u8FC7N/2</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> s<span class="token punctuation">.</span><span class="token function">Sign</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;calculated S is zero&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>Signature<span class="token punctuation">{</span>R<span class="token punctuation">:</span> r<span class="token punctuation">,</span> S<span class="token punctuation">:</span> s<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h3 id="go\u5B9E\u73B0\u7684\u7B7E\u540D\u9A8C\u8BC1\u8FC7\u7A0B" tabindex="-1">go\u5B9E\u73B0\u7684\u7B7E\u540D\u9A8C\u8BC1\u8FC7\u7A0B <a class="header-anchor" href="#go\u5B9E\u73B0\u7684\u7B7E\u540D\u9A8C\u8BC1\u8FC7\u7A0B" aria-hidden="true">#</a></h3><p>\u4EE5\u4E0B\u4EE3\u7801\u6765\u81EAgo\u6807\u51C6\u5E93\u7684crypto/ecdsa/ecdsa.go</p><div class="language-go line-numbers-mode"><pre><code><span class="token comment">// Verify verifies the signature in r, s of hash using the public key, pub. Its</span>
<span class="token comment">// return value records whether the signature is valid.</span>
<span class="token keyword">func</span> <span class="token function">Verify</span><span class="token punctuation">(</span>pub <span class="token operator">*</span>PublicKey<span class="token punctuation">,</span> hash <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> r<span class="token punctuation">,</span> s <span class="token operator">*</span>big<span class="token punctuation">.</span>Int<span class="token punctuation">)</span> <span class="token builtin">bool</span> <span class="token punctuation">{</span>
	<span class="token comment">// See [NSA] 3.4.2</span>
	c <span class="token operator">:=</span> pub<span class="token punctuation">.</span>Curve
	N <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">Params</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>N

	<span class="token keyword">if</span> r<span class="token punctuation">.</span><span class="token function">Sign</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">||</span> s<span class="token punctuation">.</span><span class="token function">Sign</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">false</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> r<span class="token punctuation">.</span><span class="token function">Cmp</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">||</span> s<span class="token punctuation">.</span><span class="token function">Cmp</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">false</span>
	<span class="token punctuation">}</span>
	e <span class="token operator">:=</span> <span class="token function">hashToInt</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> c<span class="token punctuation">)</span>

	<span class="token keyword">var</span> w <span class="token operator">*</span>big<span class="token punctuation">.</span>Int
	<span class="token keyword">if</span> in<span class="token punctuation">,</span> ok <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token punctuation">(</span>invertible<span class="token punctuation">)</span><span class="token punctuation">;</span> ok <span class="token punctuation">{</span>
		w <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">Inverse</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
		w <span class="token operator">=</span> <span class="token function">new</span><span class="token punctuation">(</span>big<span class="token punctuation">.</span>Int<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ModInverse</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> N<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	u1 <span class="token operator">:=</span> e<span class="token punctuation">.</span><span class="token function">Mul</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> w<span class="token punctuation">)</span>
	u1<span class="token punctuation">.</span><span class="token function">Mod</span><span class="token punctuation">(</span>u1<span class="token punctuation">,</span> N<span class="token punctuation">)</span>
	u2 <span class="token operator">:=</span> w<span class="token punctuation">.</span><span class="token function">Mul</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> w<span class="token punctuation">)</span>
	u2<span class="token punctuation">.</span><span class="token function">Mod</span><span class="token punctuation">(</span>u2<span class="token punctuation">,</span> N<span class="token punctuation">)</span>

	<span class="token comment">// Check if implements S1*g + S2*p</span>
	<span class="token keyword">var</span> x<span class="token punctuation">,</span> y <span class="token operator">*</span>big<span class="token punctuation">.</span>Int
	<span class="token keyword">if</span> opt<span class="token punctuation">,</span> ok <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token punctuation">(</span>combinedMult<span class="token punctuation">)</span><span class="token punctuation">;</span> ok <span class="token punctuation">{</span>
		x<span class="token punctuation">,</span> y <span class="token operator">=</span> opt<span class="token punctuation">.</span><span class="token function">CombinedMult</span><span class="token punctuation">(</span>pub<span class="token punctuation">.</span>X<span class="token punctuation">,</span> pub<span class="token punctuation">.</span>Y<span class="token punctuation">,</span> u1<span class="token punctuation">.</span><span class="token function">Bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> u2<span class="token punctuation">.</span><span class="token function">Bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
		x1<span class="token punctuation">,</span> y1 <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">ScalarBaseMult</span><span class="token punctuation">(</span>u1<span class="token punctuation">.</span><span class="token function">Bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		x2<span class="token punctuation">,</span> y2 <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">ScalarMult</span><span class="token punctuation">(</span>pub<span class="token punctuation">.</span>X<span class="token punctuation">,</span> pub<span class="token punctuation">.</span>Y<span class="token punctuation">,</span> u2<span class="token punctuation">.</span><span class="token function">Bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		x<span class="token punctuation">,</span> y <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>x1<span class="token punctuation">,</span> y1<span class="token punctuation">,</span> x2<span class="token punctuation">,</span> y2<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> x<span class="token punctuation">.</span><span class="token function">Sign</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> y<span class="token punctuation">.</span><span class="token function">Sign</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">false</span>
	<span class="token punctuation">}</span>
	x<span class="token punctuation">.</span><span class="token function">Mod</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> N<span class="token punctuation">)</span>
	<span class="token keyword">return</span> x<span class="token punctuation">.</span><span class="token function">Cmp</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><h3 id="\u4F7F\u7528\u4E86\u76F8\u540C\u7684\u968F\u673A\u6570n-\u4E3A\u4EC0\u4E48\u80FD\u63A8\u51FA\u79C1\u94A5" tabindex="-1">\u4F7F\u7528\u4E86\u76F8\u540C\u7684\u968F\u673A\u6570n,\u4E3A\u4EC0\u4E48\u80FD\u63A8\u51FA\u79C1\u94A5 <a class="header-anchor" href="#\u4F7F\u7528\u4E86\u76F8\u540C\u7684\u968F\u673A\u6570n-\u4E3A\u4EC0\u4E48\u80FD\u63A8\u51FA\u79C1\u94A5" aria-hidden="true">#</a></h3><p>\u5982\u679C\u4F7F\u7528\u4E86\u76F8\u540C\u7684\u968F\u673A\u6570n,\u90A3\u4E48\u7B7E\u540D\u4E2D\u7684{r,s}\u4E2D\u7684r\u80AF\u5B9A\u4E5F\u662F\u76F8\u540C\u7684,\u56E0\u4E3Ar\u662FnG\u7684x\u5750\u6807. \u90A3\u4E48\u6765\u770B\u770B\u63A8\u5230\u7684\u8FC7\u7A0B.</p>`,8),b=s("p",null,[s("span",{class:"katex-display"},[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"s"),s("mn",null,"1")]),s("mo",null,"="),s("mfrac",null,[s("mrow",null,[s("msub",null,[s("mi",null,"m"),s("mn",null,"1")]),s("mo",null,"+"),s("mi",null,"k"),s("mi",null,"r")]),s("mi",null,"n")]),s("mspace",{linebreak:"newline"}),s("msub",null,[s("mi",null,"s"),s("mn",null,"2")]),s("mo",null,"="),s("mfrac",null,[s("mrow",null,[s("msub",null,[s("mi",null,"m"),s("mn",null,"2")]),s("mo",null,"+"),s("mi",null,"k"),s("mi",null,"r")]),s("mi",null,"n")]),s("mspace",{linebreak:"newline"}),s("msub",null,[s("mi",null,"s"),s("mn",null,"1")]),s("mo",null,"\u2212"),s("msub",null,[s("mi",null,"s"),s("mn",null,"2")]),s("mo",null,"="),s("mfrac",null,[s("mrow",null,[s("msub",null,[s("mi",null,"m"),s("mn",null,"1")]),s("mo",null,"\u2212"),s("msub",null,[s("mi",null,"m"),s("mn",null,"2")])]),s("mi",null,"n")]),s("mspace",{linebreak:"newline"}),s("mi",null,"n"),s("mo",null,"="),s("mfrac",null,[s("mrow",null,[s("msub",null,[s("mi",null,"m"),s("mn",null,"1")]),s("mo",null,"\u2212"),s("msub",null,[s("mi",null,"m"),s("mn",null,"2")])]),s("mrow",null,[s("msub",null,[s("mi",null,"s"),s("mn",null,"1")]),s("mo",null,"\u2212"),s("msub",null,[s("mi",null,"s"),s("mn",null,"2")])])])]),s("annotation",{encoding:"application/x-tex"},"s_1=\\frac {m_1+kr} n \\\\ s_2=\\frac {m_2+kr} n \\\\ s_1-s_2= \\frac {m_1-m_2} n \\\\ n=\\frac {m_1-m_2} {s_1-s_2} ")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.58056em","vertical-align":"-0.15em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"s"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.30110799999999993em"}},[s("span",{style:{top:"-2.5500000000000003em","margin-left":"0em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},"1")])])]),s("span",{class:"vlist-s"},"\u200B")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"2.05744em","vertical-align":"-0.686em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"1.37144em"}},[s("span",{style:{top:"-2.314em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"n")])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.677em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"m"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.30110799999999993em"}},[s("span",{style:{top:"-2.5500000000000003em","margin-left":"0em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},"1")])])]),s("span",{class:"vlist-s"},"\u200B")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),s("span",{class:"mbin"},"+"),s("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03148em"}},"k"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"r")])])]),s("span",{class:"vlist-s"},"\u200B")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.686em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})])]),s("span",{class:"mspace newline"}),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.58056em","vertical-align":"-0.15em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"s"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.30110799999999993em"}},[s("span",{style:{top:"-2.5500000000000003em","margin-left":"0em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},"2")])])]),s("span",{class:"vlist-s"},"\u200B")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"2.05744em","vertical-align":"-0.686em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"1.37144em"}},[s("span",{style:{top:"-2.314em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"n")])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.677em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"m"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.30110799999999993em"}},[s("span",{style:{top:"-2.5500000000000003em","margin-left":"0em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},"2")])])]),s("span",{class:"vlist-s"},"\u200B")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),s("span",{class:"mbin"},"+"),s("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03148em"}},"k"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"r")])])]),s("span",{class:"vlist-s"},"\u200B")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.686em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})])]),s("span",{class:"mspace newline"}),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.73333em","vertical-align":"-0.15em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"s"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.30110799999999993em"}},[s("span",{style:{top:"-2.5500000000000003em","margin-left":"0em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},"1")])])]),s("span",{class:"vlist-s"},"\u200B")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),s("span",{class:"mbin"},"\u2212"),s("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.58056em","vertical-align":"-0.15em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"s"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.30110799999999993em"}},[s("span",{style:{top:"-2.5500000000000003em","margin-left":"0em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},"2")])])]),s("span",{class:"vlist-s"},"\u200B")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1.9463300000000001em","vertical-align":"-0.686em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"1.2603300000000002em"}},[s("span",{style:{top:"-2.314em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"n")])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.677em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"m"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.30110799999999993em"}},[s("span",{style:{top:"-2.5500000000000003em","margin-left":"0em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},"1")])])]),s("span",{class:"vlist-s"},"\u200B")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),s("span",{class:"mbin"},"\u2212"),s("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"m"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.30110799999999993em"}},[s("span",{style:{top:"-2.5500000000000003em","margin-left":"0em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},"2")])])]),s("span",{class:"vlist-s"},"\u200B")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])])])])]),s("span",{class:"vlist-s"},"\u200B")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.686em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})])]),s("span",{class:"mspace newline"}),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.43056em","vertical-align":"0em"}}),s("span",{class:"mord mathnormal"},"n"),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"2.09633em","vertical-align":"-0.8360000000000001em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"1.2603300000000002em"}},[s("span",{style:{top:"-2.3139999999999996em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"s"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.30110799999999993em"}},[s("span",{style:{top:"-2.5500000000000003em","margin-left":"0em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},"1")])])]),s("span",{class:"vlist-s"},"\u200B")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),s("span",{class:"mbin"},"\u2212"),s("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"s"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.30110799999999993em"}},[s("span",{style:{top:"-2.5500000000000003em","margin-left":"0em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},"2")])])]),s("span",{class:"vlist-s"},"\u200B")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])])])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.677em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"m"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.30110799999999993em"}},[s("span",{style:{top:"-2.5500000000000003em","margin-left":"0em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},"1")])])]),s("span",{class:"vlist-s"},"\u200B")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),s("span",{class:"mbin"},"\u2212"),s("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"m"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.30110799999999993em"}},[s("span",{style:{top:"-2.5500000000000003em","margin-left":"0em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},"2")])])]),s("span",{class:"vlist-s"},"\u200B")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])])])])]),s("span",{class:"vlist-s"},"\u200B")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8360000000000001em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})])])])])])],-1),h=s("p",null,"\u6709\u4E86n\u4EE5\u540E,\u90A3\u4E48\u6765\u770B\u4E00\u4E0Bk\u7684\u8BA1\u7B97\u8FC7\u7A0B:",-1),g=s("p",null,[s("span",{class:"katex-display"},[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("semantics",null,[s("mrow",null,[s("mi",null,"s"),s("mo",null,"="),s("mfrac",null,[s("mrow",null,[s("mi",null,"m"),s("mo",null,"+"),s("mi",null,"k"),s("mi",null,"r")]),s("mi",null,"n")]),s("mspace",{linebreak:"newline"}),s("mi",null,"k"),s("mo",null,"="),s("mfrac",null,[s("mrow",null,[s("mi",null,"s"),s("mi",null,"n"),s("mo",null,"\u2212"),s("mi",null,"m")]),s("mi",null,"r")])]),s("annotation",{encoding:"application/x-tex"},"s=\\frac {m+kr} n \\\\ k=\\frac {sn-m} r ")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.43056em","vertical-align":"0em"}}),s("span",{class:"mord mathnormal"},"s"),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"2.05744em","vertical-align":"-0.686em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"1.37144em"}},[s("span",{style:{top:"-2.314em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"n")])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.677em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"m"),s("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),s("span",{class:"mbin"},"+"),s("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03148em"}},"k"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"r")])])]),s("span",{class:"vlist-s"},"\u200B")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.686em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})])]),s("span",{class:"mspace newline"}),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.69444em","vertical-align":"0em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03148em"}},"k"),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1.9463300000000001em","vertical-align":"-0.686em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"1.2603300000000002em"}},[s("span",{style:{top:"-2.314em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"r")])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.677em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"s"),s("span",{class:"mord mathnormal"},"n"),s("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),s("span",{class:"mbin"},"\u2212"),s("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),s("span",{class:"mord mathnormal"},"m")])])]),s("span",{class:"vlist-s"},"\u200B")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.686em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})])])])])])],-1),d=a(`<h3 id="\u9A8C\u8BC1" tabindex="-1">\u9A8C\u8BC1 <a class="header-anchor" href="#\u9A8C\u8BC1" aria-hidden="true">#</a></h3><p>\u4E5F\u5C31\u662F\u8BF4,\u90A3\u6015\u53EA\u7528\u4E86\u4E00\u6B21\u76F8\u540C\u7684k,\u79C1\u94A5\u90FD\u4F1A\u6CC4\u9732.</p><div class="language-go line-numbers-mode"><pre><code><span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;crypto/ecdsa&quot;</span>
	<span class="token string">&quot;crypto/elliptic&quot;</span>
	<span class="token string">&quot;encoding/hex&quot;</span>
	<span class="token string">&quot;errors&quot;</span>
	<span class="token string">&quot;log&quot;</span>
	<span class="token string">&quot;math/big&quot;</span>
	<span class="token string">&quot;testing&quot;</span>

	<span class="token string">&quot;github.com/btcsuite/btcd/btcec&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// hashToInt converts a hash value to an integer. There is some disagreement</span>
<span class="token comment">// about how this is done. [NSA] suggests that this is done in the obvious</span>
<span class="token comment">// manner, but [SECG] truncates the hash to the bit-length of the curve order</span>
<span class="token comment">// first. We follow [SECG] because that&#39;s what OpenSSL does. Additionally,</span>
<span class="token comment">// OpenSSL right shifts excess bits from the number if the hash is too large</span>
<span class="token comment">// and we mirror that too.</span>
<span class="token comment">// This is borrowed from crypto/ecdsa.</span>
<span class="token keyword">func</span> <span class="token function">hashToInt</span><span class="token punctuation">(</span>hash <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> c elliptic<span class="token punctuation">.</span>Curve<span class="token punctuation">)</span> <span class="token operator">*</span>big<span class="token punctuation">.</span>Int <span class="token punctuation">{</span>
	orderBits <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">Params</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>N<span class="token punctuation">.</span><span class="token function">BitLen</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	orderBytes <span class="token operator">:=</span> <span class="token punctuation">(</span>orderBits <span class="token operator">+</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">8</span>
	<span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>hash<span class="token punctuation">)</span> <span class="token operator">&gt;</span> orderBytes <span class="token punctuation">{</span>
		hash <span class="token operator">=</span> hash<span class="token punctuation">[</span><span class="token punctuation">:</span>orderBytes<span class="token punctuation">]</span>
	<span class="token punctuation">}</span>

	ret <span class="token operator">:=</span> <span class="token function">new</span><span class="token punctuation">(</span>big<span class="token punctuation">.</span>Int<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetBytes</span><span class="token punctuation">(</span>hash<span class="token punctuation">)</span>
	excess <span class="token operator">:=</span> <span class="token function">len</span><span class="token punctuation">(</span>hash<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">8</span> <span class="token operator">-</span> orderBits
	<span class="token keyword">if</span> excess <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
		ret<span class="token punctuation">.</span><span class="token function">Rsh</span><span class="token punctuation">(</span>ret<span class="token punctuation">,</span> <span class="token function">uint</span><span class="token punctuation">(</span>excess<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> ret
<span class="token punctuation">}</span>

<span class="token comment">// PrivKeyFromBytes returns a private and public key for \`curve&#39; based on the</span>
<span class="token comment">// private key passed as an argument as a byte slice.</span>
<span class="token keyword">func</span> <span class="token function">privKeyFromBytes</span><span class="token punctuation">(</span>curve elliptic<span class="token punctuation">.</span>Curve<span class="token punctuation">,</span> pk <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>ecdsa<span class="token punctuation">.</span>PrivateKey<span class="token punctuation">,</span>
	<span class="token operator">*</span>ecdsa<span class="token punctuation">.</span>PublicKey<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	x<span class="token punctuation">,</span> y <span class="token operator">:=</span> curve<span class="token punctuation">.</span><span class="token function">ScalarBaseMult</span><span class="token punctuation">(</span>pk<span class="token punctuation">)</span>

	priv <span class="token operator">:=</span> <span class="token operator">&amp;</span>ecdsa<span class="token punctuation">.</span>PrivateKey<span class="token punctuation">{</span>
		PublicKey<span class="token punctuation">:</span> ecdsa<span class="token punctuation">.</span>PublicKey<span class="token punctuation">{</span>
			Curve<span class="token punctuation">:</span> curve<span class="token punctuation">,</span>
			X<span class="token punctuation">:</span>     x<span class="token punctuation">,</span>
			Y<span class="token punctuation">:</span>     y<span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		D<span class="token punctuation">:</span> <span class="token function">new</span><span class="token punctuation">(</span>big<span class="token punctuation">.</span>Int<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetBytes</span><span class="token punctuation">(</span>pk<span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> priv<span class="token punctuation">,</span> <span class="token operator">&amp;</span>priv<span class="token punctuation">.</span>PublicKey
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">getPrivateKey</span><span class="token punctuation">(</span>hash1<span class="token punctuation">,</span> hash2 <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> r<span class="token punctuation">,</span> s1<span class="token punctuation">,</span> s2 <span class="token operator">*</span>big<span class="token punctuation">.</span>Int<span class="token punctuation">,</span> pub <span class="token operator">*</span>ecdsa<span class="token punctuation">.</span>PublicKey<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>ecdsa<span class="token punctuation">.</span>PrivateKey<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	c <span class="token operator">:=</span> btcec<span class="token punctuation">.</span><span class="token function">S256</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	m1 <span class="token operator">:=</span> <span class="token function">hashToInt</span><span class="token punctuation">(</span>hash1<span class="token punctuation">,</span> c<span class="token punctuation">)</span>
	m2 <span class="token operator">:=</span> <span class="token function">hashToInt</span><span class="token punctuation">(</span>hash2<span class="token punctuation">,</span> c<span class="token punctuation">)</span>
	ss1 <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>big<span class="token punctuation">.</span>Int<span class="token punctuation">{</span>s1<span class="token punctuation">,</span> <span class="token function">new</span><span class="token punctuation">(</span>big<span class="token punctuation">.</span>Int<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Sub</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>N<span class="token punctuation">,</span> s1<span class="token punctuation">)</span><span class="token punctuation">}</span>
	ss2 <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>big<span class="token punctuation">.</span>Int<span class="token punctuation">{</span>s2<span class="token punctuation">,</span> <span class="token function">new</span><span class="token punctuation">(</span>big<span class="token punctuation">.</span>Int<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Sub</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>N<span class="token punctuation">,</span> s2<span class="token punctuation">)</span><span class="token punctuation">}</span>
	<span class="token comment">//\u8FD9\u91CC\u8FD9\u4E48\u5904\u7406\u662F\u56E0\u4E3As1,s2\u6709\u53EF\u80FD\u56E0\u4E3A\u8D85\u8FC7\u4E86N/2,\u800C\u8FDB\u884C\u4E86N-s,\u8FD9\u91CC\u53EA\u80FD\u8FDB\u884C\u56DB\u79CD\u7EC4\u5408\u6D4B\u8BD5.</span>
	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> s1 <span class="token operator">=</span> <span class="token keyword">range</span> ss1 <span class="token punctuation">{</span>
		<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> s2 <span class="token operator">=</span> <span class="token keyword">range</span> ss2 <span class="token punctuation">{</span>
			s <span class="token operator">:=</span> <span class="token function">new</span><span class="token punctuation">(</span>big<span class="token punctuation">.</span>Int<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Sub</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> s2<span class="token punctuation">)</span>
			m <span class="token operator">:=</span> <span class="token function">new</span><span class="token punctuation">(</span>big<span class="token punctuation">.</span>Int<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Sub</span><span class="token punctuation">(</span>m1<span class="token punctuation">,</span> m2<span class="token punctuation">)</span>
			s <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">Mod</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> c<span class="token punctuation">.</span>N<span class="token punctuation">)</span>
			s <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">ModInverse</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> c<span class="token punctuation">.</span>N<span class="token punctuation">)</span>
			n <span class="token operator">:=</span> s<span class="token punctuation">.</span><span class="token function">Mul</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> m<span class="token punctuation">)</span>

			k <span class="token operator">:=</span> <span class="token function">new</span><span class="token punctuation">(</span>big<span class="token punctuation">.</span>Int<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Mul</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
			k <span class="token operator">=</span> k<span class="token punctuation">.</span><span class="token function">Sub</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> m1<span class="token punctuation">)</span>
			r<span class="token punctuation">.</span><span class="token function">ModInverse</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> c<span class="token punctuation">.</span>N<span class="token punctuation">)</span>
			k <span class="token operator">=</span> k<span class="token punctuation">.</span><span class="token function">Mul</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> r<span class="token punctuation">)</span>
			k <span class="token operator">=</span> k<span class="token punctuation">.</span><span class="token function">Mod</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> c<span class="token punctuation">.</span>N<span class="token punctuation">)</span>
			log<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;k=%s&quot;</span><span class="token punctuation">,</span> k<span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token comment">//\u901A\u8FC7k\u6765\u751F\u6210\u516C\u94A5,\u5982\u679C\u5339\u914D,\u8BF4\u660E\u79C1\u94A5\u6B63\u786E</span>
			priv<span class="token punctuation">,</span> pub2 <span class="token operator">:=</span> <span class="token function">privKeyFromBytes</span><span class="token punctuation">(</span>btcec<span class="token punctuation">.</span><span class="token function">S256</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> k<span class="token punctuation">.</span><span class="token function">Bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token keyword">if</span> pub2<span class="token punctuation">.</span>X<span class="token punctuation">.</span><span class="token function">Cmp</span><span class="token punctuation">(</span>pub<span class="token punctuation">.</span>X<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> pub2<span class="token punctuation">.</span>Y<span class="token punctuation">.</span><span class="token function">Cmp</span><span class="token punctuation">(</span>pub<span class="token punctuation">.</span>Y<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
				<span class="token keyword">return</span> priv<span class="token punctuation">,</span> <span class="token boolean">nil</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;not found private key&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">/*
privkey=eaf02ca348c524e6392655ba4d29603cd1a7347d9d65cfe93ce1ebffdca22694
pubkey=045ceeba2ab4a635df2c0301a3d773da06ac5a18a7c3e0d09a795d7e57d233edf1001aa641732e6a703be89a7fb8568df05675111fcddd519e0cc6c2dd72cd73f8
hash1=00010203040506070809 sig1 r=e8f0817ae1ad2c1c35770dc8fff5f0ed513769e39e2af6e8e0b4f42e5a60251d,s=2c77219de3f968d38434e89a68428c1c30892e891e02708849137ebb61301794
hash2=00010203040506070810 sig2 r=e8f0817ae1ad2c1c35770dc8fff5f0ed513769e39e2af6e8e0b4f42e5a60251d,s=344d47eb5b12343bdc8f80eed6c910f2b543359b1373b7dabac1ba2658d23906
\u5C1D\u8BD5\u901A\u8FC7\u76F8\u540C\u7684r\u6765\u6062\u590D\u79C1\u94A5
*/</span>
<span class="token keyword">func</span> <span class="token function">TestGetPrivkey</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	c <span class="token operator">:=</span> btcec<span class="token punctuation">.</span><span class="token function">S256</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	pubkeybin<span class="token punctuation">,</span> err <span class="token operator">:=</span> hex<span class="token punctuation">.</span><span class="token function">DecodeString</span><span class="token punctuation">(</span><span class="token string">&quot;045ceeba2ab4a635df2c0301a3d773da06ac5a18a7c3e0d09a795d7e57d233edf1001aa641732e6a703be89a7fb8568df05675111fcddd519e0cc6c2dd72cd73f8&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		t<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	pub<span class="token punctuation">,</span> err <span class="token operator">:=</span> btcec<span class="token punctuation">.</span><span class="token function">ParsePubKey</span><span class="token punctuation">(</span>pubkeybin<span class="token punctuation">,</span> c<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		t<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;privkey: %v&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	hash1 <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">{</span><span class="token number">0x0</span><span class="token punctuation">,</span> <span class="token number">0x1</span><span class="token punctuation">,</span> <span class="token number">0x2</span><span class="token punctuation">,</span> <span class="token number">0x3</span><span class="token punctuation">,</span> <span class="token number">0x4</span><span class="token punctuation">,</span> <span class="token number">0x5</span><span class="token punctuation">,</span> <span class="token number">0x6</span><span class="token punctuation">,</span> <span class="token number">0x7</span><span class="token punctuation">,</span> <span class="token number">0x8</span><span class="token punctuation">,</span> <span class="token number">0x9</span><span class="token punctuation">}</span>
	hash2 <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">{</span><span class="token number">0x0</span><span class="token punctuation">,</span> <span class="token number">0x1</span><span class="token punctuation">,</span> <span class="token number">0x2</span><span class="token punctuation">,</span> <span class="token number">0x3</span><span class="token punctuation">,</span> <span class="token number">0x4</span><span class="token punctuation">,</span> <span class="token number">0x5</span><span class="token punctuation">,</span> <span class="token number">0x6</span><span class="token punctuation">,</span> <span class="token number">0x7</span><span class="token punctuation">,</span> <span class="token number">0x8</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">}</span>
	s1<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> <span class="token function">new</span><span class="token punctuation">(</span>big<span class="token punctuation">.</span>Int<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetString</span><span class="token punctuation">(</span><span class="token string">&quot;2c77219de3f968d38434e89a68428c1c30892e891e02708849137ebb61301794&quot;</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
	s2<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> <span class="token function">new</span><span class="token punctuation">(</span>big<span class="token punctuation">.</span>Int<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetString</span><span class="token punctuation">(</span><span class="token string">&quot;344d47eb5b12343bdc8f80eed6c910f2b543359b1373b7dabac1ba2658d23906&quot;</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
	r1<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> <span class="token function">new</span><span class="token punctuation">(</span>big<span class="token punctuation">.</span>Int<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetString</span><span class="token punctuation">(</span><span class="token string">&quot;e8f0817ae1ad2c1c35770dc8fff5f0ed513769e39e2af6e8e0b4f42e5a60251d&quot;</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
	priv<span class="token punctuation">,</span> err <span class="token operator">:=</span> <span class="token function">getPrivateKey</span><span class="token punctuation">(</span>hash1<span class="token punctuation">,</span> hash2<span class="token punctuation">,</span> r1<span class="token punctuation">,</span> s1<span class="token punctuation">,</span> s2<span class="token punctuation">,</span> pub<span class="token punctuation">.</span><span class="token function">ToECDSA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		t<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
		log<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;priv=%s&quot;</span><span class="token punctuation">,</span> priv<span class="token punctuation">.</span>D<span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br></div></div>`,3),y=[c,o,u,i,r,m,k,b,h,g,d];function f(v,w,_,x,E,S){return e(),p("div",null,y)}var A=t(l,[["render",f]]);export{z as __pageData,A as default};
