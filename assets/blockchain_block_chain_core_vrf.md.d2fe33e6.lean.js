import{o as s,c as a,b as n,d as l,e as t}from"./app.e869f547.js";const e='{"title":"一篇文章搞懂VRF","description":"","frontmatter":{"title":"一篇文章搞懂VRF","date":"2019-06-16T03:57:03.000Z","draft":false,"markup":"mmark"},"headers":[{"level":2,"title":"一种错误的实现","slug":"一种错误的实现"},{"level":3,"title":"椭圆曲线签名算法原理","slug":"椭圆曲线签名算法原理"},{"level":3,"title":"比特币和以太坊中的数字签名可以做VRF么?","slug":"比特币和以太坊中的数字签名可以做vrf么"},{"level":2,"title":"一种正确的实现","slug":"一种正确的实现"},{"level":3,"title":"公式推导","slug":"公式推导"},{"level":2,"title":"在椭圆曲线上的实现","slug":"在椭圆曲线上的实现"},{"level":3,"title":"接口原型","slug":"接口原型"},{"level":3,"title":"使用方法","slug":"使用方法"},{"level":2,"title":"推荐实现","slug":"推荐实现"},{"level":3,"title":"1. 谷歌的keytransparency项目","slug":"_1-谷歌的keytransparency项目"},{"level":3,"title":"2. Spectrum上使用的VRF","slug":"_2-spectrum上使用的vrf"},{"level":3,"title":"3. witnet上的VRF","slug":"_3-witnet上的vrf"}],"relativePath":"blockchain/block_chain_core/vrf.md","lastUpdated":1641604782000}',m={},p=[n("ul",null,[n("li",null,[n("a",{href:"#%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E6%90%9E%E6%87%82vrf"},"一篇文章搞懂VRF")])],-1),n("ul",null,[n("li",null,[n("a",{href:"#%E4%B8%80%E7%A7%8D%E9%94%99%E8%AF%AF%E7%9A%84%E5%AE%9E%E7%8E%B0"},"一种错误的实现"),n("ul",null,[n("li",null,[n("a",{href:"#%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF%E7%AD%BE%E5%90%8D%E7%AE%97%E6%B3%95%E5%8E%9F%E7%90%86"},"椭圆曲线签名算法原理"),n("ul",null,[n("li",null,[n("a",{href:"#%E9%82%A3%E4%B9%88%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF%E7%9A%84%E7%AD%BE%E5%90%8D%E5%8F%AF%E5%90%A6%E5%BD%93%E5%81%9Avrf%E5%91%A2"},"那么椭圆曲线的签名可否当做VRF呢?")])])]),n("li",null,[n("a",{href:"#%E6%AF%94%E7%89%B9%E5%B8%81%E5%92%8C%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%B8%AD%E7%9A%84%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D%E5%8F%AF%E4%BB%A5%E5%81%9Avrf%E4%B9%88"},"比特币和以太坊中的数字签名可以做VRF么?")])])]),n("li",null,[n("a",{href:"#%E4%B8%80%E7%A7%8D%E6%AD%A3%E7%A1%AE%E7%9A%84%E5%AE%9E%E7%8E%B0"},"一种正确的实现"),n("ul",null,[n("li",null,[n("a",{href:"#%E5%85%AC%E5%BC%8F%E6%8E%A8%E5%AF%BC"},"公式推导"),n("ul",null,[n("li",null,[n("a",{href:"#h1%E6%8A%8A%E4%BB%BB%E6%84%8F%E4%BF%A1%E6%81%AF%E6%98%A0%E5%B0%84%E5%88%B0%E6%9B%B2%E7%BA%BF%E4%B8%8A%E7%9A%84%E7%82%B9"},"H1:把任意信息映射到曲线上的点")]),n("li",null,[n("a",{href:"#h2-%E6%98%A0%E5%B0%84%E4%BB%BB%E6%84%8F%E4%BF%A1%E6%81%AF%E4%B8%BA1q"},"H2: 映射任意信息为(1,q)")]),n("li",null,[n("a",{href:"#%E8%AE%A1%E7%AE%97%E9%9A%8F%E6%9C%BA%E6%95%B0"},"计算随机数")]),n("li",null,[n("a",{href:"#%E9%9A%8F%E6%9C%BA%E6%95%B0%E7%9A%84proof"},"随机数的proof")]),n("li",null,[n("a",{href:"#%E5%A6%82%E4%BD%95%E9%AA%8C%E8%AF%81"},"如何验证")]),n("li",null,[n("a",{href:"#%E7%94%9F%E6%88%90gr-hr"},[l("生成"),n("span",{class:"katex"},[n("span",{class:"katex-mathml"},[n("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[n("semantics",null,[n("mrow",null,[n("msup",null,[n("mi",null,"g"),n("mi",null,"r")])]),n("annotation",{encoding:"application/x-tex"},"g^r")])])]),n("span",{class:"katex-html","aria-hidden":"true"},[n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.858832em","vertical-align":"-0.19444em"}}),n("span",{class:"mord"},[n("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.664392em"}},[n("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])])])])])])])])]),l(" , "),n("span",{class:"katex"},[n("span",{class:"katex-mathml"},[n("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[n("semantics",null,[n("mrow",null,[n("msup",null,[n("mi",null,"h"),n("mi",null,"r")])]),n("annotation",{encoding:"application/x-tex"},"h^r")])])]),n("span",{class:"katex-html","aria-hidden":"true"},[n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.69444em","vertical-align":"0em"}}),n("span",{class:"mord"},[n("span",{class:"mord mathnormal"},"h"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.664392em"}},[n("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])])])])])])])])])])])])])])]),n("li",null,[n("a",{href:"#%E5%9C%A8%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF%E4%B8%8A%E7%9A%84%E5%AE%9E%E7%8E%B0"},"在椭圆曲线上的实现"),n("ul",null,[n("li",null,[n("a",{href:"#%E6%8E%A5%E5%8F%A3%E5%8E%9F%E5%9E%8B"},"接口原型")]),n("li",null,[n("a",{href:"#%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95"},"使用方法")])])]),n("li",null,[n("a",{href:"#%E6%8E%A8%E8%8D%90%E5%AE%9E%E7%8E%B0"},"推荐实现"),n("ul",null,[n("li",null,[n("a",{href:"#1-%E8%B0%B7%E6%AD%8C%E7%9A%84keytransparency%E9%A1%B9%E7%9B%AE"},"1. 谷歌的keytransparency项目")]),n("li",null,[n("a",{href:"#2-spectrum%E4%B8%8A%E4%BD%BF%E7%94%A8%E7%9A%84vrf"},"2. Spectrum上使用的VRF")]),n("li",null,[n("a",{href:"#3-witnet%E4%B8%8A%E7%9A%84vrf"},"3. witnet上的VRF")])])])],-1),n("p",null,"什么是VRF,VRF全称是verifiable random function ,也就是可验证随机数. 他有两个特性, 他产生的是随机数,第二还是可验证的.",-1),n("p",null,[l("我直接引用"),n("a",{href:"https://en.wikipedia.org/wiki/Verifiable_random_function",target:"_blank",rel:"noopener noreferrer"},"维基百科上的VRF"),l(",就是说针对一个输入x,一个私钥SK的拥有者可以计算"),n("span",{class:"katex"},[n("span",{class:"katex-mathml"},[n("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[n("semantics",null,[n("mrow",null,[n("mi",null,"y"),n("mo",null,"="),n("mi",null,"F"),n("mi",null,"S"),n("mi",null,"K"),n("mo",{stretchy:"false"},"("),n("mi",null,"x"),n("mo",{stretchy:"false"},")")]),n("annotation",{encoding:"application/x-tex"},"y=FSK(x)")])])]),n("span",{class:"katex-html","aria-hidden":"true"},[n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.625em","vertical-align":"-0.19444em"}}),n("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"y"),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),n("span",{class:"mrel"},"="),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),n("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"FS"),n("span",{class:"mord mathnormal",style:{"margin-right":"0.07153em"}},"K"),n("span",{class:"mopen"},"("),n("span",{class:"mord mathnormal"},"x"),n("span",{class:"mclose"},")")])])]),l("和证明"),n("span",{class:"katex"},[n("span",{class:"katex-mathml"},[n("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[n("semantics",null,[n("mrow",null,[n("mi",null,"P"),n("mi",null,"S"),n("mi",null,"K"),n("mo",{stretchy:"false"},"("),n("mi",null,"x"),n("mo",{stretchy:"false"},")")]),n("annotation",{encoding:"application/x-tex"},"PSK(x)")])])]),n("span",{class:"katex-html","aria-hidden":"true"},[n("span",{class:"base"},[n("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),n("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"PS"),n("span",{class:"mord mathnormal",style:{"margin-right":"0.07153em"}},"K"),n("span",{class:"mopen"},"("),n("span",{class:"mord mathnormal"},"x"),n("span",{class:"mclose"},")")])])]),l(". 依据证明(proof)和SK对应的公钥PK("),n("span",{class:"katex"},[n("span",{class:"katex-mathml"},[n("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[n("semantics",null,[n("mrow",null,[n("mi",null,"P"),n("mi",null,"K"),n("mo",null,"="),n("msup",null,[n("mi",null,"g"),n("mrow",null,[n("mi",null,"S"),n("mi",null,"K")])])]),n("annotation",{encoding:"application/x-tex"},"PK=g^{SK}")])])]),n("span",{class:"katex-html","aria-hidden":"true"},[n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.68333em","vertical-align":"0em"}}),n("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"P"),n("span",{class:"mord mathnormal",style:{"margin-right":"0.07153em"}},"K"),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),n("span",{class:"mrel"},"="),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"1.035771em","vertical-align":"-0.19444em"}}),n("span",{class:"mord"},[n("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.8413309999999999em"}},[n("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mtight"},[n("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.05764em"}},"S"),n("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.07153em"}},"K")])])])])])])])])])])]),l("),任何人都可以验证y是被正确计算的,但是不能知道SK是什么.")],-1),n("p",null,"原文中提到了使用双线性映射来做这个事情,当然VRF可以有很多种不同的实现,只要满足上面提出的条件即可.一个是随机数,另一个是可验证.",-1),n("p",null,"简单解释一下:",-1),n("ol",null,[n("li",null,"验证人只知道x,在SK持有人没有广播之前不知道随机数是什么"),n("li",null,"SK持有人无法伪造随机数,一旦x确定,随机数也确定了. 这就是所谓的随机数(除了SK持有人之外,其他任何人事先不知道) 可验证(知道PK的任何人都知道SK生成的随机数是否合规)")],-1),n("h2",{id:"一种错误的实现"},[n("a",{class:"header-anchor",href:"#一种错误的实现","aria-hidden":"true"},"#"),l(" 一种错误的实现")],-1),n("p",null,"首先我们常用的数字签名可否用作VRF呢?",-1),n("h3",{id:"椭圆曲线签名算法原理"},[n("a",{class:"header-anchor",href:"#椭圆曲线签名算法原理","aria-hidden":"true"},"#"),l(" 椭圆曲线签名算法原理")],-1),n("p",null,[l("假设私钥为k,那么公钥"),n("span",{class:"katex"},[n("span",{class:"katex-mathml"},[n("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[n("semantics",null,[n("mrow",null,[n("mi",null,"K"),n("mo",null,"="),n("mi",null,"k"),n("mi",null,"G")]),n("annotation",{encoding:"application/x-tex"},"K=kG")])])]),n("span",{class:"katex-html","aria-hidden":"true"},[n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.68333em","vertical-align":"0em"}}),n("span",{class:"mord mathnormal",style:{"margin-right":"0.07153em"}},"K"),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),n("span",{class:"mrel"},"="),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.69444em","vertical-align":"0em"}}),n("span",{class:"mord mathnormal",style:{"margin-right":"0.03148em"}},"k"),n("span",{class:"mord mathnormal"},"G")])])]),l(",其中G为G点(就是椭圆曲线的公共参数,可以忽略). 签名的过程如下:")],-1),n("ol",null,[n("li",null,[l("选择随机数r,计算"),n("span",{class:"katex"},[n("span",{class:"katex-mathml"},[n("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[n("semantics",null,[n("mrow",null,[n("mi",null,"P"),n("mo",null,"="),n("mi",null,"r"),n("mi",null,"G")]),n("annotation",{encoding:"application/x-tex"},"P=rG")])])]),n("span",{class:"katex-html","aria-hidden":"true"},[n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.68333em","vertical-align":"0em"}}),n("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"P"),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),n("span",{class:"mrel"},"="),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.68333em","vertical-align":"0em"}}),n("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"r"),n("span",{class:"mord mathnormal"},"G")])])]),l(",P实际上就是曲线上的一个点")]),n("li",null,[l("计算"),n("span",{class:"katex"},[n("span",{class:"katex-mathml"},[n("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[n("semantics",null,[n("mrow",null,[n("mi",null,"s"),n("mo",null,"="),n("mfrac",null,[n("mrow",null,[n("mi",null,"m"),n("mo",null,"+"),n("mi",null,"k"),n("mi",null,"x")]),n("mi",null,"r")])]),n("annotation",{encoding:"application/x-tex"},"s=\\frac {m+kx} r")])])]),n("span",{class:"katex-html","aria-hidden":"true"},[n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.43056em","vertical-align":"0em"}}),n("span",{class:"mord mathnormal"},"s"),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),n("span",{class:"mrel"},"="),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"1.2251079999999999em","vertical-align":"-0.345em"}}),n("span",{class:"mord"},[n("span",{class:"mopen nulldelimiter"}),n("span",{class:"mfrac"},[n("span",{class:"vlist-t vlist-t2"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.8801079999999999em"}},[n("span",{style:{top:"-2.6550000000000002em"}},[n("span",{class:"pstrut",style:{height:"3em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mtight"},[n("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])]),n("span",{style:{top:"-3.23em"}},[n("span",{class:"pstrut",style:{height:"3em"}}),n("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),n("span",{style:{top:"-3.394em"}},[n("span",{class:"pstrut",style:{height:"3em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mtight"},[n("span",{class:"mord mathnormal mtight"},"m"),n("span",{class:"mbin mtight"},"+"),n("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k"),n("span",{class:"mord mathnormal mtight"},"x")])])])]),n("span",{class:"vlist-s"},"​")]),n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.345em"}},[n("span")])])])]),n("span",{class:"mclose nulldelimiter"})])])])]),l(",其中m就是公共信息,比如是一个以太坊交易的Hash值. 这里的x是P的x坐标.")]),n("li",null,"将消息m和签名{rG,s}发送给接收方 接收方在事先知道公钥K的情况下,就很容易验证签名和m是否是对应关系. 验证签名的过程: 计算$\\frac {mG} s + \\frac {xK} s $,然后与rG比较,如果相等说明是对应关系.其中x是rG这个点的x坐标")],-1),n("p",null,"为什么这样可以呢,来看一下简单的推导过程:",-1),l(" \\begin{eqnarray} & \\frac {mG} s + \\frac {xK} s \\\\ =& \\frac {mG} s + \\frac {x(kG)} s \\\\ =& \\frac {(m+xk)G} s \\\\ =& \\frac {r(m+xk)G} {m+kx} \\\\ =& rG \\end{eqnarray} "),n("p",null,[n("strong",null,[l("注意: "),n("span",{class:"katex"},[n("span",{class:"katex-mathml"},[n("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[n("semantics",null,[n("mrow",null,[n("mi",null,"s"),n("mo",null,"="),n("mfrac",null,[n("mrow",null,[n("mi",null,"m"),n("mo",null,"+"),n("mi",null,"k"),n("mi",null,"x")]),n("mi",null,"r")])]),n("annotation",{encoding:"application/x-tex"},"s=\\frac {m+kx} r")])])]),n("span",{class:"katex-html","aria-hidden":"true"},[n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.43056em","vertical-align":"0em"}}),n("span",{class:"mord mathnormal"},"s"),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),n("span",{class:"mrel"},"="),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"1.2251079999999999em","vertical-align":"-0.345em"}}),n("span",{class:"mord"},[n("span",{class:"mopen nulldelimiter"}),n("span",{class:"mfrac"},[n("span",{class:"vlist-t vlist-t2"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.8801079999999999em"}},[n("span",{style:{top:"-2.6550000000000002em"}},[n("span",{class:"pstrut",style:{height:"3em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mtight"},[n("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])]),n("span",{style:{top:"-3.23em"}},[n("span",{class:"pstrut",style:{height:"3em"}}),n("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),n("span",{style:{top:"-3.394em"}},[n("span",{class:"pstrut",style:{height:"3em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mtight"},[n("span",{class:"mord mathnormal mtight"},"m"),n("span",{class:"mbin mtight"},"+"),n("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k"),n("span",{class:"mord mathnormal mtight"},"x")])])])]),n("span",{class:"vlist-s"},"​")]),n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.345em"}},[n("span")])])])]),n("span",{class:"mclose nulldelimiter"})])])])])])],-1),n("h4",{id:"那么椭圆曲线的签名可否当做vrf呢"},[n("a",{class:"header-anchor",href:"#那么椭圆曲线的签名可否当做vrf呢","aria-hidden":"true"},"#"),l(" 那么椭圆曲线的签名可否当做VRF呢?")],-1),n("p",null,[l("首先第一点,固定m以后,如果其他人不知道签名人对应的私钥是什么,那么他们确实不知道产生的随机数会是什么样子. 同时验证人如果知道私钥对应的公钥,也很容易确定私钥是否是对m签的名. 所以看起来签名是可以用作VRF的. 但是问题出在签名过程中的随机数r,因为r是随机的,所以每次签名的结果{rG,s}完全是随机的,那么这就给随机数生成方选择随机数的机会. 也就是说一开始定义的"),n("span",{class:"katex"},[n("span",{class:"katex-mathml"},[n("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[n("semantics",null,[n("mrow",null,[n("mi",null,"y"),n("mo",null,"="),n("mi",null,"F"),n("mi",null,"S"),n("mi",null,"K"),n("mo",{stretchy:"false"},"("),n("mi",null,"x"),n("mo",{stretchy:"false"},")")]),n("annotation",{encoding:"application/x-tex"},"y=FSK(x)")])])]),n("span",{class:"katex-html","aria-hidden":"true"},[n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.625em","vertical-align":"-0.19444em"}}),n("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"y"),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),n("span",{class:"mrel"},"="),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),n("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"FS"),n("span",{class:"mord mathnormal",style:{"margin-right":"0.07153em"}},"K"),n("span",{class:"mopen"},"("),n("span",{class:"mord mathnormal"},"x"),n("span",{class:"mclose"},")")])])]),l(",这里的x到y的映射是不固定的,这不符合函数的定义.")],-1),t('',10),n("p",null,[n("span",{class:"katex-display"},[n("span",{class:"katex"},[n("span",{class:"katex-mathml"},[n("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[n("semantics",null,[n("mrow",null,[n("mi",null,"h"),n("mo",null,"="),n("msub",null,[n("mi",null,"H"),n("mn",null,"1")]),n("mo",{stretchy:"false"},"("),n("mi",null,"m"),n("mo",{stretchy:"false"},")"),n("mspace",{linebreak:"newline"}),n("mi",null,"v"),n("mo",null,"="),n("mi",null,"V"),n("mi",null,"R"),n("msub",null,[n("mi",null,"F"),n("mi",null,"k")]),n("mo",{stretchy:"false"},"("),n("mi",null,"m"),n("mo",{stretchy:"false"},")"),n("mo",null,"="),n("msup",null,[n("mi",null,"h"),n("mi",null,"k")])]),n("annotation",{encoding:"application/x-tex"},"h=H_1(m) \\\\ v=VRF_k(m)=h^k ")])])]),n("span",{class:"katex-html","aria-hidden":"true"},[n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.69444em","vertical-align":"0em"}}),n("span",{class:"mord mathnormal"},"h"),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),n("span",{class:"mrel"},"="),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),n("span",{class:"mord"},[n("span",{class:"mord mathnormal",style:{"margin-right":"0.08125em"}},"H"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t vlist-t2"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.30110799999999993em"}},[n("span",{style:{top:"-2.5500000000000003em","margin-left":"-0.08125em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mtight"},"1")])])]),n("span",{class:"vlist-s"},"​")]),n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.15em"}},[n("span")])])])])]),n("span",{class:"mopen"},"("),n("span",{class:"mord mathnormal"},"m"),n("span",{class:"mclose"},")")]),n("span",{class:"mspace newline"}),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.43056em","vertical-align":"0em"}}),n("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"v"),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),n("span",{class:"mrel"},"="),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),n("span",{class:"mord mathnormal",style:{"margin-right":"0.22222em"}},"V"),n("span",{class:"mord mathnormal",style:{"margin-right":"0.00773em"}},"R"),n("span",{class:"mord"},[n("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"F"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t vlist-t2"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.33610799999999996em"}},[n("span",{style:{top:"-2.5500000000000003em","margin-left":"-0.13889em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k")])])]),n("span",{class:"vlist-s"},"​")]),n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.15em"}},[n("span")])])])])]),n("span",{class:"mopen"},"("),n("span",{class:"mord mathnormal"},"m"),n("span",{class:"mclose"},")"),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),n("span",{class:"mrel"},"="),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.8991079999999999em","vertical-align":"0em"}}),n("span",{class:"mord"},[n("span",{class:"mord mathnormal"},"h"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.8991079999999999em"}},[n("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k")])])])])])])])])])])])],-1),n("p",null,[l("这里的v是完全确定的,就是"),n("span",{class:"katex"},[n("span",{class:"katex-mathml"},[n("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[n("semantics",null,[n("mrow",null,[n("msup",null,[n("mi",null,"h"),n("mi",null,"k")])]),n("annotation",{encoding:"application/x-tex"},"h^k")])])]),n("span",{class:"katex-html","aria-hidden":"true"},[n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.849108em","vertical-align":"0em"}}),n("span",{class:"mord"},[n("span",{class:"mord mathnormal"},"h"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.849108em"}},[n("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k")])])])])])])])])])]),l(",满足了函数的确定性,但是怎么可验证呢?")],-1),n("h4",{id:"随机数的proof"},[n("a",{class:"header-anchor",href:"#随机数的proof","aria-hidden":"true"},"#"),l(" 随机数的proof")],-1),n("p",null,"随机生成一个r,然后计算:",-1),n("p",null,[n("span",{class:"katex-display"},[n("span",{class:"katex"},[n("span",{class:"katex-mathml"},[n("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[n("semantics",null,[n("mrow",null,[n("mi",null,"s"),n("mo",null,"="),n("msub",null,[n("mi",null,"H"),n("mn",null,"2")]),n("mo",{stretchy:"false"},"("),n("mi",null,"g"),n("mo",{separator:"true"},","),n("mi",null,"h"),n("mo",{separator:"true"},","),n("mi",null,"G"),n("mo",{separator:"true"},","),n("mi",null,"v"),n("mo",{separator:"true"},","),n("msup",null,[n("mi",null,"g"),n("mi",null,"r")]),n("mo",{separator:"true"},","),n("msup",null,[n("mi",null,"h"),n("mi",null,"r")]),n("mo",{stretchy:"false"},")"),n("mspace",{linebreak:"newline"}),n("mi",null,"t"),n("mo",null,"="),n("mi",null,"r"),n("mo",null,"−"),n("mi",null,"s"),n("mi",null,"k"),n("mo",{stretchy:"false"},"("),n("mi",null,"m"),n("mi",null,"o"),n("mi",null,"d"),n("mi",null,"p"),n("mo",{stretchy:"false"},")")]),n("annotation",{encoding:"application/x-tex"},"s=H_2(g,h,G,v,g^r,h^r) \\\\ t=r-sk (mod p) ")])])]),n("span",{class:"katex-html","aria-hidden":"true"},[n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.43056em","vertical-align":"0em"}}),n("span",{class:"mord mathnormal"},"s"),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),n("span",{class:"mrel"},"="),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),n("span",{class:"mord"},[n("span",{class:"mord mathnormal",style:{"margin-right":"0.08125em"}},"H"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t vlist-t2"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.30110799999999993em"}},[n("span",{style:{top:"-2.5500000000000003em","margin-left":"-0.08125em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mtight"},"2")])])]),n("span",{class:"vlist-s"},"​")]),n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.15em"}},[n("span")])])])])]),n("span",{class:"mopen"},"("),n("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),n("span",{class:"mpunct"},","),n("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),n("span",{class:"mord mathnormal"},"h"),n("span",{class:"mpunct"},","),n("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),n("span",{class:"mord mathnormal"},"G"),n("span",{class:"mpunct"},","),n("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),n("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"v"),n("span",{class:"mpunct"},","),n("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),n("span",{class:"mord"},[n("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.7143919999999999em"}},[n("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])])])])])]),n("span",{class:"mpunct"},","),n("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),n("span",{class:"mord"},[n("span",{class:"mord mathnormal"},"h"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.7143919999999999em"}},[n("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])])])])])]),n("span",{class:"mclose"},")")]),n("span",{class:"mspace newline"}),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.61508em","vertical-align":"0em"}}),n("span",{class:"mord mathnormal"},"t"),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),n("span",{class:"mrel"},"="),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.66666em","vertical-align":"-0.08333em"}}),n("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"r"),n("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),n("span",{class:"mbin"},"−"),n("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),n("span",{class:"mord mathnormal"},"s"),n("span",{class:"mord mathnormal",style:{"margin-right":"0.03148em"}},"k"),n("span",{class:"mopen"},"("),n("span",{class:"mord mathnormal"},"m"),n("span",{class:"mord mathnormal"},"o"),n("span",{class:"mord mathnormal"},"d"),n("span",{class:"mord mathnormal"},"p"),n("span",{class:"mclose"},")")])])])])],-1),t('',4),n("h4",{id:"生成"},[n("a",{class:"header-anchor",href:"#生成","aria-hidden":"true"},"#"),l(" 生成"),n("span",{class:"katex"},[n("span",{class:"katex-mathml"},[n("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[n("semantics",null,[n("mrow",null,[n("msup",null,[n("mi",null,"g"),n("mi",null,"r")])]),n("annotation",{encoding:"application/x-tex"},"g^r")])])]),n("span",{class:"katex-html","aria-hidden":"true"},[n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.858832em","vertical-align":"-0.19444em"}}),n("span",{class:"mord"},[n("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.664392em"}},[n("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])])])])])])])])]),l(" , "),n("span",{class:"katex"},[n("span",{class:"katex-mathml"},[n("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[n("semantics",null,[n("mrow",null,[n("msup",null,[n("mi",null,"h"),n("mi",null,"r")])]),n("annotation",{encoding:"application/x-tex"},"h^r")])])]),n("span",{class:"katex-html","aria-hidden":"true"},[n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.69444em","vertical-align":"0em"}}),n("span",{class:"mord"},[n("span",{class:"mord mathnormal"},"h"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.664392em"}},[n("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])])])])])])])])])],-1),n("p",null,[n("span",{class:"katex-display"},[n("span",{class:"katex"},[n("span",{class:"katex-mathml"},[n("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[n("semantics",null,[n("mrow",null,[n("msup",null,[n("mi",null,"g"),n("mi",null,"r")]),n("mo",null,"="),n("msup",null,[n("mi",null,"g"),n("mrow",null,[n("mi",null,"t"),n("mo",null,"+"),n("mi",null,"k"),n("mi",null,"s")])]),n("mo",null,"="),n("msup",null,[n("mi",null,"g"),n("mi",null,"t")]),n("mo",null,"⋅"),n("msup",null,[n("mi",null,"g"),n("mrow",null,[n("mi",null,"k"),n("mi",null,"s")])]),n("mo",null,"="),n("msup",null,[n("mi",null,"g"),n("mi",null,"t")]),n("mo",null,"⋅"),n("msup",null,[n("msup",null,[n("mi",null,"g"),n("mi",null,"k")]),n("mi",null,"s")]),n("mo",null,"="),n("msup",null,[n("mi",null,"g"),n("mi",null,"t")]),n("mo",null,"⋅"),n("msup",null,[n("mi",null,"G"),n("mi",null,"s")])]),n("annotation",{encoding:"application/x-tex"},"g^r =g^{t+ks} =g^t \\cdot g^{ks} =g^t \\cdot {g^k}^s =g^t \\cdot G^s ")])])]),n("span",{class:"katex-html","aria-hidden":"true"},[n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.9088319999999999em","vertical-align":"-0.19444em"}}),n("span",{class:"mord"},[n("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.7143919999999999em"}},[n("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])])])])])]),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),n("span",{class:"mrel"},"="),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"1.093548em","vertical-align":"-0.19444em"}}),n("span",{class:"mord"},[n("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.8991079999999999em"}},[n("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mtight"},[n("span",{class:"mord mathnormal mtight"},"t"),n("span",{class:"mbin mtight"},"+"),n("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k"),n("span",{class:"mord mathnormal mtight"},"s")])])])])])])])]),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),n("span",{class:"mrel"},"="),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"1.037996em","vertical-align":"-0.19444em"}}),n("span",{class:"mord"},[n("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.843556em"}},[n("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mathnormal mtight"},"t")])])])])])])]),n("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),n("span",{class:"mbin"},"⋅"),n("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"1.093548em","vertical-align":"-0.19444em"}}),n("span",{class:"mord"},[n("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.8991079999999999em"}},[n("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mtight"},[n("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k"),n("span",{class:"mord mathnormal mtight"},"s")])])])])])])])]),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),n("span",{class:"mrel"},"="),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"1.037996em","vertical-align":"-0.19444em"}}),n("span",{class:"mord"},[n("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.843556em"}},[n("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mathnormal mtight"},"t")])])])])])])]),n("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),n("span",{class:"mbin"},"⋅"),n("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"1.14784em","vertical-align":"-0.19444em"}}),n("span",{class:"mord"},[n("span",{class:"mord"},[n("span",{class:"mord"},[n("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.8991079999999999em"}},[n("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k")])])])])])])])]),n("span",{class:"msupsub"},[n("span",{class:"vlist-t"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.9533999999999999em"}},[n("span",{style:{top:"-3.352008em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mathnormal mtight"},"s")])])])])])])]),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),n("span",{class:"mrel"},"="),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"1.037996em","vertical-align":"-0.19444em"}}),n("span",{class:"mord"},[n("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.843556em"}},[n("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mathnormal mtight"},"t")])])])])])])]),n("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),n("span",{class:"mbin"},"⋅"),n("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.7143919999999999em","vertical-align":"0em"}}),n("span",{class:"mord"},[n("span",{class:"mord mathnormal"},"G"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.7143919999999999em"}},[n("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mathnormal mtight"},"s")])])])])])])])])])])])],-1),n("p",null,[n("span",{class:"katex-display"},[n("span",{class:"katex"},[n("span",{class:"katex-mathml"},[n("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[n("semantics",null,[n("mrow",null,[n("msup",null,[n("mi",null,"h"),n("mi",null,"r")]),n("mo",null,"="),n("msup",null,[n("mi",null,"h"),n("mrow",null,[n("mi",null,"t"),n("mo",null,"+"),n("mi",null,"k"),n("mi",null,"s")])]),n("mo",null,"="),n("msup",null,[n("mi",null,"h"),n("mi",null,"t")]),n("mo",null,"⋅"),n("msup",null,[n("mi",null,"h"),n("mrow",null,[n("mi",null,"k"),n("mi",null,"s")])]),n("mo",null,"="),n("msup",null,[n("mi",null,"h"),n("mi",null,"t")]),n("mo",null,"⋅"),n("msup",null,[n("msup",null,[n("mi",null,"h"),n("mi",null,"k")]),n("mi",null,"s")]),n("mo",null,"="),n("msup",null,[n("mi",null,"h"),n("mi",null,"t")]),n("mo",null,"⋅"),n("msup",null,[n("mi",null,"v"),n("mi",null,"s")])]),n("annotation",{encoding:"application/x-tex"},"h^r =h^{t+ks} =h^t \\cdot h^{ks} =h^t \\cdot {h^k}^s =h^t \\cdot v^s ")])])]),n("span",{class:"katex-html","aria-hidden":"true"},[n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.7143919999999999em","vertical-align":"0em"}}),n("span",{class:"mord"},[n("span",{class:"mord mathnormal"},"h"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.7143919999999999em"}},[n("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])])])])])]),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),n("span",{class:"mrel"},"="),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.8991079999999999em","vertical-align":"0em"}}),n("span",{class:"mord"},[n("span",{class:"mord mathnormal"},"h"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.8991079999999999em"}},[n("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mtight"},[n("span",{class:"mord mathnormal mtight"},"t"),n("span",{class:"mbin mtight"},"+"),n("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k"),n("span",{class:"mord mathnormal mtight"},"s")])])])])])])])]),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),n("span",{class:"mrel"},"="),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.843556em","vertical-align":"0em"}}),n("span",{class:"mord"},[n("span",{class:"mord mathnormal"},"h"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.843556em"}},[n("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mathnormal mtight"},"t")])])])])])])]),n("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),n("span",{class:"mbin"},"⋅"),n("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.8991079999999999em","vertical-align":"0em"}}),n("span",{class:"mord"},[n("span",{class:"mord mathnormal"},"h"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.8991079999999999em"}},[n("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mtight"},[n("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k"),n("span",{class:"mord mathnormal mtight"},"s")])])])])])])])]),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),n("span",{class:"mrel"},"="),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.843556em","vertical-align":"0em"}}),n("span",{class:"mord"},[n("span",{class:"mord mathnormal"},"h"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.843556em"}},[n("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mathnormal mtight"},"t")])])])])])])]),n("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),n("span",{class:"mbin"},"⋅"),n("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.9533999999999999em","vertical-align":"0em"}}),n("span",{class:"mord"},[n("span",{class:"mord"},[n("span",{class:"mord"},[n("span",{class:"mord mathnormal"},"h"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.8991079999999999em"}},[n("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k")])])])])])])])]),n("span",{class:"msupsub"},[n("span",{class:"vlist-t"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.9533999999999999em"}},[n("span",{style:{top:"-3.352008em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mathnormal mtight"},"s")])])])])])])]),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),n("span",{class:"mrel"},"="),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.843556em","vertical-align":"0em"}}),n("span",{class:"mord"},[n("span",{class:"mord mathnormal"},"h"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.843556em"}},[n("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mathnormal mtight"},"t")])])])])])])]),n("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),n("span",{class:"mbin"},"⋅"),n("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.7143919999999999em","vertical-align":"0em"}}),n("span",{class:"mord"},[n("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"v"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.7143919999999999em"}},[n("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mathnormal mtight"},"s")])])])])])])])])])])])],-1),n("p",null,[l("虽然验证人不知道k,也不知道r,但是知道h,g,G,v,s,t所以他可以计算出"),n("span",{class:"katex"},[n("span",{class:"katex-mathml"},[n("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[n("semantics",null,[n("mrow",null,[n("mi",null,"s"),n("mn",null,"2"),n("mo",null,"="),n("msub",null,[n("mi",null,"H"),n("mn",null,"2")]),n("mo",{stretchy:"false"},"("),n("mi",null,"g"),n("mo",{separator:"true"},","),n("mi",null,"h"),n("mo",{separator:"true"},","),n("mi",null,"G"),n("mo",{separator:"true"},","),n("mi",null,"v"),n("mo",{separator:"true"},","),n("msup",null,[n("mi",null,"g"),n("mi",null,"t")]),n("mo",null,"⋅"),n("msup",null,[n("mi",null,"G"),n("mi",null,"s")]),n("mo",{separator:"true"},","),n("msup",null,[n("mi",null,"h"),n("mi",null,"t")]),n("mo",null,"⋅"),n("msup",null,[n("mi",null,"v"),n("mi",null,"s")]),n("mo",{stretchy:"false"},")")]),n("annotation",{encoding:"application/x-tex"},"s2=H_2(g , h ,G , v , g^t \\cdot G^s , h^t \\cdot v^s)")])])]),n("span",{class:"katex-html","aria-hidden":"true"},[n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.64444em","vertical-align":"0em"}}),n("span",{class:"mord mathnormal"},"s"),n("span",{class:"mord"},"2"),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}}),n("span",{class:"mrel"},"="),n("span",{class:"mspace",style:{"margin-right":"0.2777777777777778em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"1.043556em","vertical-align":"-0.25em"}}),n("span",{class:"mord"},[n("span",{class:"mord mathnormal",style:{"margin-right":"0.08125em"}},"H"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t vlist-t2"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.30110799999999993em"}},[n("span",{style:{top:"-2.5500000000000003em","margin-left":"-0.08125em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mtight"},"2")])])]),n("span",{class:"vlist-s"},"​")]),n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.15em"}},[n("span")])])])])]),n("span",{class:"mopen"},"("),n("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),n("span",{class:"mpunct"},","),n("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),n("span",{class:"mord mathnormal"},"h"),n("span",{class:"mpunct"},","),n("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),n("span",{class:"mord mathnormal"},"G"),n("span",{class:"mpunct"},","),n("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),n("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"v"),n("span",{class:"mpunct"},","),n("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),n("span",{class:"mord"},[n("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.7935559999999999em"}},[n("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mathnormal mtight"},"t")])])])])])])]),n("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),n("span",{class:"mbin"},"⋅"),n("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.9879959999999999em","vertical-align":"-0.19444em"}}),n("span",{class:"mord"},[n("span",{class:"mord mathnormal"},"G"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.664392em"}},[n("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mathnormal mtight"},"s")])])])])])])]),n("span",{class:"mpunct"},","),n("span",{class:"mspace",style:{"margin-right":"0.16666666666666666em"}}),n("span",{class:"mord"},[n("span",{class:"mord mathnormal"},"h"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.7935559999999999em"}},[n("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mathnormal mtight"},"t")])])])])])])]),n("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}}),n("span",{class:"mbin"},"⋅"),n("span",{class:"mspace",style:{"margin-right":"0.2222222222222222em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),n("span",{class:"mord"},[n("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"v"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.664392em"}},[n("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mathnormal mtight"},"s")])])])])])])]),n("span",{class:"mclose"},")")])])]),l(" . 然后验证s2是否和s相等,如果相等,那就是k持有人按照规则计算出的随机数")],-1),t('',13)];m.render=function(n,l,t,e,m,i){return s(),a("div",null,p)};export{e as __pageData,m as default};
