<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Rust无锁编程 | Steven's Blog</title>
    <meta name="description" content="steven's Blog">
    <link rel="preload stylesheet" href="/assets/style.c1edef64.css" as="style">
    <script type="module" src="/assets/app.d4f5148f.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.2ed14f66.woff2" as="font" type="font/woff2" crossorigin="">
  <link rel="modulepreload" href="/assets/chunks/framework.3a9190c5.js">
  <link rel="modulepreload" href="/assets/chunks/theme.ee689be4.js">
  <link rel="modulepreload" href="/assets/chunks/viewer.a15bc08d.js">
  <link rel="modulepreload" href="/assets/chunks/echarts.a422ede2.js">
  <link rel="modulepreload" href="/assets/chunks/flowchart.3da280a8.js">
  <link rel="modulepreload" href="/assets/chunks/mermaid.673c3589.js">
  <link rel="modulepreload" href="/assets/chunks/runner.e522a28f.js">
  <link rel="modulepreload" href="/assets/rust_lock-freedom-without-garbage-collection.md.420ed5ea.lean.js">
  <link rel="icon" href="/logo.png">
  <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-b2cf3e0b><!--[--><!--]--><!--[--><span tabindex="-1" data-v-c8616af1></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-c8616af1> Skip to content </a><!--]--><!----><header class="VPNav" data-v-b2cf3e0b data-v-7e5bc4a5><div class="VPNavBar has-sidebar" data-v-7e5bc4a5 data-v-1d30fa41><div class="container" data-v-1d30fa41><div class="title" data-v-1d30fa41><div class="VPNavBarTitle has-sidebar" data-v-1d30fa41 data-v-f4ef19a3><a class="title" href="/" data-v-f4ef19a3><!--[--><!--]--><!--[--><img class="VPImage logo" src="/logo.png" alt data-v-6db2186b><!--]--><!--[-->Steven&#39;s Blog<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-1d30fa41><div class="curtain" data-v-1d30fa41></div><div class="content-body" data-v-1d30fa41><!--[--><!--]--><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-1d30fa41 data-v-7f418b0f><span id="main-nav-aria-label" class="visually-hidden" data-v-7f418b0f>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/web-security/" tabindex="0" data-v-7f418b0f data-v-37adc828 data-v-8f4dc553><!--[-->web安全相关<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/blockchain/" tabindex="0" data-v-7f418b0f data-v-37adc828 data-v-8f4dc553><!--[-->block chain<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/static_analysis/" tabindex="0" data-v-7f418b0f data-v-37adc828 data-v-8f4dc553><!--[-->静态分析<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/app_security/" tabindex="0" data-v-7f418b0f data-v-37adc828 data-v-8f4dc553><!--[-->泛app安全<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/rust-leetcode/" tabindex="0" data-v-7f418b0f data-v-37adc828 data-v-8f4dc553><!--[-->leetcode<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/rust/" tabindex="0" data-v-7f418b0f data-v-37adc828 data-v-8f4dc553><!--[-->rust<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/other/" tabindex="0" data-v-7f418b0f data-v-37adc828 data-v-8f4dc553><!--[-->other<!--]--><!----></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-1d30fa41 data-v-f6a63727><label title="toggle dark mode" data-v-f6a63727 data-v-a9c8afb8><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-checked="false" data-v-a9c8afb8 data-v-f3c41672><span class="check" data-v-f3c41672><span class="icon" data-v-f3c41672><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-a9c8afb8><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-a9c8afb8><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></label></div><!----><div class="VPFlyout VPNavBarExtra extra" ref_key="el" data-v-1d30fa41 data-v-40855f84 data-v-764effdf><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-764effdf><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-764effdf><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-764effdf><div class="VPMenu" data-v-764effdf data-v-e7ea1737><!----><!--[--><!--[--><!----><div class="group" data-v-40855f84><div class="item appearance" data-v-40855f84><p class="label" data-v-40855f84>Appearance</p><div class="appearance-action" data-v-40855f84><label title="toggle dark mode" data-v-40855f84 data-v-a9c8afb8><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-checked="false" data-v-a9c8afb8 data-v-f3c41672><span class="check" data-v-f3c41672><span class="icon" data-v-f3c41672><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-a9c8afb8><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-a9c8afb8><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></label></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-1d30fa41 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav" data-v-b2cf3e0b data-v-f5a2ca58><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-f5a2ca58><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-f5a2ca58><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-f5a2ca58>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-f5a2ca58 data-v-079b16a8><button data-v-079b16a8>Return to top</button><!----></div></div><aside class="VPSidebar" ref_key="navEl" data-v-b2cf3e0b data-v-139a1f1d><div class="curtain" data-v-139a1f1d></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-139a1f1d><span class="visually-hidden" id="sidebar-aria-label" data-v-139a1f1d> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-139a1f1d><section class="VPSidebarItem level-0 has-active" data-v-139a1f1d data-v-c4656e6d><!----><div class="items" data-v-c4656e6d><!--[--><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/rust/rust_global_function_pointer.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>rust中函数指针作为全局变量使用</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/rust/rust_atomic.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>我对rust atomic的理解</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/rust/rust_async_lock.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>Rust异步编程中我们应该用那种锁?</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/rust/convert_an_integer_to_an_enum.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>Rust中enum和整数的互相转换</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/rust/Futures_Explained_in_200_lines_of_Rust2.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>200行代码讲透Rust Futures的问题</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/rust/build_your_own_executor.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>从头实现Rust异步执行器</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/rust/build_your_own_block_on.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>从头实现Rust异步block_on</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/rust/Futures_Explained_in_200_lines_of_Rust.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>200行代码讲透Rust Futures</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/rust/Futures_Explained_in_200_lines_of_Rust_with_error_version.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>200行代码讲透Rust Futures-有bug版本</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link is-active has-active" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/rust/lock-freedom-without-garbage-collection.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>Rust无锁编程</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/rust/rust开发工具.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>rust开发工具 clion</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/rust/tokio_async_await 初探.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>tokio async&await 初探</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/rust/交叉编译rust.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>在ubuntu 18.04上交叉编译rust 程序</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/rust/tokio笔记.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>tokio笔记.md</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/rust/ownership101.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>Ownership 101</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/rust/my_note.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>rust学习笔记</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/rust/rnats/" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>从零实现消息中间件</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-b2cf3e0b data-v-a494bd1d><div class="VPDoc has-sidebar has-aside" data-v-a494bd1d data-v-c4b0d3cf><!--[--><!--]--><div class="container" data-v-c4b0d3cf><div class="aside" data-v-c4b0d3cf><div class="aside-curtain" data-v-c4b0d3cf></div><div class="aside-container" data-v-c4b0d3cf><div class="aside-content" data-v-c4b0d3cf><div class="VPDocAside" data-v-c4b0d3cf data-v-3f215769><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" ref_key="container" data-v-3f215769 data-v-ff0f39c8><div class="content" data-v-ff0f39c8><div class="outline-marker" data-v-ff0f39c8></div><div class="outline-title" data-v-ff0f39c8>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-ff0f39c8><span class="visually-hidden" id="doc-outline-aria-label" data-v-ff0f39c8> Table of Contents for current page </span><ul class="root" data-v-ff0f39c8 data-v-8f12e865><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-c4b0d3cf><div class="content-container" data-v-c4b0d3cf><!--[--><!--]--><!----><main class="main" data-v-c4b0d3cf><div style="position:relative;" class="vp-doc _rust_lock-freedom-without-garbage-collection" data-v-c4b0d3cf><div><ul><li><a href="#benchmarks">Benchmarks</a><ul><li><a href="#分析">分析</a></li></ul></li><li><a href="#无锁数据结构">无锁数据结构</a><ul><li><a href="#特雷伯栈">特雷伯栈</a></li><li><a href="#the-problem">The problem</a></li></ul></li><li><a href="#基于epoch的内存回收">基于epoch的内存回收</a></li><li><a href="#the-rust-api">The Rust API</a><ul><li><a href="#guard">Guard</a></li><li><a href="#owned-and-shared-pointers">Owned and Shared pointers</a><ul><li><a href="#owned">Owned</a></li><li><a href="#shared">Shared</a></li></ul></li><li><a href="#atomic">Atomic</a><ul><li><a href="#loading">Loading</a></li><li><a href="#store">store</a></li><li><a href="#cas">CAS</a></li><li><a href="#释放内存">释放内存</a></li><li><a href="#基于epoch的特雷贝尔栈">基于epoch的特雷贝尔栈</a></li><li><a href="#管理垃圾">管理垃圾</a></li></ul></li></ul></li><li><a href="#展望">展望</a></li><li><a href="#我的一些心得">我的一些心得</a></li></ul><p>本文内容译自<a href="http://aturon.github.io/tech/2015/08/27/epoch/" target="_blank" rel="noreferrer">Lock-freedom without garbage collection</a>,中间有少量自己的修改.</p><p>人们普遍认为，垃圾收集的一个优点是易于构建高性能的无锁数据结构。 对这些数据结构进行手动内存管理并不容易，而 GC 使其变得非常简单。 这篇文章表明，使用 Rust，可以为并发数据结构构建一个内存管理 API:</p><ul><li>使得实现无锁数据结构和 有GC的语言(如Java) 一样容易;</li><li>静态保护以防止内存管理方案的滥用;</li><li>具有与 GC 竞争的开销(并且比 GC 更可预测) 在下面展示的基准测试中，Rust 能够轻松地击败 Java 无锁队列实现，并且具有易于编写的实现。</li></ul><p>我已经在<a href="https://github.com/aturon/crossbeam" target="_blank" rel="noreferrer">Crossbeam</a> 这个crate中实现了“基于epoch的内存回收” ，这个crate现在就可以用于您自己的数据结构。 本文介绍了一些关于无锁数据结构的背景知识、 epoch 算法以及完整的Rust API。</p><h2 id="benchmarks" tabindex="-1">Benchmarks <a class="header-anchor" href="#benchmarks" aria-label="Permalink to &quot;Benchmarks&quot;">​</a></h2><p>在深入研究基于epoch的内存回收的API设计和使用之前，让我们直奔主题: 性能。</p><p>为了测试 Crossbeam 实现相对于完整 GC(有完整GC的语言,比如java) 的开销，我在它上面实现了一个基本的无锁队列(<a href="http://www.cs.rochester.edu/~scott/papers/1996_PODC_queues.pdf" target="_blank" rel="noreferrer">Michael Scott queue</a>) ，并在 Scala 中构建了相同的队列。 一般来说，基于 jvm 的语言是通向无锁数据结构的“良好 GC”路径的一个很好的测试用例。</p><p>除了上述实现,我还比较了:</p><ul><li>基于crossbeam实现的更高效的分段队列(segmented queue),它分配具有多个slot的节点</li><li>使用锁保护的单线程队列</li><li>使用java.util.concurrent实现的ConcurrentLinkedQueue,他是<a href="http://www.cs.rochester.edu/~scott/papers/1996_PODC_queues.pdf" target="_blank" rel="noreferrer">Michael Scott queue</a>一个优化版本.</li></ul><p>我使用了两种方式来测试这些队列:</p><ul><li>MPSC 一个多生产者、单消费者(MPSC)场景，其中两个线程重复发送消息，一个线程接收消息，两者都在一个循环中。</li><li>MPMC 多生产者、多消费者(multi-producer，multi-consumer，MPMC)场景，其中两个线程发送和两个线程接收在一个循环中。</li></ul><p>这样的基准测试对于测量“竞争”(多线程竞争同时进行并发更新)下无锁数据结构的可伸缩性相当典型。 在构建生产队列实现时，应该对许多变体进行基准测试; 这里的目标仅仅是评估内存管理方案的大致开销。</p><p>对于 MPSC 测试，我还将其与 Rust 内置channel中使用的算法进行了比较，该算法针对此场景进行了优化(因此不支持 MPMC)。</p><p>测试的机器是4 Core 2.6 Ghz Intel Core i 7,16gb 内存。 以下是以纳秒为单位给出的结果(越低越好)</p><p><img alt="" data-src="img/bench-mpsc.png" loading="lazy" class="lazy"><img alt="" data-src="img/bench-mpmc.png" loading="lazy" class="lazy"></p><h3 id="分析" tabindex="-1">分析 <a class="header-anchor" href="#分析" aria-label="Permalink to &quot;分析&quot;">​</a></h3><p>主要的收获是，Crossbeam 的实现方式(尚未调整)在所有情况下都具有竞争力。 通过使用更聪明或更专业的队列，可以在 Rust 和 JVM 两方面都做得更好，但这些结果至少表明 epoch 的开销是合理的。</p><p>注意，java / scala 版本在 MPMC 测试中的表现要比在 MPSC 测试中好得多。 为什么？ 答案很简单: 垃圾收集。 在 MPSC 测试中，随着时间的推移，生产者往往会超过消费者，这意味着队列中的数据量会缓慢增长。 这反过来又增加了每次垃圾收集的成本，这涉及到遍历实时数据集。</p><p>相比之下，在 epoch 方案中，管理垃圾的成本是相对固定的: 它与线程的数量成正比，而不是与活动数据的数量成正比。 事实证明，这会带来更好、更一致 / 更可预测的性能。</p><p>最后，我没有在图表中包括的一个比较(因为它会使其他比较相形见绌)是在 Rust 中围绕 deque 使用 Mutex。 对于 MPMC 测试，性能约为3040ns/op，比 Crossbeam 实现慢20倍以上。 这生动地说明了为什么无锁数据结构非常重要——那么让我们开始深入了解它们是什么。</p><h2 id="无锁数据结构" tabindex="-1">无锁数据结构 <a class="header-anchor" href="#无锁数据结构" aria-label="Permalink to &quot;无锁数据结构&quot;">​</a></h2><p>当您希望使用(和变更)来自许多并发线程的数据结构时，需要进行同步。 最简单的解决方案是全局锁定 Rust，将整个数据结构包装在一个 Mutex 中。</p><p>问题是，这种“粗粒度”同步意味着在访问数据结构时，多个线程总是需要协调，即使它们访问的是不相交的数据结构部分。 这还意味着，即使一个线程只是尝试读取，它也必须通过更新锁状态进行写操作——由于锁是一个全局通信点，这些写操作将导致大量缓存失效通信。 即使对于更精细的内容使用了大量的锁，仍然存在其他危险，如<a href="https://en.wikipedia.org/wiki/Deadlock" target="_blank" rel="noreferrer">死锁</a>和<a href="https://en.wikipedia.org/wiki/Priority_inversion" target="_blank" rel="noreferrer">优先转置</a>，并且通常仍然将性能提升有限(you often still leave performance on the table.)</p><p>一个更加激进的替代方案是无锁数据结构，它使用原子操作直接更改数据结构，而不需要进一步同步。 它们通常比基于锁的设计更快、更可伸缩、更健壮。</p><p>在这篇文章中，我不打算给出一个完整的无锁编程教程，但是关键的一点是，如果你没有全局同步，那么很难说你什么时候可以释放内存。 许多已发布的算法基本上假定是垃圾回收器或其他回收内存的方法。 因此，在Rust中实现无锁并发之前，我们需要一个关于内存回收的工具——这就是这篇博客文章的目的所在。</p><h3 id="特雷伯栈" tabindex="-1">特雷伯栈 <a class="header-anchor" href="#特雷伯栈" aria-label="Permalink to &quot;特雷伯栈&quot;">​</a></h3><p>为了让事情更具体，让我们看看无锁数据结构的“ Hello world” : 特雷伯栈(Treiber’s stack)。 栈表示为单链表，所有修改都发生在head这个指针上:</p><div class="language-rust line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">#![</span><span style="color:#A6ACCD;">feature</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">box_raw</span><span style="color:#89DDFF;">)]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">use</span><span style="color:#FFCB6B;"> std</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">ptr</span><span style="color:#89DDFF;">::{</span><span style="color:#A6ACCD;">self</span><span style="color:#89DDFF;">,</span><span style="color:#FFCB6B;"> null_mut</span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#F78C6C;">use</span><span style="color:#FFCB6B;"> std</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">sync</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">atomic</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">AtomicPtr</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">use</span><span style="color:#FFCB6B;"> std</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">sync</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">atomic</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">Ordering</span><span style="color:#89DDFF;">::{</span><span style="color:#FFCB6B;">Relaxed</span><span style="color:#89DDFF;">,</span><span style="color:#FFCB6B;"> Release</span><span style="color:#89DDFF;">,</span><span style="color:#FFCB6B;"> Acquire</span><span style="color:#89DDFF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">struct</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Stack</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    head</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">AtomicPtr</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Node</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;&gt;,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">struct</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Node</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    data</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    next</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#C792EA;">mut</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Node</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">impl</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Stack</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">new</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Stack</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">Stack</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            head</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">AtomicPtr</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">new</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">null_mut</span><span style="color:#89DDFF;">()),</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>最简单的方法就是从pop开始。 要pop，你只需要循环保存栈顶指针head，然后做一个CAS，用next指针替换当前head:</p><p>请注意，如果旧值匹配，则 compare_and_swap 原子性地将AtomicPtr的值从旧值更改为新值。 同时，如果你不熟悉Acquire, Release和Relaxed 这些标签的含义，你可以放心地忽略它们。</p><div class="language-rust line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">impl</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Stack</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">pop</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">self</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Option</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;font-style:italic;">loop</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">            // take a snapshot</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> head </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> self</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">head</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">load</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">Acquire</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">            // we observed the stack empty</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> head </span><span style="color:#89DDFF;">==</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">null_mut</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">None</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> next </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">unsafe</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(*</span><span style="color:#A6ACCD;">head</span><span style="color:#89DDFF;">).</span><span style="color:#A6ACCD;">next </span><span style="color:#89DDFF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">                // if snapshot is still good, update from `head` to `next`</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> self</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">head</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">compare_and_swap</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">head</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> next</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Release</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">==</span><span style="color:#A6ACCD;"> head </span><span style="color:#89DDFF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">                    // extract out the data from the now-unlinked node</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">                    // **NOTE**: leaks the node!</span></span>
<span class="line"><span style="color:#A6ACCD;">                    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Some</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">unsafe</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ptr</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">read</span><span style="color:#89DDFF;">(&amp;(*</span><span style="color:#A6ACCD;">head</span><span style="color:#89DDFF;">).</span><span style="color:#A6ACCD;">data</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">})</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p><code>ptr::read</code> 函数是 Rust 在没有静态或动态跟踪的情况下提取数据所有权的方法。 在这里，我们使用 <code>compare_and_swap</code> 的原子性来保证只有一个线程会调用 <code>ptr::read</code>-正如我们将看到的，这个实现永远不会释放 Nodes，因此数据上的析构函数永远不会被调用。 这两个事实一起使我们使用<code>ptr::read</code>是安全的。</p><p>push 和pop差不多:</p><div class="language-rust line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">impl</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Stack</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">push</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">self</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> t</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">        // allocate the node, and immediately turn it into a *mut pointer</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> n </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Box</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">into_raw</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">Box</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">new</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">Node</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            data</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> t</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">            next</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">null_mut</span><span style="color:#89DDFF;">(),</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}));</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;font-style:italic;">loop</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">            // snapshot current head</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> head </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> self</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">head</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">load</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">Relaxed</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">            // update `next` pointer with snapshot</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#F78C6C;">unsafe</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(*</span><span style="color:#A6ACCD;">n</span><span style="color:#89DDFF;">).</span><span style="color:#A6ACCD;">next </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> head</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">            // if snapshot is still good, link in new node</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> self</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">head</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">compare_and_swap</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">head</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> n</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Release</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">==</span><span style="color:#A6ACCD;"> head </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;font-style:italic;">break</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="the-problem" tabindex="-1">The problem <a class="header-anchor" href="#the-problem" aria-label="Permalink to &quot;The problem&quot;">​</a></h3><p>如果是支持GC的语言编写了上面的代码,那么我们已经实现了一个lock-free stack,但是在rust中不行,因为它发生了内存泄漏.特别是，当Node指针从堆栈中移除后，pop实现不会尝试释放它。</p><p>如果我们加上内存释放会有什么问题呢:</p><div class="language-rust line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// extract out the data from the now-unlinked node</span></span>
<span class="line"><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> ret </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Some</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">unsafe</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ptr</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">read</span><span style="color:#89DDFF;">(&amp;(*</span><span style="color:#A6ACCD;">head</span><span style="color:#89DDFF;">).</span><span style="color:#A6ACCD;">data</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// free the node</span></span>
<span class="line"><span style="color:#FFCB6B;">mem</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">drop</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">Box</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">from_raw</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">head</span><span style="color:#89DDFF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> ret</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>问题是其他线程也可能同时运行 pop。 这些线程可以获得当前head的快照; 没有什么可以阻止它们读取<code>(*head).next</code>。 就在我们释放他们指向的节点之后，快照上的下一个——<strong>一个正在形成的<code>user-after-free</code>bug！</strong> 这就是症结所在。 我们希望使用无锁算法，但是许多算法遵循与上面的栈类似的模式，这使得我们没有明确的点可以安全地释放一个节点。 现在怎么办？</p><p>感觉这里描述的问题并不是很清楚,我加上一个<a href="https://en.wikipedia.org/wiki/ABA_problem" target="_blank" rel="noreferrer">ABA问题</a></p><p>所有没有gc的系统在lock-free编程的是一定要考虑这个问题,具体来说就是假设T1,T2两个线程, 初始stack是a-&gt;b-&gt;c. 这是T1要pop,那么得到a,这时候a.next=b,此时发生了线程调度.然后切换到T2,T2 pop a, pop b,push a 所以stack里面是a-&gt;c. 然后切换到T1,这时候T1看到栈顶地址和自己取到的是一样的(a的地址),然后就把栈顶设置为a.next,也就是b,但是这时候b已经被释放了.</p><p>这是典型的ABAA问题: <img alt="aba问题" data-src="img/aba_problem.jpg" loading="lazy" class="lazy"></p><h2 id="基于epoch的内存回收" tabindex="-1">基于epoch的内存回收 <a class="header-anchor" href="#基于epoch的内存回收" aria-label="Permalink to &quot;基于epoch的内存回收&quot;">​</a></h2><p>对于无锁代码，有几种不是基于 gc 的内存管理方法，但它们都归结为相同的核心特点:</p><ol><li>可达性有两个来源——数据结构和访问它的线程中的快照(引用)。 在删除一个节点之前，我们需要知道它不能以这两种方式中的任何一种方式到达。</li><li>一旦一个节点从数据结构中解除链接，就不会创建到达该节点的新快照(引用)。</li></ol><p>其中一个最优雅和有希望的回收方案是<a href="https://www.cl.cam.ac.uk/techreports/UCAM-CL-TR-579.pdf" target="_blank" rel="noreferrer">Keir Fraser’s epoch-based reclamation</a>，这来自于他的博士论文。</p><p>其基本思想是将未与数据结构链接的节点(可达性的第一个来源)隐藏起来，直到可以安全地删除它们。 在删除隐藏的节点之前，我们需要知道当时访问数据结构的所有线程都已经完成了它们正在执行的操作。 通过上面的特点2，这将意味着不再有任何引用留下(因为在此期间不可能创建新的引用)。 最困难的部分是在不同步的情况下完成所有这些工作。 否则，我们就失去了lock-free应该带来的好处！</p><p>epoch的工作原理是:</p><ol><li>A 全局epoch计数器(取值0、1和2) ;</li><li>A global list of garbage for each epoch;每个opoch都有一个全局垃圾列表;</li><li>每个线程的“活动”标志;</li><li>每个线程的epoch计数器</li></ol><p>epoch用于发现何时垃圾可以安全地释放，因为没有线程可以到达它。 与传统的 GC 不同，这不需要遍历实时数据; 这只是检查opoch计数器。</p><p>当一个线程想要对数据结构执行一个操作时，它首先设置它的<code>active</code>标志，然后更新它的本地epoch以匹配全局epoch。 如果线程从数据结构中删除一个节点，则将该节点添加到当前全局epoch的垃圾列表中。 (注意: 垃圾进入当前的全局epoch，而不是以前的本地快照，这一点非常重要。) 当它完成操作时，它清除<code>active</code>标志。</p><p>为了尝试收集垃圾(可以在任何时候执行) ，线程遍历所有参与线程的标志，并检查所有活动线程是否都在当前epoch中。 如果是这样，它可以尝试增加全局opoch(模3)。 如果增量成功，则可以释放两个eopch前的垃圾。</p><p>为什么我们需要三个epoch？ 因为“垃圾收集”是并发完成的，所以线程在任何时候都可能处于两个epoch之一(旧的epoch和新的epoch)。 但是，因为我们在递增之前检查所有活动线程都处于旧eopch中，所以可以保证没有活动线程处于第三个epoch中。</p><p>这个方案是经过精心设计的，以便在大多数时间里，线程只访问已经在缓存中或(通常)线程本地的数据。 只有在进行“ GC”时，才会涉及到改变全局epoch或者读取其他线程的eopch。 epoch 方法也与算法无关，易于使用，其性能与其他方法相比具有竞争力。</p><p>这个方案也证明非常适合Rust的所有权系统.</p><h2 id="the-rust-api" tabindex="-1">The Rust API <a class="header-anchor" href="#the-rust-api" aria-label="Permalink to &quot;The Rust API&quot;">​</a></h2><p>我们希望 Rust API 反映基于epoch的回收的基本原则:</p><ul><li>当对共享数据结构进行操作时，线程必须始终处于“活动”状态。</li><li>当线程处于活动状态时，从数据结构中读出的所有数据将保持分配状态，直到线程变为非活动状态。</li></ul><p>我们将利用 Rust 的所有权系统——特别是基于所有权的资源管理(又名 RAII)——在 epoch API 的类型签名中直接捕获这些约束。 这反过来将有助于确保我们正确管理epoch。</p><h3 id="guard" tabindex="-1">Guard <a class="header-anchor" href="#guard" aria-label="Permalink to &quot;Guard&quot;">​</a></h3><p>要对无锁数据结构进行操作，首先需要获得一个<code>guard</code>，这是一个所有值，表示线程处于活动状态:</p><div class="language-rust line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">struct</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Guard</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">pin</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Guard</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Pin 函数将线程标记为 active，加载全局epoch，并可能尝试执行 GC (稍后将详细介绍)。 另一方面，Guard 的析构函数通过将线程标记为非活动状态退出epoch管理。</p><p>因为<code>Guard</code>表示“处于活动状态” ，所以借用<code>&amp;&#39;a Guard</code>保证线程在整个生存期内处于活动状态——这正是我们在无锁算法中绑定快照生存期所需要的。</p><p>为了使<code>Guard</code>能够工作，Crossbeam 提供了一组三指针类型，它们可以一起工作:</p><ul><li><code>Owned&lt;T&gt;</code>,类似于<code>Box&lt;T&gt;</code>,拥有所有权,并且这些数据还尚未放进并发数据结构中.</li><li><code>Shared&lt;&#39;a,T&gt;</code>,,类似于&amp;&#39;a T,指向并发数据结构中的数据,可能可访问,也可能不可访问,但是确保在生命周期&#39;a期间不会被释放.</li><li><code>Atomic&lt;T&gt;</code>,类似于<code>std::sync::atomic::AtomicPtr</code>,它使用 <code>Owned</code> 和 <code>Shared</code> 类型提供对指针的原子更新，并将它们连接到一个 <code>Guard</code>。</li></ul><p>然后我们一起来看看这些指针.</p><h3 id="owned-and-shared-pointers" tabindex="-1">Owned and Shared pointers <a class="header-anchor" href="#owned-and-shared-pointers" aria-label="Permalink to &quot;Owned and Shared pointers&quot;">​</a></h3><h4 id="owned" tabindex="-1">Owned <a class="header-anchor" href="#owned" aria-label="Permalink to &quot;Owned&quot;">​</a></h4><p><code>Owned</code> 接口与Box几乎相同:</p><div class="language-rust line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">struct</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Owned</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">impl</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Owned</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">new</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">t</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Owned</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">impl</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Deref</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Owned</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Target</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">...</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F78C6C;">impl</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">DerefMut</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Owned</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="shared" tabindex="-1">Shared <a class="header-anchor" href="#shared" aria-label="Permalink to &quot;Shared&quot;">​</a></h4><p><code>Shared&lt;&#39;a,T&gt;</code>类似于<code>&amp;&#39;a T</code>,但是他可以<code>Deref</code>到<code>&amp;&#39;a T</code>. 它所提供的指针的生命周期实际上是 a。</p><div class="language-rust line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">struct</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Shared</span><span style="color:#89DDFF;">&lt;&#39;</span><span style="color:#FFCB6B;">a</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#FFCB6B;">a</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">impl</span><span style="color:#89DDFF;">&lt;&#39;</span><span style="color:#FFCB6B;">a</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Copy</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Shared</span><span style="color:#89DDFF;">&lt;&#39;</span><span style="color:#FFCB6B;">a</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F78C6C;">impl</span><span style="color:#89DDFF;">&lt;&#39;</span><span style="color:#FFCB6B;">a</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Clone</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Shared</span><span style="color:#89DDFF;">&lt;&#39;</span><span style="color:#FFCB6B;">a</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">impl</span><span style="color:#89DDFF;">&lt;&#39;</span><span style="color:#FFCB6B;">a</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Deref</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Shared</span><span style="color:#89DDFF;">&lt;&#39;</span><span style="color:#FFCB6B;">a</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#C792EA;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Target</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;&#39;</span><span style="color:#FFCB6B;">a</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">...</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="atomic" tabindex="-1">Atomic <a class="header-anchor" href="#atomic" aria-label="Permalink to &quot;Atomic&quot;">​</a></h3><p>crossbeam-epoch这个库的核心就是Atomic,它提供了对于nullable pointer的原子访问,将库的其他部分连接起来.</p><div class="language-rust line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">struct</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Atomic</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">impl</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Atomic</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    /// Create a new, null atomic pointer.</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">null</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Atomic</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>我们一起一次只看一个操作,因为这些操作的签名非常微妙.</p><h4 id="loading" tabindex="-1">Loading <a class="header-anchor" href="#loading" aria-label="Permalink to &quot;Loading&quot;">​</a></h4><p>首先从load开始</p><div class="language-rust line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">impl</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Atomic</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">load</span><span style="color:#89DDFF;">&lt;&#39;</span><span style="color:#FFCB6B;">a</span><span style="color:#89DDFF;">&gt;(&amp;</span><span style="color:#A6ACCD;">self</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> ord</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Ordering</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> _</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;&#39;</span><span style="color:#FFCB6B;">a</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Guard</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Option</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Shared</span><span style="color:#89DDFF;">&lt;&#39;</span><span style="color:#FFCB6B;">a</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;&gt;;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>为了完成这个任务，我们必须借用一个<code>Guard</code>。 如上所述，这是一种保证线程在整个生命周期中处于活动状态的方法。 作为回报，您将得到一个可选的 <code>Shared</code> 指针(如果 Atomic 当前为 null，则返回 None) ，其生命期绑定到<code>Guard</code>。</p><p>将其与标准库的 AtomicPtr 接口进行比较很有意思，在这个接口中 load 返回一个 * mut t。 AtomicPtr的load签名</p><div class="language-rust line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">load</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">self</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> order</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Ordering</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#C792EA;">mut</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">T</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h4 id="store" tabindex="-1">store <a class="header-anchor" href="#store" aria-label="Permalink to &quot;store&quot;">​</a></h4><p>Storing is a bit more complicated because of the multiple pointer types in play.</p><p>如果我们只是想写一个 Owned 指针或一个 null 值，我们甚至不需要线程是活动的。 我们只是将所有权转移到数据结构中，不需要任何关于指针生命周期的保证:</p><div class="language-rust line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">impl</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Atomic</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">store</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">self</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> val</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Option</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Owned</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;&gt;,</span><span style="color:#A6ACCD;"> ord</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Ordering</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>但有时，我们希望将所有权转移到数据结构中，并立即获得一个指向所转移数据的<code>Shared</code>指针——例如，因为我们希望添加到数据结构中同一节点的附加链接。 在这种情况下，我们需要将其生命周期和一个<code>Guard</code>联系起来:</p><div class="language-rust line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">impl</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Atomic</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">store_and_ref</span><span style="color:#89DDFF;">&lt;&#39;</span><span style="color:#FFCB6B;">a</span><span style="color:#89DDFF;">&gt;(&amp;</span><span style="color:#A6ACCD;">self</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">                             val</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Owned</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;,</span></span>
<span class="line"><span style="color:#A6ACCD;">                             ord</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Ordering</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">                             _</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;&#39;</span><span style="color:#FFCB6B;">a</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Guard</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">                             </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Shared</span><span style="color:#89DDFF;">&lt;&#39;</span><span style="color:#FFCB6B;">a</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>请注意，val的运行时表示和返回值完全相同——我们传入一个指针，然后得到相同的指针。 但是从Rust的观点来看，这一步的所有权状况发生了根本性的变化。</p><p>最后,我们可以讲一个<code>Shared</code>指针存回数据结构中.</p><div class="language-rust line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">impl</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Atomic</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">store_shared</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">self</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> val</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Option</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Shared</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;&gt;,</span><span style="color:#A6ACCD;"> ord</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Ordering</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>这个操作不需要guard,因为我们没有学到任何关于指针生命周期的新信息.</p><h4 id="cas" tabindex="-1">CAS <a class="header-anchor" href="#cas" aria-label="Permalink to &quot;CAS&quot;">​</a></h4><p>compare-and-set,换出一个<code>Shared</code>,放入一个<code>Owned</code>:</p><div class="language-rust line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">impl</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Atomic</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">cas</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">self</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">               old</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Option</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Shared</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;&gt;,</span></span>
<span class="line"><span style="color:#A6ACCD;">               new</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Option</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Owned</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;&gt;,</span></span>
<span class="line"><span style="color:#A6ACCD;">               ord</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Ordering</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">               </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Result</span><span style="color:#89DDFF;">&lt;(),</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Option</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Owned</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;&gt;&gt;;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>与store一样，此操作不需要<code>Guard</code>; 它不产生新的生命周期信息。 结果返回CAS是否成功; 如果不成功，新指针的所有权将返回给调用者。</p><p>我们有一个类似的操作<code>store_and_ref</code>:</p><div class="language-rust line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">impl</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Atomic</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">cas_and_ref</span><span style="color:#89DDFF;">&lt;&#39;</span><span style="color:#FFCB6B;">a</span><span style="color:#89DDFF;">&gt;(&amp;</span><span style="color:#A6ACCD;">self</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">                           old</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Option</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Shared</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;&gt;,</span></span>
<span class="line"><span style="color:#A6ACCD;">                           new</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Owned</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;,</span></span>
<span class="line"><span style="color:#A6ACCD;">                           ord</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Ordering</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">                           _</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;&#39;</span><span style="color:#FFCB6B;">a</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Guard</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">                           </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Result</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Shared</span><span style="color:#89DDFF;">&lt;&#39;</span><span style="color:#FFCB6B;">a</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Owned</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;&gt;;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>区别在于如果成功,会返回一个<code>Shared</code>指针,指向刚刚放入的数据.</p><p>最后,我们可以使用一个Shared替换另一个Shared.</p><div class="language-rust line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">impl</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Atomic</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">cas_shared</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">self</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">                             old</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Option</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Shared</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;&gt;,</span></span>
<span class="line"><span style="color:#A6ACCD;">                             new</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Option</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Shared</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;&gt;,</span></span>
<span class="line"><span style="color:#A6ACCD;">                             ord</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Ordering</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">                             </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">bool</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>当 CAS 成功时，布尔返回值为 true。</p><h4 id="释放内存" tabindex="-1">释放内存 <a class="header-anchor" href="#释放内存" aria-label="Permalink to &quot;释放内存&quot;">​</a></h4><p>上述所有机制的目标就是: 释放不再可及(no longer reachable)的内存. 当一个节点已经从数据结构中unlink,unlink的线程可以通知他的<code>Guard</code>内存应被回收:</p><div class="language-rust line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">impl</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Guard</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">unsafe</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">unlinked</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;(&amp;</span><span style="color:#A6ACCD;">self</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> val</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Shared</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;);</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>此操作将 Shared 指针添加到适当的垃圾列表中，允许在两个epoch之后释放它。 该行动是unsafe，因为它声称:</p><ul><li>从数据结构无法访问指针,</li><li>没有其他线程会再针对这个val,调用unlink</li></ul><p>但关键的是，其他线程可能会继续引用这个共享指针; epoch 系统将确保在实际释放指针时没有线程再继续引用这个共享指针。</p><p>这里的共享指针的生命周期和<code>Guard</code>之间没有特定的联系; 如果我们有一个可达的<code>Shared</code>指针，我们知道它来自的<code>Guard</code>是活动的。</p><h4 id="基于epoch的特雷贝尔栈" tabindex="-1">基于epoch的特雷贝尔栈 <a class="header-anchor" href="#基于epoch的特雷贝尔栈" aria-label="Permalink to &quot;基于epoch的特雷贝尔栈&quot;">​</a></h4><p>下面给出使用Crossbeam实现的特雷贝尔栈的完整源码:</p><div class="language-rust line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">use</span><span style="color:#FFCB6B;"> std</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">sync</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">atomic</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">Ordering</span><span style="color:#89DDFF;">::{</span><span style="color:#FFCB6B;">Acquire</span><span style="color:#89DDFF;">,</span><span style="color:#FFCB6B;"> Release</span><span style="color:#89DDFF;">,</span><span style="color:#FFCB6B;"> Relaxed</span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#F78C6C;">use</span><span style="color:#FFCB6B;"> std</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">ptr</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">use</span><span style="color:#FFCB6B;"> crossbeam</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">mem</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">epoch</span><span style="color:#89DDFF;">::{</span><span style="color:#A6ACCD;">self</span><span style="color:#89DDFF;">,</span><span style="color:#FFCB6B;"> Atomic</span><span style="color:#89DDFF;">,</span><span style="color:#FFCB6B;"> Owned</span><span style="color:#89DDFF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">struct</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">TreiberStack</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    head</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Atomic</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Node</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;&gt;,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">struct</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Node</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    data</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    next</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Atomic</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Node</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;&gt;,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">impl</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">TreiberStack</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">new</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">TreiberStack</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">TreiberStack</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            head</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Atomic</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">new</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">push</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">self</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> t</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">        // allocate the node via Owned</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">mut</span><span style="color:#A6ACCD;"> n </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Owned</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">new</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">Node</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            data</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> t</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">            next</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Atomic</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">new</span><span style="color:#89DDFF;">(),</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">        // become active</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> guard </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">epoch</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">pin</span><span style="color:#89DDFF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;font-style:italic;">loop</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">            // snapshot current head</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> head </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> self</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">head</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">load</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">Relaxed</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;</span><span style="color:#A6ACCD;">guard</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">            // update `next` pointer with snapshot</span></span>
<span class="line"><span style="color:#A6ACCD;">            n</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">next</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">store_shared</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">head</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Relaxed</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">            // if snapshot is still good, link in the new node</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;font-style:italic;">match</span><span style="color:#A6ACCD;"> self</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">head</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">cas_and_ref</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">head</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> n</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Release</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;</span><span style="color:#A6ACCD;">guard</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#FFCB6B;">Ok</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">_</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#FFCB6B;">Err</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">owned</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> n </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> owned</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">pop</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">self</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Option</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">        // become active</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> guard </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">epoch</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">pin</span><span style="color:#89DDFF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;font-style:italic;">loop</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">            // take a snapshot</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;font-style:italic;">match</span><span style="color:#A6ACCD;"> self</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">head</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">load</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">Acquire</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;</span><span style="color:#A6ACCD;">guard</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">                // the stack is non-empty</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#FFCB6B;">Some</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">head</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">                    // read through the snapshot, *safely*!</span></span>
<span class="line"><span style="color:#A6ACCD;">                    </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> next </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> head</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">next</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">load</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">Relaxed</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;</span><span style="color:#A6ACCD;">guard</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">                    // if snapshot is still good, update from `head` to `next`</span></span>
<span class="line"><span style="color:#A6ACCD;">                    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> self</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">head</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">cas_shared</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">Some</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">head</span><span style="color:#89DDFF;">),</span><span style="color:#A6ACCD;"> next</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Release</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">                        </span><span style="color:#F78C6C;">unsafe</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">                            // mark the node as unlinked</span></span>
<span class="line"><span style="color:#A6ACCD;">                            guard</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">unlinked</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">head</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">                            // extract out the data from the now-unlinked node</span></span>
<span class="line"><span style="color:#A6ACCD;">                            </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Some</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">ptr</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">read</span><span style="color:#89DDFF;">(&amp;(*</span><span style="color:#A6ACCD;">head</span><span style="color:#89DDFF;">).</span><span style="color:#A6ACCD;">data</span><span style="color:#89DDFF;">))</span></span>
<span class="line"><span style="color:#A6ACCD;">                        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">                    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">                // we observed the stack empty</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#FFCB6B;">None</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">None</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br></div></div><p>一些现象:</p><ul><li><p>该算法的基本逻辑与依赖于 GC 的版本相同，只是我们显式地将弹出的节点标记为“ unlinked”。 一般来说，可以采用“现成的”无锁算法(一般的算法实现通常假设GC的存在) ，并以这种方式直接针对 Crossbeam 对其进行编码。</p></li><li><p>捕获快照后，我们可以在不使用不安全的情况下解除对快照的引用，因为<code>Guard</code>保证了快照一定没被释放。</p></li><li><p>在这里使用 <code>ptr::read</code> 是合理的，因为我们使用了比较并交换来确保只有一个线程调用它，而且 epoch 回收方案不运行析构函数，而只是释放内存。</p></li></ul><p>关于释放的最后一点需要更多的注释，因此让我们通过讨论垃圾来总结 API 描述。</p><h4 id="管理垃圾" tabindex="-1">管理垃圾 <a class="header-anchor" href="#管理垃圾" aria-label="Permalink to &quot;管理垃圾&quot;">​</a></h4><p>Crossbeam 中的设计将epoch管理视为所有数据结构共享的服务: 存在一个全局的唯一的的epoch 状态，对于每个线程状态有一个本地状态。 这使得 epoch API 的使用非常简单，因为没有每个数据结构的设置。 这还意味着(相当简单的)空间使用量与使用 epoch 的线程数量相关，而不是与数据结构的数量相关。</p><p>Crossbeam 的实现与现有的 epoch 文献的一个不同之处在于，每个线程都保存本地垃圾列表。 也就是说，当一个线程将一个节点标记为“ unlinked”时，该节点被添加到一些线程本地数据中，而不是立即添加到全局垃圾列表中(这将需要额外的同步)。</p><p>每次调用 <code>epoch::pin()</code>时，当前线程将检查其本地垃圾是否超过了收集阈值，如果超过，则将尝试进行收集。 同样，每当调用 <code>epoch::pin()</code>时，如果全局 epoch 已超过前一个快照，则当前线程可以收集它的一些垃圾。 除了避免在垃圾列表周围进行全局同步之外，这个新方案还将实际释放内存的工作分散到访问数据结构的所有线程中。</p><p>因为只有当所有活动线程都在当前epoch上时，GC 才会发生，所以不可能总是收集。 但实际上，给定线程上的垃圾很少超过阈值。</p><p>但是有一个问题: 因为 GC 可能会失败，如果一个线程正在退出，那么它需要处理它的垃圾。 因此 Crossbeam 实现还具有全局垃圾列表，当线程退出时，这些垃圾列表用作最后的抛垃圾的地方。 这些全局垃圾列表由成功递增全局epoch的线程收集。</p><p>最后，“收集”垃圾意味着什么？ 如上所述，库仅释放内存; 它不运行析构函数。</p><p>从概念上讲，框架将对象的破坏分为两部分: 销毁 / 移出内部数据，以及释放包含该数据的对象。 前者应该与调用 unlinked 同时发生——也就是说，除了实际释放对象的能力之外，还有一个唯一的线程在每个意义上拥有对象。 后者发生在某个未知的后续点，当已知的对象不再被引用时。 这确实对用户施加了一种义务: 通过快照访问应该只读取在释放之前有效的数据。 但是，无锁数据结构基本上都是这样，它倾向于在与容器相关的数据(即原子字段)和包含的实际数据(如 Node 中的数据字段)之间有一个明确的分隔。</p><p>以这种方式将对象拆分意味着在可预测的时间内以同步方式运行析构函数，减轻了 GC 的痛苦之一，并允许将框架用于非<code>&#39;static</code>(和非<code>Send</code>)数据。</p><h2 id="展望" tabindex="-1">展望 <a class="header-anchor" href="#展望" aria-label="Permalink to &quot;展望&quot;">​</a></h2><p>横梁仍处于起步阶段。 这里的工作为探索 Rust 中大范围的无锁数据结构奠定了基础，我希望 Crossbeam 最终发挥类似于 java.util.concurrent for Rust 的作用——包括无锁 hashmap、窃取工作的 deques 和轻量级任务引擎。 如果你对这项工作感兴趣，我很乐意帮忙！</p><h2 id="我的一些心得" tabindex="-1">我的一些心得 <a class="header-anchor" href="#我的一些心得" aria-label="Permalink to &quot;我的一些心得&quot;">​</a></h2><p>我在尝试编写lock-free stack的初期,并没有接触crossbeam,只是在碰到ABA问题,无法解决以后才寻求crossbeam的支持. 所以我实现的无锁栈和文中的有一些区别,但是一致的.下面附上我的实现.</p><div class="language-rust line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">use</span><span style="color:#FFCB6B;"> std</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">sync</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">atomic</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">Ordering</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">extern</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">crate</span><span style="color:#A6ACCD;"> crossbeam_epoch </span><span style="color:#F78C6C;">as</span><span style="color:#A6ACCD;"> epoch</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">use</span><span style="color:#FFCB6B;"> epoch</span><span style="color:#89DDFF;">::{</span><span style="color:#FFCB6B;">Atomic</span><span style="color:#89DDFF;">,</span><span style="color:#FFCB6B;"> Owned</span><span style="color:#89DDFF;">,</span><span style="color:#FFCB6B;"> Shared</span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">struct</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Node</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    value</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">i32</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    next</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> Node</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">struct</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">LockFreeStack</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    next</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Atomic</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Node</span><span style="color:#89DDFF;">&gt;,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F78C6C;">unsafe</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">impl</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Sync</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">LockFreeStack</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{}</span></span>
<span class="line"><span style="color:#F78C6C;">unsafe</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">impl</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Send</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">LockFreeStack</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{}</span></span>
<span class="line"><span style="color:#F78C6C;">impl</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">LockFreeStack</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">new</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">LockFreeStack</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">LockFreeStack</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            next</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Atomic</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">null</span><span style="color:#89DDFF;">(),</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">push</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">self</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> v</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">i32</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> guard </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">epoch</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">pin</span><span style="color:#89DDFF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;">   </span><span style="color:#C792EA;">mut</span><span style="color:#A6ACCD;"> new </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Owned</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">new</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">Node</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            value</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> v</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">            next</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">std</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">ptr</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">null</span><span style="color:#89DDFF;">(),</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">});</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;font-style:italic;">loop</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;">   old </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> self</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">next</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">load</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">Ordering</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">Relaxed</span><span style="color:#89DDFF;">,&amp;</span><span style="color:#A6ACCD;">guard</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">            new</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">next</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">old</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">as_raw</span><span style="color:#89DDFF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;font-style:italic;">match</span><span style="color:#A6ACCD;">  self</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">next</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">compare_and_set</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">old</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> new</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Ordering</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">Release</span><span style="color:#89DDFF;">,&amp;</span><span style="color:#A6ACCD;">guard</span><span style="color:#89DDFF;">){</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#FFCB6B;">Ok</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">_</span><span style="color:#89DDFF;">)=&gt;</span><span style="color:#89DDFF;font-style:italic;">break</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#FFCB6B;">Err</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">)=&gt;{</span></span>
<span class="line"><span style="color:#A6ACCD;">                    new</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">new</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">                    // spin_loop_hint();</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">pop</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">self</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Option</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">i32</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> guard </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">epoch</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">pin</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;font-style:italic;">loop</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;">   old </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> self</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">next</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">load</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">std</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">sync</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">atomic</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">Ordering</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">Acquire</span><span style="color:#89DDFF;">,&amp;</span><span style="color:#A6ACCD;">guard</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;font-style:italic;">/*</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">            按照as_ref的文档说明,old的load不能是Relaxed,只要确保old的写的另一方是Release,就是安全的</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">            我们这里无论是Push还是Pop对于old的set访问用得都是Release,因此是安全的.</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">            */</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;font-style:italic;">match</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">unsafe</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">old</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">as_ref</span><span style="color:#89DDFF;">()}{</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#FFCB6B;">None</span><span style="color:#89DDFF;">=&gt;</span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">None</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#FFCB6B;">Some</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">old2</span><span style="color:#89DDFF;">)=&gt;{</span></span>
<span class="line"><span style="color:#A6ACCD;">                    </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> next</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">old2</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">next</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">                    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> self</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">next</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">compare_and_set</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">old</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Shared</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">from</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">next</span><span style="color:#89DDFF;">),</span><span style="color:#FFCB6B;">Ordering</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">Release</span><span style="color:#89DDFF;">,&amp;</span><span style="color:#A6ACCD;">guard</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">is_ok</span><span style="color:#89DDFF;">(){</span></span>
<span class="line"><span style="color:#A6ACCD;">                        </span><span style="color:#F78C6C;">unsafe</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">                            </span><span style="color:#676E95;font-style:italic;">/*</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">                            按照defer_destroy文档,只要我们保证old不会再其他线程使用就是安全的</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">                            而我们非常确信,这个old不会被其他线程使用,</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">                            因为这里是defer_destroy,所以解决了ABA问题 (https://en.wikipedia.org/wiki/ABA_problem)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">                            */</span></span>
<span class="line"><span style="color:#A6ACCD;">                            guard</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">defer_destroy</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">old</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">                        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">                        </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Some</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">old2</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">value</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">                    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">                    </span><span style="color:#82AAFF;">spin_loop_hint</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F78C6C;">impl</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Drop</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">LockFreeStack</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/*</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">     因为&amp;mut self保证了不会有其他人同时操作这个Stack,因此可以放心的一个一个移除即可.</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    */</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">drop</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#C792EA;">mut</span><span style="color:#A6ACCD;"> self</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> guard </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">epoch</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">pin</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">mut</span><span style="color:#A6ACCD;"> next </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> self</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">next</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">load</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">Ordering</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">Relaxed</span><span style="color:#89DDFF;">,&amp;</span><span style="color:#A6ACCD;">guard</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">as_raw</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">as</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#C792EA;">mut</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Node</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;font-style:italic;">while</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">!</span><span style="color:#A6ACCD;">next</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">is_null</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;font-style:italic;">/*</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">            这里的next确定是通过Owned分配的,所以没有安全问题</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">            并且drop持有的是mutable stack,只有一个线程可以访问,所以也没有并发问题.</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">            */</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> n </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">unsafe</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Owned</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">from_raw</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">next</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">            // println!(&quot;drop {}&quot;, n.value);</span></span>
<span class="line"><span style="color:#A6ACCD;">            next </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> n</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">next </span><span style="color:#F78C6C;">as</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#C792EA;">mut</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">Node</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br></div></div><p>这里使用了i32,而没有使用T,只是为了简化问题,能够聚焦lock-free编程.</p><p>完整的代码位于我的<a href="https://github.com/nkbai/lock-free-stack/blob/epoch_i32/src/lib.rs" target="_blank" rel="noreferrer">github</a></p></div></div></main><footer class="VPDocFooter" data-v-c4b0d3cf data-v-face870a><!--[--><!--]--><!----><div class="prev-next" data-v-face870a><div class="pager" data-v-face870a><a class="pager-link prev" href="/rust/Futures_Explained_in_200_lines_of_Rust_with_error_version.html" data-v-face870a><span class="desc" data-v-face870a>Previous page</span><span class="title" data-v-face870a>200行代码讲透Rust Futures-有bug版本</span></a></div><div class="has-prev pager" data-v-face870a><a class="pager-link next" href="/rust/rust开发工具.html" data-v-face870a><span class="desc" data-v-face870a>Next page</span><span class="title" data-v-face870a>rust开发工具 clion</span></a></div></div></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"app_security_android_13_dp1_changes_security.md\":\"ee93db26\",\"app_security_android_howto_protected_unexported_components.md\":\"49da8f96\",\"app_security_identity_confusion_in_webview-based_mobile_app-in-app_ecosystems.md\":\"c8c23f72\",\"app_security_android_lce_third_party.md\":\"3a106c21\",\"app_security_android_access_protected_components.md\":\"de9381f2\",\"app_security_index.md\":\"ac4a3f31\",\"app_security_hook_rest_for_work.md\":\"be99bf39\",\"app_security_tiktok_arbitrary_code_execution.md\":\"d0b7470d\",\"app_security_bilibili_arbitrary_code_execution.md\":\"fe8481e9\",\"app_security_white_box_cryptography.md\":\"5c7e50ae\",\"app_security_tiktok_theft_of_arbitrary.md\":\"075a56af\",\"app_security_use_cryptography_in_mobile_appls_the_right_way.md\":\"bd3d61ff\",\"app_security_tiktok_arbitrary_code_execution_download_service.md\":\"514e5d1d\",\"blockchain_block_chain_core_index.md\":\"e6ebc4f1\",\"blockchain_btcd_bitcoin script.md\":\"b9be54b5\",\"blockchain_btcd_bloom.md\":\"646e9b64\",\"blockchain_btcd_btcjson.md\":\"f447e956\",\"blockchain_btcd_index.md\":\"62a4572e\",\"blockchain_btcd_database.md\":\"5b5f111c\",\"blockchain_btcd_mempool.md\":\"d852bae4\",\"blockchain_btcd_peer.md\":\"986c5707\",\"blockchain_btcd_indexer模块.md\":\"517ac46e\",\"blockchain_btcd_mrumap.md\":\"2ca1b2e7\",\"blockchain_btcd_wire_common.md\":\"89f73d7b\",\"blockchain_block_chain_core_ecc_signature_random.md\":\"1ad99310\",\"blockchain_btcd_一个比特币脚本示例.md\":\"627ef807\",\"blockchain_btcd_mining.md\":\"571ced99\",\"blockchain_btcd_rpcclient.md\":\"2313197a\",\"blockchain_block_chain_core_vrf.md\":\"e4a91aac\",\"blockchain_btcd_隔离见证.md\":\"cfcb6915\",\"blockchain_btcd_比特币指令集说明.md\":\"f75cf776\",\"blockchain_btcwallet_chain模块.md\":\"d6d2f342\",\"blockchain_btcd_比特币解锁脚本中的scriptsignature都包含了什么东西.md\":\"8968b05d\",\"blockchain_btcd_比特币的地址类型.md\":\"1bb3b24c\",\"blockchain_btcwallet_btcwallet系列之一-grpc模块.md\":\"f2d23b55\",\"blockchain_btcwallet_readme.md\":\"ae4c0e92\",\"blockchain_btcwallet_snacl.md\":\"ed618695\",\"blockchain_btcwallet_index.md\":\"09f0cfa0\",\"blockchain_btcwallet_hdwallet-bip0032.md\":\"4a93fb82\",\"blockchain_btcwallet_waddrmgr模块.md\":\"62a4bfd9\",\"blockchain_btcwallet_walletdb.md\":\"c4ba2763\",\"blockchain_btcwallet_wallet中的数据库设计.md\":\"d0e90dad\",\"blockchain_btcwallet_wallet模块.md\":\"98f32d8f\",\"blockchain_btcwallet_wtxmgr模块.md\":\"e93ee3d4\",\"blockchain_ethereum_btc跨链设计.md\":\"f9f20f8f\",\"blockchain_ethereum_crosschainatomicexchange.md\":\"b9292e56\",\"blockchain_btcwallet_拓扑排序在比特币tx管理中的使用.md\":\"9e946254\",\"blockchain_ethereum_ethereum_erc20_wrapper.md\":\"448bceef\",\"blockchain_ethereum_golang subprocess tests.md\":\"29e6940d\",\"blockchain_ethereum_how_to_create_channel.md\":\"b67714f1\",\"blockchain_ethereum_golang_plugin.md\":\"ab1fad5d\",\"blockchain_ethereum_index.md\":\"85d51f83\",\"blockchain_ethereum_raiden_graph.md\":\"bb20a0a3\",\"blockchain_ethereum_meshbox配置 openwrt.md\":\"da7dcd77\",\"blockchain_ethereum_solidity_mapping_implementation.md\":\"fbfe9b40\",\"blockchain_ethereum_synapse代码阅读.md\":\"22352390\",\"blockchain_ethereum_thedao.md\":\"db63a6f2\",\"blockchain_ethereum_how_to_use_channel.md\":\"e5ec7097\",\"blockchain_ethereum_从一次盗币事件再谈合约安全问题.md\":\"5ad9a657\",\"blockchain_ethereum_区块链计时器.md\":\"1bdf98a0\",\"blockchain_ethereum_区块链问题笔记.md\":\"71e3664f\",\"blockchain_ethereum_以太坊evm笔记.md\":\"07df4141\",\"blockchain_ethereum_合约注意事项.md\":\"3c14037c\",\"blockchain_ethereum_多链工作问题.md\":\"7c1455fe\",\"blockchain_ethereum_如何为 smartraiden 贡献代码.md\":\"9792ca14\",\"blockchain_ethereum_如何使用 dlv 调试 smartraiden.md\":\"d2ec78ad\",\"blockchain_ethereum_君士坦丁堡分叉引起的安全问题.md\":\"2f224b3b\",\"blockchain_ethereum_如何使用 smartraiden 以及 lnd 进行跨链原子资产交换.md\":\"cc563363\",\"blockchain_ethereum_安全总结.md\":\"578991fd\",\"blockchain_ethereum_并发和并行的区别.md\":\"49988d7f\",\"blockchain_ethereum_异常退出各种情况.md\":\"c22e1865\",\"blockchain_ethereum_比特币的txhash为什么会发生改变.md\":\"1f12aaab\",\"blockchain_ethereum_我对 smartplasma 的理解.md\":\"11fe0db7\",\"blockchain_ethereum_让photon支持go module.md\":\"ea4be6a4\",\"blockchain_ethereum_闪电网络交易密钥.md\":\"0d8062f9\",\"blockchain_index.md\":\"faec0783\",\"blockchain_ethereum_闪电网络.md\":\"885df916\",\"blockchain_libra_1.start_in_one_minute.md\":\"109fc4e0\",\"blockchain_libra_2.protobuf_in_libria.md\":\"2a6b01c9\",\"blockchain_libra_3.libra_schema.md\":\"bc95036c\",\"blockchain_libra_4.client_command_and_libriadb.md\":\"437982d4\",\"blockchain_libra_5.libra_ac.md\":\"c605f14d\",\"blockchain_libra_6.libria_mempool_1.md\":\"03918e7a\",\"blockchain_libra_7.libra_mempool_2.md\":\"92131850\",\"blockchain_libra_8.libria_mempool_3.md\":\"aef9f61a\",\"blockchain_solidity_memory_layout.md\":\"7c6bc652\",\"blockchain_libra_index.md\":\"0bc4af07\",\"blockchain_libra_9.libria_vrf.md\":\"83871d19\",\"index.md\":\"25da461c\",\"other_apt安装指定版本软件.md\":\"0ec38d3e\",\"blockchain_solidity_solidity_yul.md\":\"e9bf0c8d\",\"other_clean_mac.md\":\"b8fea38b\",\"other_brew安装指定版本boost.md\":\"5e911538\",\"other_capture_with_wireshark_for_android.md\":\"8fd0dd4d\",\"other_dynamic_tracing.md\":\"38e54181\",\"other_git以及github回退.md\":\"d0e26431\",\"other_crossover source insight 4.0使用.md\":\"867d28a8\",\"other_asynq_introduction.md\":\"acc430e6\",\"other_go_memory_model.md\":\"c7f14c80\",\"other_grpcox.md\":\"4b89c4dc\",\"other_hugo博客写作.md\":\"de09579b\",\"other_index.md\":\"6cde96d7\",\"other_how_to_mine_smt_2022.md\":\"07610bb8\",\"other_learn_go.md\":\"fff12b4b\",\"other_learningpythonv4.md\":\"7d9b1c0c\",\"other_opc 统一架构学习笔记.md\":\"711bfea3\",\"other_opcua_cross_compile_for_raspeberry.md\":\"95971a39\",\"other_opcua-rust.md\":\"214960cc\",\"other_rcore_os_program.md\":\"14f6252e\",\"other_read_kerenel_use_clion.md\":\"7b1fa474\",\"other_typescript_advanced_syntax.md\":\"a7cfb58b\",\"other_vscode_cnblog_plugin.md\":\"208c9e68\",\"other_webassembly_two_days_exercise.md\":\"2b8a77f4\",\"other_不用外部插件启用u盘ntfs写功能.md\":\"8195c963\",\"other_windows_hook_thiscall.md\":\"7a5784eb\",\"other_使用clion调试开发比特币源码.md\":\"51b884c7\",\"other_五个goland进行go开发的小技巧.md\":\"ce68ee58\",\"other_工作中常用工具入门.md\":\"cf6d352b\",\"other_使用ubuntu搭建时间机器备份服务.md\":\"8852ffe5\",\"other_用 go 写 webassembly入门.md\":\"4ad882be\",\"other_高性能go开发.md\":\"06d41d3d\",\"other_阈值签名.md\":\"f8b6f03f\",\"rust-leetcode_2019-06-01.md\":\"16ae288e\",\"rust-leetcode_2019-06-02.md\":\"6d7dd0ea\",\"rust-leetcode_2019-06-03.md\":\"855fcb94\",\"rust-leetcode_2019-06-04.md\":\"391987ed\",\"rust-leetcode_2019-06-06.md\":\"d4238f5a\",\"rust-leetcode_2019-06-05.md\":\"4314e088\",\"rust-leetcode_2019-06-10.md\":\"0ddb2268\",\"rust-leetcode_2019-06-08.md\":\"d4e473be\",\"rust-leetcode_2019-06-11.md\":\"e940550e\",\"rust-leetcode_2019-06-07.md\":\"ab77c500\",\"rust-leetcode_2019-06-14.md\":\"d5d66e42\",\"rust-leetcode_2019-06-15.md\":\"bd688825\",\"rust-leetcode_2019-06-17.md\":\"01793cf8\",\"rust-leetcode_2019-06-18.md\":\"cf09cbbc\",\"rust-leetcode_2019-08-10.md\":\"c528f79e\",\"rust-leetcode_2019-08-11.md\":\"3539cee5\",\"rust-leetcode_2019-08-04.md\":\"a4964246\",\"rust-leetcode_2019-08-12.md\":\"9ff97e95\",\"rust-leetcode_2019-08-14.md\":\"c88f3170\",\"rust-leetcode_2019-08-13.md\":\"cf13edb9\",\"rust-leetcode_2019-08-15.md\":\"c2ece05f\",\"rust-leetcode_2019-08-18.md\":\"5bf95c31\",\"rust-leetcode_2019-08-17.md\":\"3bc92be3\",\"rust-leetcode_2019-08-16.md\":\"c246e9bd\",\"rust-leetcode_2019-08-19.md\":\"0a6f75cc\",\"rust-leetcode_2019-08-21.md\":\"9b9eaff2\",\"rust-leetcode_2019-08-20.md\":\"05507fe2\",\"rust-leetcode_2019-08-22.md\":\"429c5a62\",\"rust-leetcode_2019-08-27.md\":\"5f49a5fc\",\"rust-leetcode_2019-08-29.md\":\"260c7d07\",\"rust-leetcode_2019-08-26.md\":\"c4a90440\",\"rust-leetcode_2019-08-30.md\":\"3a138724\",\"rust-leetcode_2019-08-23.md\":\"bba90dff\",\"rust-leetcode_2019-08-28.md\":\"973c333c\",\"rust-leetcode_2019-09-03.md\":\"f05f2709\",\"rust-leetcode_2019-09-02.md\":\"e6670dd2\",\"rust-leetcode_2019-09-05.md\":\"d7f2e4f7\",\"rust-leetcode_2019-09-04.md\":\"192987cc\",\"rust-leetcode_2019-09-09.md\":\"2037c60f\",\"rust-leetcode_2019-09-06.md\":\"6e0a686e\",\"rust-leetcode_2019-09-10.md\":\"c4d03f20\",\"rust-leetcode_2019-09-11.md\":\"f8c2c422\",\"rust-leetcode_2019-09-12.md\":\"92140690\",\"rust-leetcode_2019-09-13.md\":\"d0096c07\",\"rust-leetcode_2019-09-18.md\":\"eac9a217\",\"rust-leetcode_2019-09-17.md\":\"b7c7f738\",\"rust-leetcode_2019-09-19.md\":\"18ff1df5\",\"rust-leetcode_2019-09-16.md\":\"1e444157\",\"rust-leetcode_2019-09-23.md\":\"8c286b5d\",\"rust-leetcode_2019-09-20.md\":\"0bcd7b92\",\"rust-leetcode_2019-09-26.md\":\"5e8183c6\",\"rust-leetcode_2019-09-24.md\":\"967a3904\",\"rust-leetcode_2019-09-25.md\":\"2c9b2794\",\"rust-leetcode_2019-09-28.md\":\"ecfbce92\",\"rust-leetcode_2019-09-27.md\":\"c4764b3c\",\"rust-leetcode_2019-10-09.md\":\"4d19e768\",\"rust-leetcode_2019-10-08.md\":\"afe45510\",\"rust-leetcode_2019-10-10.md\":\"f3aa78e3\",\"rust-leetcode_2019-10-16.md\":\"416ae06a\",\"rust-leetcode_2019-10-11.md\":\"3efda8fc\",\"rust-leetcode_2019-10-14.md\":\"ad0dffc7\",\"rust-leetcode_2019-10-15.md\":\"aa22705f\",\"rust-leetcode_2019-10-18.md\":\"ce5c2679\",\"rust-leetcode_2019-10-17.md\":\"8b83b9ea\",\"rust-leetcode_2019-10-19.md\":\"21e12fdc\",\"rust-leetcode_2019-10-22.md\":\"16349681\",\"rust-leetcode_2019-10-23.md\":\"e9f69e86\",\"rust-leetcode_2019-10-21.md\":\"2c2d2981\",\"rust-leetcode_2019-10-25.md\":\"6d20d401\",\"rust-leetcode_2019-10-24.md\":\"d6dde3e5\",\"rust-leetcode_2019-10-28.md\":\"9d106d9f\",\"rust-leetcode_2019-10-29.md\":\"654b8240\",\"rust-leetcode_2019-10-30.md\":\"dd939d6c\",\"rust-leetcode_2019-11-01.md\":\"0f07b88e\",\"rust-leetcode_2019-11-04.md\":\"95c8a91b\",\"rust-leetcode_2019-11-07.md\":\"fab1be95\",\"rust-leetcode_2019-11-06.md\":\"86b298f6\",\"rust-leetcode_2019-11-05.md\":\"e530a56d\",\"rust-leetcode_2019-11-08.md\":\"ab853ce2\",\"rust-leetcode_2019-11-11.md\":\"dd0d9e86\",\"rust-leetcode_2019-11-14.md\":\"2370a1e6\",\"rust-leetcode_2019-11-12.md\":\"a73c6f78\",\"rust-leetcode_2019-11-13.md\":\"e8d34a5a\",\"rust-leetcode_2019-11-19.md\":\"6cc9566c\",\"rust-leetcode_2019-11-20.md\":\"04a0a97b\",\"rust-leetcode_2019-11-15.md\":\"903fc37b\",\"rust-leetcode_2019-11-21.md\":\"724469d8\",\"rust-leetcode_2019-11-18.md\":\"8f592072\",\"rust-leetcode_2019-11-25.md\":\"e822dada\",\"rust-leetcode_2019-11-22.md\":\"e33b446b\",\"rust-leetcode_2019-11-26.md\":\"f4856d06\",\"rust-leetcode_2019-11-28.md\":\"152beca7\",\"rust-leetcode_2019-11-27.md\":\"eab62afc\",\"rust-leetcode_2019-11-29.md\":\"6932211a\",\"rust-leetcode_2019-12-02.md\":\"44edb5de\",\"rust-leetcode_2019-12-03.md\":\"436b31e8\",\"rust-leetcode_2019-10-31.md\":\"a66fec84\",\"rust-leetcode_2019-12-05.md\":\"d0852dd4\",\"rust-leetcode_2019-12-06.md\":\"68362b11\",\"rust-leetcode_2019-12-09.md\":\"a4ab0a2c\",\"rust-leetcode_2019-12-11.md\":\"5723525d\",\"rust-leetcode_2019-12-10.md\":\"7b82d5b0\",\"rust-leetcode_2019-12-04.md\":\"06a1166a\",\"rust-leetcode_2019-12-12.md\":\"f33bdb54\",\"rust-leetcode_2019-12-17.md\":\"853f45ce\",\"rust-leetcode_2019-12-13.md\":\"502129f0\",\"rust-leetcode_2019-12-16.md\":\"80aa7bfb\",\"rust-leetcode_2019-12-23.md\":\"3a00cc39\",\"rust-leetcode_2019-12-19.md\":\"2a7c6a75\",\"rust-leetcode_2019-12-20.md\":\"f0008c00\",\"rust-leetcode_2019-12-18.md\":\"b90be337\",\"rust-leetcode_2019-12-25.md\":\"8abbd9a3\",\"rust-leetcode_2019-12-24.md\":\"334209a1\",\"rust-leetcode_2019-12-27.md\":\"2763b849\",\"rust-leetcode_2019-12-26.md\":\"45ad65bb\",\"rust-leetcode_2020-01-01.md\":\"0f76518a\",\"rust-leetcode_2019-12-30.md\":\"c5be12a2\",\"rust-leetcode_2019-12-31.md\":\"11f814a7\",\"rust-leetcode_2020-01-03.md\":\"9690b22d\",\"rust-leetcode_2020-01-06.md\":\"a7eb9848\",\"rust-leetcode_2020-01-09.md\":\"d789198b\",\"rust-leetcode_2020-01-02.md\":\"536550e1\",\"rust-leetcode_2020-01-07.md\":\"807b50a1\",\"rust-leetcode_2020-01-08.md\":\"f478a510\",\"rust-leetcode_2020-01-15.md\":\"6276a9f3\",\"rust-leetcode_2020-01-13.md\":\"87a7664b\",\"rust-leetcode_2020-01-16.md\":\"affb3aa2\",\"rust-leetcode_2020-01-14.md\":\"18b76fc6\",\"rust-leetcode_2020-01-20.md\":\"05790bbe\",\"rust-leetcode_2020-01-17.md\":\"1a5287f7\",\"rust-leetcode_2020-01-10.md\":\"9b6381b4\",\"rust-leetcode_2020-01-21.md\":\"95214e06\",\"rust-leetcode_2020-01-24.md\":\"3f435bec\",\"rust-leetcode_2020-01-23.md\":\"17c5a68e\",\"rust-leetcode_2020-01-22.md\":\"91b27707\",\"rust-leetcode_2020-02-04.md\":\"2d449627\",\"rust-leetcode_2020-02-03.md\":\"6ca2754a\",\"rust-leetcode_2020-02-05.md\":\"0863ba24\",\"rust-leetcode_2020-02-07.md\":\"758fd3e3\",\"rust-leetcode_2020-02-10.md\":\"72d73b67\",\"rust-leetcode_2020-02-11.md\":\"c93c5aa8\",\"rust-leetcode_2020-02-06.md\":\"d7c50807\",\"rust-leetcode_2020-02-12.md\":\"978d6f31\",\"rust-leetcode_2020-02-14.md\":\"03343223\",\"rust-leetcode_2020-02-18.md\":\"786d1b93\",\"rust-leetcode_2020-02-13.md\":\"31f6fed0\",\"rust-leetcode_2020-02-20.md\":\"8acdea29\",\"rust-leetcode_2020-02-21.md\":\"519af5a5\",\"rust-leetcode_2020-02-19.md\":\"2114dc4a\",\"rust-leetcode_2020-02-17.md\":\"ac764dd9\",\"rust-leetcode_2020-02-25.md\":\"83f68959\",\"rust-leetcode_2020-02-26.md\":\"e6525009\",\"rust-leetcode_2020-02-24.md\":\"f7c24a8c\",\"rust-leetcode_2020-02-27.md\":\"4829b572\",\"rust-leetcode_2020-03-04.md\":\"cdaa575a\",\"rust-leetcode_2020-02-28.md\":\"1270ecc6\",\"rust-leetcode_2020-03-02.md\":\"2ef755bd\",\"rust-leetcode_2020-03-03.md\":\"503ff63b\",\"rust-leetcode_2020-03-05.md\":\"5b0dfec1\",\"rust-leetcode_2020-03-06.md\":\"750b725c\",\"rust-leetcode_2020-03-09.md\":\"8649fc96\",\"rust-leetcode_2020-03-10.md\":\"05846f6e\",\"rust-leetcode_2020-03-11.md\":\"0dd755e5\",\"rust-leetcode_2020-03-12.md\":\"570aed71\",\"rust-leetcode_2020-03-13.md\":\"441297b3\",\"rust-leetcode_2020-03-16.md\":\"31580902\",\"rust-leetcode_2020-03-17.md\":\"d010fda0\",\"rust-leetcode_2020-03-18.md\":\"91235ef5\",\"rust-leetcode_2020-03-24.md\":\"3f213197\",\"rust-leetcode_2020-03-23.md\":\"743e86fa\",\"rust-leetcode_2020-03-25.md\":\"f6b58ecd\",\"rust-leetcode_2020-03-19.md\":\"7f204d89\",\"rust-leetcode_2020-03-20.md\":\"a094ab12\",\"rust-leetcode_2020-03-26.md\":\"b21299a6\",\"rust-leetcode_2020-03-27.md\":\"8e15c8dd\",\"rust-leetcode_模板.md\":\"afa1fad3\",\"rust-leetcode_index.md\":\"55d94bcc\",\"rust-leetcode_2020-03-30.md\":\"f41dcb6e\",\"rust-leetcode_2020-07-09.md\":\"811dd29e\",\"rust-leetcode_2020-03-31.md\":\"4ff9ecd9\",\"rust_index.md\":\"401f0a2c\",\"rust_build_your_own_block_on.md\":\"d0352568\",\"rust_convert_an_integer_to_an_enum.md\":\"2e80b79f\",\"rust_build_your_own_executor.md\":\"98293138\",\"rust_futures_explained_in_200_lines_of_rust2.md\":\"c4726410\",\"rust_lock-freedom-without-garbage-collection.md\":\"420ed5ea\",\"rust_ownership101.md\":\"9e28db8e\",\"rust_futures_explained_in_200_lines_of_rust.md\":\"cee3dc9e\",\"rust_rnats_1.start.md\":\"9ed06d36\",\"rust_my_note.md\":\"08c67a02\",\"rust_rnats_3.sublist.md\":\"ad28ef87\",\"rust_rnats_4.server.md\":\"9e131927\",\"rust_rnats_ppt_index.md\":\"058b61fe\",\"rust_rnats_index.md\":\"7e7bf395\",\"rust_rnats_ppt_从零实现消息中间件-server.md\":\"7a40937b\",\"rust_rnats_ppt_从零实现消息中间件-client.md\":\"73950b3f\",\"rust_rnats_ppt_从零实现消息中间件-server.client.md\":\"ed1e7150\",\"rust_rnats_2.parser.md\":\"492f5140\",\"rust_rnats_5.server.client.md\":\"f4eb09f4\",\"rust_rnats_6.client.md\":\"78c13a92\",\"rust_rust_global_function_pointer.md\":\"492eeb27\",\"rust_rust_atomic.md\":\"e1b68356\",\"rust_futures_explained_in_200_lines_of_rust_with_error_version.md\":\"d72871ec\",\"rust_rust_async_lock.md\":\"05e9dece\",\"rust_rust开发工具.md\":\"fb55139f\",\"static_analysis_index.md\":\"011091a8\",\"rust_交叉编译rust.md\":\"ed388daa\",\"static_analysis_clang_ast.md\":\"b25b3b4c\",\"static_analysis_llvm_overview.md\":\"122f441d\",\"rust_tokio笔记.md\":\"6d1507eb\",\"system_armv8v9_arch_csdn.md\":\"b55ab723\",\"static_analysis_mariana-introduction.md\":\"f7e8afa8\",\"static_analysis_using_clang_tidy_for_custom_checkers.md\":\"92078656\",\"web-security_index.md\":\"4f40f0a9\",\"web-security_gokart.md\":\"47e32892\",\"web-security_sql_inject_chinese_gbk.md\":\"0c8c1863\",\"rust_tokio_async_await 初探.md\":\"3230601c\",\"static_analysis_llvm_programmers_mannual.md\":\"1d1d1692\"}")
__VP_SITE_DATA__ = JSON.parse("{\"lang\":\"zh-CN\",\"dir\":\"ltr\",\"title\":\"Steven's Blog\",\"description\":\"steven's Blog\",\"base\":\"/\",\"head\":[],\"appearance\":true,\"themeConfig\":{\"repo\":\"nkbai/blog-vitepress\",\"docsDir\":\"docs\",\"docsBranch\":\"master\",\"logo\":\"logo.png\",\"editLinks\":false,\"editLinkText\":\"编辑本文\",\"lastUpdated\":\"上次更新\",\"nav\":[{\"i\":\"web安全相关\",\"l\":\"/web-security/\",\"date\":\"2022-02-03T09:57:03+08:00\",\"text\":\"web安全相关\",\"link\":\"/web-security/\"},{\"i\":\"block chain\",\"l\":\"/blockchain/\",\"date\":\"2022-01-08T01:19:42.000Z\",\"text\":\"block chain\",\"link\":\"/blockchain/\",\"children\":[{\"i\":\"libra\",\"l\":\"/blockchain/libra/\",\"date\":\"2022-01-08T01:19:42.000Z\",\"text\":\"libra\",\"link\":\"/blockchain/libra/\"},{\"i\":\"区块链核心技术\",\"l\":\"/blockchain/block_chain_core/\",\"date\":\"2019-06-16T11:57:03+08:00\",\"text\":\"区块链核心技术\",\"link\":\"/blockchain/block_chain_core/\"},{\"i\":\"btc wallet系列\",\"l\":\"/blockchain/btcwallet/\",\"date\":\"2019-05-23T01:07:52.193125+00:00\",\"text\":\"btc wallet系列\",\"link\":\"/blockchain/btcwallet/\"},{\"i\":\"以太坊\",\"l\":\"/blockchain/ethereum/\",\"date\":\"2019-04-25T09:39:46.982579+00:00\",\"text\":\"以太坊\",\"link\":\"/blockchain/ethereum/\"},{\"i\":\"btcd系列\",\"l\":\"/blockchain/btcd/\",\"date\":\"2018-11-11T10:40:47+00:00\",\"text\":\"btcd系列\",\"link\":\"/blockchain/btcd/\"}]},{\"i\":\"静态分析\",\"l\":\"/static_analysis/\",\"date\":\"2022-01-08T01:19:42.000Z\",\"text\":\"静态分析\",\"link\":\"/static_analysis/\"},{\"i\":\"泛app安全\",\"l\":\"/app_security/\",\"date\":\"2022-01-05T09:57:03+08:00\",\"text\":\"泛app安全\",\"link\":\"/app_security/\"},{\"i\":\"leetcode\",\"l\":\"/rust-leetcode/\",\"date\":\"2020-07-09T03:57:03+08:00\",\"text\":\"leetcode\",\"link\":\"/rust-leetcode/\"},{\"i\":\"rust\",\"l\":\"/rust/\",\"date\":\"2019-04-03T11:57:03+08:00\",\"text\":\"rust\",\"link\":\"/rust/\",\"children\":[{\"i\":\"从零实现消息中间件\",\"l\":\"/rust/rnats/\",\"date\":\"2019-01-30T11:57:03+08:00\",\"text\":\"从零实现消息中间件\",\"link\":\"/rust/rnats/\",\"children\":[{\"i\":\"rnats ppt\",\"l\":\"/rust/rnats/ppt/\",\"date\":\"2020-01-31T09:57:03+08:00\",\"text\":\"rnats ppt\",\"link\":\"/rust/rnats/ppt/\"}]}]},{\"i\":\"other\",\"l\":\"/other/\",\"date\":\"2018-11-20T04:15:04+00:00\",\"text\":\"other\",\"link\":\"/other/\"}],\"sidebar\":{\"/web-security/\":[{\"i\":\"gokart速读笔记\",\"date\":\"2022-07-10T09:57:03+08:00\",\"f\":1,\"text\":\"gokart速读笔记\",\"link\":\"/web-security/gokart.html\"},{\"i\":\"sql注入之GBK编码\",\"date\":\"2022-01-05T09:57:03+08:00\",\"f\":1,\"text\":\"sql注入之GBK编码\",\"link\":\"/web-security/sql_inject_chinese_gbk.html\"}],\"/blockchain/\":[{\"i\":\"libra\",\"l\":\"/blockchain/libra/\",\"date\":\"2022-01-08T01:19:42.000Z\",\"text\":\"libra\",\"link\":\"/blockchain/libra/\",\"children\":[{\"i\":\"9.libra中的vrf\",\"date\":\"2019-07-05T09:55:01+08:00\",\"f\":1,\"text\":\"9.libra中的vrf\",\"link\":\"/blockchain/libra/9.libria_vrf.html\"},{\"i\":\"8.libra的mempool模块解读-3\",\"date\":\"2019-07-04T11:00:34+08:00\",\"f\":1,\"text\":\"8.libra的mempool模块解读-3\",\"link\":\"/blockchain/libra/8.libria_mempool_3.html\"},{\"i\":\"7.libra的mempool模块解读-2\",\"date\":\"2019-07-03T11:00:34+08:00\",\"f\":1,\"text\":\"7.libra的mempool模块解读-2\",\"link\":\"/blockchain/libra/7.libra_mempool_2.html\"},{\"i\":\"6.libra的mempool模块解读-1\",\"date\":\"2019-07-02T11:00:34+08:00\",\"f\":1,\"text\":\"6.libra的mempool模块解读-1\",\"link\":\"/blockchain/libra/6.libria_mempool_1.html\"},{\"i\":\"5.libra的AC模块\",\"date\":\"2019-06-29T11:00:34+08:00\",\"f\":1,\"text\":\"5.libra的AC模块\",\"link\":\"/blockchain/libra/5.libra_ac.html\"},{\"i\":\"4.打通client与libradb模块的任督二脉\",\"date\":\"2019-06-25T11:00:34+08:00\",\"f\":1,\"text\":\"4.打通client与libradb模块的任督二脉\",\"link\":\"/blockchain/libra/4.client_command_and_libriadb.html\"},{\"i\":\"3.Libra中数据存储的Schema\",\"date\":\"2019-06-24T11:00:34+08:00\",\"f\":1,\"text\":\"3.Libra中数据存储的Schema\",\"link\":\"/blockchain/libra/3.Libra_Schema.html\"},{\"i\":\"2.在Libra中学习Protobuf\",\"date\":\"2019-06-23T11:00:34+08:00\",\"f\":1,\"text\":\"2.在Libra中学习Protobuf\",\"link\":\"/blockchain/libra/2.Protobuf_in_libria.html\"},{\"i\":\"1.Libra入门教程-一分钟上手Libra\",\"date\":\"2019-06-16T11:57:03+08:00\",\"f\":1,\"text\":\"1.Libra入门教程-一分钟上手Libra\",\"link\":\"/blockchain/libra/1.start_in_one_minute.html\"}]},{\"i\":\"区块链核心技术\",\"l\":\"/blockchain/block_chain_core/\",\"date\":\"2019-06-16T11:57:03+08:00\",\"text\":\"区块链核心技术\",\"link\":\"/blockchain/block_chain_core/\",\"children\":[{\"i\":\"ECC签名中随机数不随机的危害\",\"date\":\"2020-09-03T08:57:03+08:00\",\"f\":1,\"text\":\"ECC签名中随机数不随机的危害\",\"link\":\"/blockchain/block_chain_core/ecc_signature_random.html\"},{\"i\":\"一篇文章搞懂VRF\",\"date\":\"2019-06-16T11:57:03+08:00\",\"f\":1,\"text\":\"一篇文章搞懂VRF\",\"link\":\"/blockchain/block_chain_core/vrf.html\"}]},{\"i\":\"btc wallet系列\",\"l\":\"/blockchain/btcwallet/\",\"date\":\"2019-05-23T01:07:52.193125+00:00\",\"text\":\"btc wallet系列\",\"link\":\"/blockchain/btcwallet/\",\"children\":[{\"i\":\"wallet模块\",\"date\":\"2019-05-23T01:07:52.193125+00:00\",\"f\":1,\"text\":\"wallet模块\",\"link\":\"/blockchain/btcwallet/wallet模块.html\"},{\"i\":\"chain模块\",\"date\":\"2019-05-20T09:31:26.622780+00:00\",\"f\":1,\"text\":\"chain模块\",\"link\":\"/blockchain/btcwallet/chain模块.html\"},{\"i\":\"hdwallet-bip0032\",\"date\":\"2019-05-20T08:33:25.957776+00:00\",\"f\":1,\"text\":\"hdwallet-bip0032\",\"link\":\"/blockchain/btcwallet/hdwallet-bip0032.html\"},{\"i\":\"wtxmgr模块\",\"date\":\"2019-05-20T03:44:14.946920+00:00\",\"f\":1,\"text\":\"wtxmgr模块\",\"link\":\"/blockchain/btcwallet/wtxmgr模块.html\"},{\"i\":\"wallet中的数据库设计\",\"date\":\"2019-05-19T13:32:33.874224+00:00\",\"f\":1,\"text\":\"wallet中的数据库设计\",\"link\":\"/blockchain/btcwallet/wallet中的数据库设计.html\"},{\"i\":\"拓扑排序在比特币Tx管理中的使用\",\"date\":\"2019-05-19T10:19:16.778288+00:00\",\"f\":1,\"text\":\"拓扑排序在比特币Tx管理中的使用\",\"link\":\"/blockchain/btcwallet/拓扑排序在比特币Tx管理中的使用.html\"},{\"i\":\"btcWallet系列之一-grpc模块\",\"date\":\"2019-05-19T01:46:15.071002+00:00\",\"f\":1,\"text\":\"btcWallet系列之一-grpc模块\",\"link\":\"/blockchain/btcwallet/btcWallet系列之一-grpc模块.html\"},{\"i\":\"waddrmgr模块\",\"date\":\"2019-05-18T13:57:08.732484+00:00\",\"f\":1,\"text\":\"waddrmgr模块\",\"link\":\"/blockchain/btcwallet/waddrmgr模块.html\"},{\"i\":\"walletdb\",\"date\":\"2019-05-16T07:04:54.904453+00:00\",\"f\":1,\"text\":\"walletdb\",\"link\":\"/blockchain/btcwallet/walletdb.html\"},{\"i\":\"snacl\",\"date\":\"2019-05-15T14:52:36.337642+00:00\",\"f\":1,\"text\":\"snacl\",\"link\":\"/blockchain/btcwallet/snacl.html\"},{\"i\":\"readme\",\"date\":\"2019-05-15T03:36:47.708470+00:00\",\"f\":1,\"text\":\"readme\",\"link\":\"/blockchain/btcwallet/readme.html\"}]},{\"i\":\"以太坊\",\"l\":\"/blockchain/ethereum/\",\"date\":\"2019-04-25T09:39:46.982579+00:00\",\"text\":\"以太坊\",\"link\":\"/blockchain/ethereum/\",\"children\":[{\"i\":\"并发和并行的区别\",\"date\":\"2019-05-26T00:02:51.864476+00:00\",\"f\":1,\"text\":\"并发和并行的区别\",\"link\":\"/blockchain/ethereum/并发和并行的区别.html\"},{\"i\":\"以太坊evm笔记\",\"date\":\"2019-04-26T06:58:56.834075+00:00\",\"f\":1,\"text\":\"以太坊evm笔记\",\"link\":\"/blockchain/ethereum/以太坊evm笔记.html\"},{\"i\":\"合约注意事项\",\"date\":\"2019-04-25T09:39:46.982579+00:00\",\"f\":1,\"text\":\"合约注意事项\",\"link\":\"/blockchain/ethereum/合约注意事项.html\"},{\"i\":\"btc跨链设计\",\"date\":\"2019-04-15T04:08:31.082275+00:00\",\"f\":1,\"text\":\"btc跨链设计\",\"link\":\"/blockchain/ethereum/btc跨链设计.html\"},{\"i\":\"安全总结\",\"date\":\"2019-03-05T05:05:12.827962+00:00\",\"f\":1,\"text\":\"安全总结\",\"link\":\"/blockchain/ethereum/安全总结.html\"},{\"i\":\"比特币的TxHash为什么会发生改变\",\"date\":\"2019-02-11T09:26:27.497615+00:00\",\"f\":1,\"text\":\"比特币的TxHash为什么会发生改变\",\"link\":\"/blockchain/ethereum/比特币的TxHash为什么会发生改变.html\"},{\"i\":\"how_to_create_channel\",\"date\":\"2019-01-22T01:49:06+00:00\",\"f\":1,\"text\":\"how_to_create_channel\",\"link\":\"/blockchain/ethereum/how_to_create_channel.html\"},{\"i\":\"君士坦丁堡分叉引起的安全问题\",\"date\":\"2019-01-18T14:42:10+00:00\",\"f\":1,\"text\":\"君士坦丁堡分叉引起的安全问题\",\"link\":\"/blockchain/ethereum/君士坦丁堡分叉引起的安全问题.html\"},{\"i\":\"区块链问题笔记\",\"date\":\"2018-12-01T10:37:18+00:00\",\"f\":1,\"text\":\"区块链问题笔记\",\"link\":\"/blockchain/ethereum/区块链问题笔记.html\"},{\"i\":\"从一次盗币事件再谈合约安全问题\",\"date\":\"2018-11-15T08:55:51+00:00\",\"f\":1,\"text\":\"从一次盗币事件再谈合约安全问题\",\"link\":\"/blockchain/ethereum/从一次盗币事件再谈合约安全问题.html\"},{\"i\":\"让photon支持go module\",\"date\":\"2018-11-07T12:35:46+00:00\",\"f\":1,\"text\":\"让photon支持go module\",\"link\":\"/blockchain/ethereum/让photon支持go module.html\"},{\"i\":\"meshbox配置 OpenWrt\",\"date\":\"2018-11-06T07:03:18+00:00\",\"f\":1,\"text\":\"meshbox配置 OpenWrt\",\"link\":\"/blockchain/ethereum/meshbox配置 OpenWrt.html\"},{\"i\":\"synapse代码阅读\",\"date\":\"2018-10-22T13:09:09+00:00\",\"f\":1,\"text\":\"synapse代码阅读\",\"link\":\"/blockchain/ethereum/synapse代码阅读.html\"},{\"i\":\"golang_plugin\",\"date\":\"2018-10-14T05:05:37+00:00\",\"f\":1,\"text\":\"golang_plugin\",\"link\":\"/blockchain/ethereum/golang_plugin.html\"},{\"i\":\"多链工作问题\",\"date\":\"2018-10-14T03:08:50+00:00\",\"f\":1,\"text\":\"多链工作问题\",\"link\":\"/blockchain/ethereum/多链工作问题.html\"},{\"i\":\"我对 smartplasma 的理解\",\"date\":\"2018-09-19T06:08:37+00:00\",\"f\":1,\"text\":\"我对 smartplasma 的理解\",\"link\":\"/blockchain/ethereum/我对 smartplasma 的理解.html\"},{\"i\":\"CrossChainAtomicExchange\",\"date\":\"2018-09-14T03:02:02+00:00\",\"f\":1,\"text\":\"CrossChainAtomicExchange\",\"link\":\"/blockchain/ethereum/CrossChainAtomicExchange.html\"},{\"i\":\"如何为 smartraiden 贡献代码\",\"date\":\"2018-09-13T00:45:47+00:00\",\"f\":1,\"text\":\"如何为 smartraiden 贡献代码\",\"link\":\"/blockchain/ethereum/如何为 smartraiden 贡献代码.html\"},{\"i\":\"闪电网络\",\"date\":\"2018-09-12T06:16:20+00:00\",\"f\":1,\"text\":\"闪电网络\",\"link\":\"/blockchain/ethereum/闪电网络.html\"},{\"i\":\"如何使用 smartraiden 以及 lnd 进行跨链原子资产交换\",\"date\":\"2018-08-30T13:01:43+00:00\",\"f\":1,\"text\":\"如何使用 smartraiden 以及 lnd 进行跨链原子资产交换\",\"link\":\"/blockchain/ethereum/如何使用 smartraiden 以及 lnd 进行跨链原子资产交换.html\"},{\"i\":\"raiden_graph\",\"date\":\"2018-08-27T02:48:47+00:00\",\"f\":1,\"text\":\"raiden_graph\",\"link\":\"/blockchain/ethereum/raiden_graph.html\"},{\"i\":\"区块链计时器\",\"date\":\"2018-08-27T02:48:47+00:00\",\"f\":1,\"text\":\"区块链计时器\",\"link\":\"/blockchain/ethereum/区块链计时器.html\"},{\"i\":\"如何使用 dlv 调试 smartraiden\",\"date\":\"2018-08-27T02:48:47+00:00\",\"f\":1,\"text\":\"如何使用 dlv 调试 smartraiden\",\"link\":\"/blockchain/ethereum/如何使用 dlv 调试 smartraiden.html\"},{\"i\":\"异常退出各种情况\",\"date\":\"2018-08-27T02:48:47+00:00\",\"f\":1,\"text\":\"异常退出各种情况\",\"link\":\"/blockchain/ethereum/异常退出各种情况.html\"},{\"i\":\"闪电网络交易密钥\",\"date\":\"2018-08-25T04:21:13+00:00\",\"f\":1,\"text\":\"闪电网络交易密钥\",\"link\":\"/blockchain/ethereum/闪电网络交易密钥.html\"},{\"i\":\"solidity_mapping_implementation\",\"date\":\"2018-08-18T06:02:04+00:00\",\"f\":1,\"text\":\"solidity_mapping_implementation\",\"link\":\"/blockchain/ethereum/solidity_mapping_implementation.html\"},{\"i\":\" 将以太坊封装为 ERC20 TOKEN\",\"date\":\"2018-05-02T11:06:23+08:00\",\"f\":1,\"text\":\" 将以太坊封装为 ERC20 TOKEN\",\"link\":\"/blockchain/ethereum/ethereum_erc20_wrapper.html\"},{\"i\":\"golang Subprocess tests\",\"date\":\"2018-04-30T11:06:23+08:00\",\"f\":1,\"text\":\"golang Subprocess tests\",\"link\":\"/blockchain/ethereum/golang subprocess tests.html\"},{\"i\":\"如何使用 Channel\",\"date\":\"2018-04-27T11:06:23+08:00\",\"f\":1,\"text\":\"如何使用 Channel\",\"link\":\"/blockchain/ethereum/how_to_use_channel.html\"},{\"i\":\"TheDao 简化版解释\",\"date\":\"2018-04-25T11:06:23+08:00\",\"f\":1,\"text\":\"TheDao 简化版解释\",\"link\":\"/blockchain/ethereum/thedao.html\"}]},{\"i\":\"btcd系列\",\"l\":\"/blockchain/btcd/\",\"date\":\"2018-11-11T10:40:47+00:00\",\"text\":\"btcd系列\",\"link\":\"/blockchain/btcd/\",\"children\":[{\"i\":\"隔离见证\",\"date\":\"2019-05-23T01:01:56.214754+00:00\",\"f\":1,\"text\":\"隔离见证\",\"link\":\"/blockchain/btcd/隔离见证.html\"},{\"i\":\"比特币的地址类型\",\"date\":\"2019-05-22T23:47:24.337957+00:00\",\"f\":1,\"text\":\"比特币的地址类型\",\"link\":\"/blockchain/btcd/比特币的地址类型.html\"},{\"i\":\"indexer模块\",\"date\":\"2019-04-18T03:46:43.173088+00:00\",\"f\":1,\"text\":\"indexer模块\",\"link\":\"/blockchain/btcd/indexer模块.html\"},{\"i\":\"btcjson\",\"date\":\"2018-12-26T03:19:02+00:00\",\"f\":1,\"text\":\"btcjson\",\"link\":\"/blockchain/btcd/btcjson.html\"},{\"i\":\"mempool\",\"date\":\"2018-12-21T03:53:45+00:00\",\"f\":1,\"text\":\"mempool\",\"link\":\"/blockchain/btcd/mempool.html\"},{\"i\":\"peer\",\"date\":\"2018-11-30T04:24:21+00:00\",\"f\":1,\"text\":\"peer\",\"link\":\"/blockchain/btcd/peer.html\"},{\"i\":\"database\",\"date\":\"2018-11-30T03:54:04+00:00\",\"f\":1,\"text\":\"database\",\"link\":\"/blockchain/btcd/database.html\"},{\"i\":\"rpcclient\",\"date\":\"2018-11-29T03:57:26+00:00\",\"f\":1,\"text\":\"rpcclient\",\"link\":\"/blockchain/btcd/rpcclient.html\"},{\"i\":\"mining\",\"date\":\"2018-11-26T02:01:09+00:00\",\"f\":1,\"text\":\"mining\",\"link\":\"/blockchain/btcd/mining.html\"},{\"i\":\"mruMap\",\"date\":\"2018-11-21T06:21:40+00:00\",\"f\":1,\"text\":\"mruMap\",\"link\":\"/blockchain/btcd/mruMap.html\"},{\"i\":\"bitcoin script\",\"date\":\"2018-11-21T06:12:53+00:00\",\"f\":1,\"text\":\"bitcoin script\",\"link\":\"/blockchain/btcd/bitcoin script.html\"},{\"i\":\"比特币解锁脚本中的ScriptSignature都包含了什么东西\",\"date\":\"2018-11-13T10:46:41+00:00\",\"f\":1,\"text\":\"比特币解锁脚本中的ScriptSignature都包含了什么东西\",\"link\":\"/blockchain/btcd/比特币解锁脚本中的ScriptSignature都包含了什么东西.html\"},{\"i\":\"wire_common\",\"date\":\"2018-11-12T11:07:31+00:00\",\"f\":1,\"text\":\"wire_common\",\"link\":\"/blockchain/btcd/wire_common.html\"},{\"i\":\"bloom\",\"date\":\"2018-11-11T10:40:47+00:00\",\"f\":1,\"text\":\"bloom\",\"link\":\"/blockchain/btcd/bloom.html\"},{\"i\":\"比特币指令集说明\",\"date\":\"2018-08-23T01:33:10+00:00\",\"f\":1,\"text\":\"比特币指令集说明\",\"link\":\"/blockchain/btcd/比特币指令集说明.html\"},{\"i\":\"一个比特币脚本示例\",\"date\":\"2018-08-18T06:02:04+00:00\",\"f\":1,\"text\":\"一个比特币脚本示例\",\"link\":\"/blockchain/btcd/一个比特币脚本示例.html\"}]}],\"/static_analysis/\":[{\"i\":\"using clang-tidy for customized checkers\",\"date\":\"2023-04-14T11:57:03+08:00\",\"f\":1,\"text\":\"using clang-tidy for customized checkers\",\"link\":\"/static_analysis/using_clang_tidy_for_custom_checkers.html\"},{\"i\":\"llvm clang ast\",\"date\":\"2023-04-08T11:57:03+08:00\",\"f\":1,\"text\":\"llvm clang ast\",\"link\":\"/static_analysis/clang_ast.html\"},{\"i\":\"llvm 二次开发基础知识\",\"date\":\"2023-03-23T11:57:03+08:00\",\"f\":1,\"text\":\"llvm 二次开发基础知识\",\"link\":\"/static_analysis/llvm_programmers_mannual.html\"},{\"i\":\"llvm overview\",\"date\":\"2023-03-17T11:57:03+08:00\",\"f\":1,\"text\":\"llvm overview\",\"link\":\"/static_analysis/llvm_overview.html\"},{\"i\":\"mariana安卓静态分析工具简介\",\"date\":\"2021-11-14T11:57:03+08:00\",\"f\":1,\"text\":\"mariana安卓静态分析工具简介\",\"link\":\"/static_analysis/mariana-introduction.html\"}],\"/app_security/\":[{\"i\":\"小程序通用越权漏洞分析\",\"date\":\"2022-08-21T21:57:03+08:00\",\"f\":1,\"text\":\"小程序通用越权漏洞分析\",\"link\":\"/app_security/Identity_Confusion_in_WebView-based_Mobile_App-in-app_Ecosystems.html\"},{\"i\":\"白盒密码学简介\",\"date\":\"2022-07-28T08:57:03+08:00\",\"f\":1,\"text\":\"白盒密码学简介\",\"link\":\"/app_security/white_box_cryptography.html\"},{\"i\":\"如何在Mac中Hook:改造Rest以适应工作需求\",\"date\":\"2022-02-16T21:57:03+08:00\",\"f\":1,\"text\":\"如何在Mac中Hook:改造Rest以适应工作需求\",\"link\":\"/app_security/hook_rest_for_work.html\"},{\"i\":\"B站持久任意代码执行漏洞\",\"date\":\"2022-01-20T21:57:03+08:00\",\"f\":1,\"text\":\"B站持久任意代码执行漏洞\",\"link\":\"/app_security/bilibili_arbitrary_code_execution.html\"},{\"i\":\"移动App加密的三条军规\",\"date\":\"2022-01-17T21:57:03+08:00\",\"f\":1,\"text\":\"移动App加密的三条军规\",\"link\":\"/app_security/use_cryptography_in_mobile_appls_the_right_way.html\"},{\"i\":\"另一个Tiktok持久任意代码执行漏洞\",\"date\":\"2022-01-16T09:57:03+08:00\",\"f\":1,\"text\":\"另一个Tiktok持久任意代码执行漏洞\",\"link\":\"/app_security/tiktok_arbitrary_code_execution_download_service.html\"},{\"i\":\"Tiktok持久任意代码执行漏洞\",\"date\":\"2022-01-14T21:57:03+08:00\",\"f\":1,\"text\":\"Tiktok持久任意代码执行漏洞\",\"link\":\"/app_security/tiktok_arbitrary_code_execution.html\"},{\"i\":\"Tiktok存在任意文件读取问题\",\"date\":\"2022-01-13T21:57:03+08:00\",\"f\":1,\"text\":\"Tiktok存在任意文件读取问题\",\"link\":\"/app_security/tiktok_theft_of_arbitrary.html\"},{\"i\":\"如何保护导出组件\",\"date\":\"2022-01-11T21:57:03+08:00\",\"f\":1,\"text\":\"如何保护导出组件\",\"link\":\"/app_security/android_howto_protected_unexported_components.html\"},{\"i\":\"为什么要保护未导出组件\",\"date\":\"2022-01-06T21:57:03+08:00\",\"f\":1,\"text\":\"为什么要保护未导出组件\",\"link\":\"/app_security/android_access_protected_components.html\"},{\"i\":\"android第三方包上下文任意代码执行\",\"date\":\"2022-01-05T21:57:03+08:00\",\"f\":1,\"text\":\"android第三方包上下文任意代码执行\",\"link\":\"/app_security/android_lce_third_party.html\"}],\"/rust-leetcode/\":[{\"i\":\"面试题 17.13. 恢复空格\",\"date\":\"2020-07-09T03:57:03+08:00\",\"f\":1,\"text\":\"面试题 17.13. 恢复空格\",\"link\":\"/rust-leetcode/2020-07-09.html\"},{\"i\":\"1353. 最多可以参加的会议数目\",\"date\":\"2020-03-31T03:57:03+08:00\",\"f\":1,\"text\":\"1353. 最多可以参加的会议数目\",\"link\":\"/rust-leetcode/2020-03-31.html\"},{\"i\":\"307. 区域和检索 - 数组可修改\",\"date\":\"2020-03-30T03:57:03+08:00\",\"f\":1,\"text\":\"307. 区域和检索 - 数组可修改\",\"link\":\"/rust-leetcode/2020-03-30.html\"},{\"i\":\"205. 同构字符串\",\"date\":\"2020-03-27T03:57:03+08:00\",\"f\":1,\"text\":\"205. 同构字符串\",\"link\":\"/rust-leetcode/2020-03-27.html\"},{\"i\":\"70. 爬楼梯\",\"date\":\"2020-03-26T03:57:03+08:00\",\"f\":1,\"text\":\"70. 爬楼梯\",\"link\":\"/rust-leetcode/2020-03-26.html\"},{\"i\":\"299. 猜数字游戏\",\"date\":\"2020-03-25T03:57:03+08:00\",\"f\":1,\"text\":\"299. 猜数字游戏\",\"link\":\"/rust-leetcode/2020-03-25.html\"},{\"i\":\"219. 存在重复元素 II\",\"date\":\"2020-03-24T03:57:03+08:00\",\"f\":1,\"text\":\"219. 存在重复元素 II\",\"link\":\"/rust-leetcode/2020-03-24.html\"},{\"i\":\"202. 快乐数\",\"date\":\"2020-03-23T03:57:03+08:00\",\"f\":1,\"text\":\"202. 快乐数\",\"link\":\"/rust-leetcode/2020-03-23.html\"},{\"i\":\"面试题 17.07. 婴儿名字\",\"date\":\"2020-03-20T03:57:03+08:00\",\"f\":1,\"text\":\"面试题 17.07. 婴儿名字\",\"link\":\"/rust-leetcode/2020-03-20.html\"},{\"i\":\"959. 由斜杠划分区域\",\"date\":\"2020-03-19T03:57:03+08:00\",\"f\":1,\"text\":\"959. 由斜杠划分区域\",\"link\":\"/rust-leetcode/2020-03-19.html\"},{\"i\":\"1202. 交换字符串中的元素\",\"date\":\"2020-03-18T03:57:03+08:00\",\"f\":1,\"text\":\"1202. 交换字符串中的元素\",\"link\":\"/rust-leetcode/2020-03-18.html\"},{\"i\":\"990. 等式方程的可满足性\",\"date\":\"2020-03-17T03:57:03+08:00\",\"f\":1,\"text\":\"990. 等式方程的可满足性\",\"link\":\"/rust-leetcode/2020-03-17.html\"},{\"i\":\"952. 按公因数计算最大组件大小\",\"date\":\"2020-03-16T03:57:03+08:00\",\"f\":1,\"text\":\"952. 按公因数计算最大组件大小\",\"link\":\"/rust-leetcode/2020-03-16.html\"},{\"i\":\"1319. 连通网络的操作次数\",\"date\":\"2020-03-13T03:57:03+08:00\",\"f\":1,\"text\":\"1319. 连通网络的操作次数\",\"link\":\"/rust-leetcode/2020-03-13.html\"},{\"i\":\"721. 账户合并\",\"date\":\"2020-03-12T03:57:03+08:00\",\"f\":1,\"text\":\"721. 账户合并\",\"link\":\"/rust-leetcode/2020-03-12.html\"},{\"i\":\"399. 除法求值-2\",\"date\":\"2020-03-11T03:57:03+08:00\",\"f\":1,\"text\":\"399. 除法求值-2\",\"link\":\"/rust-leetcode/2020-03-11.html\"},{\"i\":\"399. 除法求值\",\"date\":\"2020-03-10T03:57:03+08:00\",\"f\":1,\"text\":\"399. 除法求值\",\"link\":\"/rust-leetcode/2020-03-10.html\"},{\"i\":\"547. 朋友圈\",\"date\":\"2020-03-09T03:57:03+08:00\",\"f\":1,\"text\":\"547. 朋友圈\",\"link\":\"/rust-leetcode/2020-03-09.html\"},{\"i\":\"1297. 子串的最大出现次数-2\",\"date\":\"2020-03-06T03:57:03+08:00\",\"f\":1,\"text\":\"1297. 子串的最大出现次数-2\",\"link\":\"/rust-leetcode/2020-03-06.html\"},{\"i\":\"1297. 子串的最大出现次数\",\"date\":\"2020-03-05T03:57:03+08:00\",\"f\":1,\"text\":\"1297. 子串的最大出现次数\",\"link\":\"/rust-leetcode/2020-03-05.html\"},{\"i\":\"1143. 最长公共子序列\",\"date\":\"2020-03-04T03:57:03+08:00\",\"f\":1,\"text\":\"1143. 最长公共子序列\",\"link\":\"/rust-leetcode/2020-03-04.html\"},{\"i\":\"684. 冗余连接\",\"date\":\"2020-03-03T03:57:03+08:00\",\"f\":1,\"text\":\"684. 冗余连接\",\"link\":\"/rust-leetcode/2020-03-03.html\"},{\"i\":\"210. 课程表2\",\"date\":\"2020-03-02T03:57:03+08:00\",\"f\":1,\"text\":\"210. 课程表2\",\"link\":\"/rust-leetcode/2020-03-02.html\"},{\"i\":\"207. 课程表\",\"date\":\"2020-02-28T03:57:03+08:00\",\"f\":1,\"text\":\"207. 课程表\",\"link\":\"/rust-leetcode/2020-02-28.html\"},{\"i\":\"80. 删除排序数组中的重复项 II\",\"date\":\"2020-02-27T03:57:03+08:00\",\"f\":1,\"text\":\"80. 删除排序数组中的重复项 II\",\"link\":\"/rust-leetcode/2020-02-27.html\"},{\"i\":\"287. 寻找重复数\",\"date\":\"2020-02-26T03:57:03+08:00\",\"f\":1,\"text\":\"287. 寻找重复数\",\"link\":\"/rust-leetcode/2020-02-26.html\"},{\"i\":\"897. 递增顺序查找树\",\"date\":\"2020-02-25T03:57:03+08:00\",\"f\":1,\"text\":\"897. 递增顺序查找树\",\"link\":\"/rust-leetcode/2020-02-25.html\"},{\"i\":\"97. 交错字符串-2\",\"date\":\"2020-02-24T03:57:03+08:00\",\"f\":1,\"text\":\"97. 交错字符串-2\",\"link\":\"/rust-leetcode/2020-02-24.html\"},{\"i\":\"97. 交错字符串\",\"date\":\"2020-02-21T03:57:03+08:00\",\"f\":1,\"text\":\"97. 交错字符串\",\"link\":\"/rust-leetcode/2020-02-21.html\"},{\"i\":\"39. 组合总和\",\"date\":\"2020-02-20T03:57:03+08:00\",\"f\":1,\"text\":\"39. 组合总和\",\"link\":\"/rust-leetcode/2020-02-20.html\"},{\"i\":\"128. 最长连续序列\",\"date\":\"2020-02-19T03:57:03+08:00\",\"f\":1,\"text\":\"128. 最长连续序列\",\"link\":\"/rust-leetcode/2020-02-19.html\"},{\"i\":\"365. 水壶问题\",\"date\":\"2020-02-18T03:57:03+08:00\",\"f\":1,\"text\":\"365. 水壶问题\",\"link\":\"/rust-leetcode/2020-02-18.html\"},{\"i\":\"365. 水壶问题\",\"date\":\"2020-02-17T03:57:03+08:00\",\"f\":1,\"text\":\"365. 水壶问题\",\"link\":\"/rust-leetcode/2020-02-17.html\"},{\"i\":\"22. 括号生成\",\"date\":\"2020-02-14T03:57:03+08:00\",\"f\":1,\"text\":\"22. 括号生成\",\"link\":\"/rust-leetcode/2020-02-14.html\"},{\"i\":\"494. 目标和\",\"date\":\"2020-02-13T03:57:03+08:00\",\"f\":1,\"text\":\"494. 目标和\",\"link\":\"/rust-leetcode/2020-02-13.html\"},{\"i\":\"209. 长度最小的子数组\",\"date\":\"2020-02-12T03:57:03+08:00\",\"f\":1,\"text\":\"209. 长度最小的子数组\",\"link\":\"/rust-leetcode/2020-02-12.html\"},{\"i\":\"673. 最长递增子序列的个数\",\"date\":\"2020-02-11T03:57:03+08:00\",\"f\":1,\"text\":\"673. 最长递增子序列的个数\",\"link\":\"/rust-leetcode/2020-02-11.html\"},{\"i\":\"134. 加油站\",\"date\":\"2020-02-10T03:57:03+08:00\",\"f\":1,\"text\":\"134. 加油站\",\"link\":\"/rust-leetcode/2020-02-10.html\"},{\"i\":\"55. 跳跃游戏\",\"date\":\"2020-02-07T03:57:03+08:00\",\"f\":1,\"text\":\"55. 跳跃游戏\",\"link\":\"/rust-leetcode/2020-02-07.html\"},{\"i\":\"130. 被围绕的区域\",\"date\":\"2020-02-06T03:57:03+08:00\",\"f\":1,\"text\":\"130. 被围绕的区域\",\"link\":\"/rust-leetcode/2020-02-06.html\"},{\"i\":\"386. 字典序排数\",\"date\":\"2020-02-05T03:57:03+08:00\",\"f\":1,\"text\":\"386. 字典序排数\",\"link\":\"/rust-leetcode/2020-02-05.html\"},{\"i\":\"343. 整数拆分\",\"date\":\"2020-02-04T03:57:03+08:00\",\"f\":1,\"text\":\"343. 整数拆分\",\"link\":\"/rust-leetcode/2020-02-04.html\"},{\"i\":\"55. 跳跃游戏-2\",\"date\":\"2020-02-03T03:57:03+08:00\",\"f\":1,\"text\":\"55. 跳跃游戏-2\",\"link\":\"/rust-leetcode/2020-02-03.html\"},{\"i\":\"714. 买卖股票的最佳时机含手续费\",\"date\":\"2020-01-24T03:57:03+08:00\",\"f\":1,\"text\":\"714. 买卖股票的最佳时机含手续费\",\"link\":\"/rust-leetcode/2020-01-24.html\"},{\"i\":\"309. 最佳买卖股票时机含冷冻期\",\"date\":\"2020-01-23T03:57:03+08:00\",\"f\":1,\"text\":\"309. 最佳买卖股票时机含冷冻期\",\"link\":\"/rust-leetcode/2020-01-23.html\"},{\"i\":\"123. 买卖股票的最佳时机 III\",\"date\":\"2020-01-22T03:57:03+08:00\",\"f\":1,\"text\":\"123. 买卖股票的最佳时机 III\",\"link\":\"/rust-leetcode/2020-01-22.html\"},{\"i\":\"188. 买卖股票的最佳时机 IV-3\",\"date\":\"2020-01-21T03:57:03+08:00\",\"f\":1,\"text\":\"188. 买卖股票的最佳时机 IV-3\",\"link\":\"/rust-leetcode/2020-01-21.html\"},{\"i\":\"188. 买卖股票的最佳时机 IV-2\",\"date\":\"2020-01-20T03:57:03+08:00\",\"f\":1,\"text\":\"188. 买卖股票的最佳时机 IV-2\",\"link\":\"/rust-leetcode/2020-01-20.html\"},{\"i\":\"188. 买卖股票的最佳时机 IV\",\"date\":\"2020-01-17T03:57:03+08:00\",\"f\":1,\"text\":\"188. 买卖股票的最佳时机 IV\",\"link\":\"/rust-leetcode/2020-01-17.html\"},{\"i\":\"122. 买卖股票的最佳时机 II-2\",\"date\":\"2020-01-16T03:57:03+08:00\",\"f\":1,\"text\":\"122. 买卖股票的最佳时机 II-2\",\"link\":\"/rust-leetcode/2020-01-16.html\"},{\"i\":\"122. 买卖股票的最佳时机 II\",\"date\":\"2020-01-15T03:57:03+08:00\",\"f\":1,\"text\":\"122. 买卖股票的最佳时机 II\",\"link\":\"/rust-leetcode/2020-01-15.html\"},{\"i\":\"687. 最长同值路径\",\"date\":\"2020-01-14T03:57:03+08:00\",\"f\":1,\"text\":\"687. 最长同值路径\",\"link\":\"/rust-leetcode/2020-01-14.html\"},{\"i\":\"523. 连续的子数组和\",\"date\":\"2020-01-13T03:57:03+08:00\",\"f\":1,\"text\":\"523. 连续的子数组和\",\"link\":\"/rust-leetcode/2020-01-13.html\"},{\"i\":\"488. 祖玛游戏\",\"date\":\"2020-01-10T03:57:03+08:00\",\"f\":1,\"text\":\"488. 祖玛游戏\",\"link\":\"/rust-leetcode/2020-01-10.html\"},{\"i\":\"476. 数字的补数\",\"date\":\"2020-01-09T03:57:03+08:00\",\"f\":1,\"text\":\"476. 数字的补数\",\"link\":\"/rust-leetcode/2020-01-09.html\"},{\"i\":\"200. 岛屿数量\",\"date\":\"2020-01-08T03:57:03+08:00\",\"f\":1,\"text\":\"200. 岛屿数量\",\"link\":\"/rust-leetcode/2020-01-08.html\"},{\"i\":\"200. 岛屿数量\",\"date\":\"2020-01-07T03:57:03+08:00\",\"f\":1,\"text\":\"200. 岛屿数量\",\"link\":\"/rust-leetcode/2020-01-07.html\"},{\"i\":\"78. 子集\",\"date\":\"2020-01-06T03:57:03+08:00\",\"f\":1,\"text\":\"78. 子集\",\"link\":\"/rust-leetcode/2020-01-06.html\"},{\"i\":\"452. 用最少数量的箭引爆气球\",\"date\":\"2020-01-03T03:57:03+08:00\",\"f\":1,\"text\":\"452. 用最少数量的箭引爆气球\",\"link\":\"/rust-leetcode/2020-01-03.html\"},{\"i\":\"135. 分发糖果\",\"date\":\"2020-01-02T03:57:03+08:00\",\"f\":1,\"text\":\"135. 分发糖果\",\"link\":\"/rust-leetcode/2020-01-02.html\"},{\"i\":\"143. 重排链表\",\"date\":\"2020-01-01T03:57:03+08:00\",\"f\":1,\"text\":\"143. 重排链表\",\"link\":\"/rust-leetcode/2020-01-01.html\"},{\"i\":\"79. 单词搜索\",\"date\":\"2019-12-30T03:57:03+08:00\",\"f\":1,\"text\":\"79. 单词搜索\",\"link\":\"/rust-leetcode/2019-12-30.html\"},{\"i\":\"31. 下一个排列\",\"date\":\"2019-12-30T03:57:03+08:00\",\"f\":1,\"text\":\"31. 下一个排列\",\"link\":\"/rust-leetcode/2019-12-31.html\"},{\"i\":\"42. 接雨水-2\",\"date\":\"2019-12-27T03:57:03+08:00\",\"f\":1,\"text\":\"42. 接雨水-2\",\"link\":\"/rust-leetcode/2019-12-27.html\"},{\"i\":\"42. 接雨水\",\"date\":\"2019-12-26T03:57:03+08:00\",\"f\":1,\"text\":\"42. 接雨水\",\"link\":\"/rust-leetcode/2019-12-26.html\"},{\"i\":\"215. 数组中的第K个最大元素\",\"date\":\"2019-12-25T03:57:03+08:00\",\"f\":1,\"text\":\"215. 数组中的第K个最大元素\",\"link\":\"/rust-leetcode/2019-12-25.html\"},{\"i\":\"288. 单词的唯一缩写\",\"date\":\"2019-12-24T03:57:03+08:00\",\"f\":1,\"text\":\"288. 单词的唯一缩写\",\"link\":\"/rust-leetcode/2019-12-24.html\"},{\"i\":\"53. 最大子序和\",\"date\":\"2019-12-23T03:57:03+08:00\",\"f\":1,\"text\":\"53. 最大子序和\",\"link\":\"/rust-leetcode/2019-12-23.html\"},{\"i\":\"84. 柱状图中最大的矩形-2\",\"date\":\"2019-12-20T03:57:03+08:00\",\"f\":1,\"text\":\"84. 柱状图中最大的矩形-2\",\"link\":\"/rust-leetcode/2019-12-20.html\"},{\"i\":\"1052. 爱生气的书店老板\",\"date\":\"2019-12-19T03:57:03+08:00\",\"f\":1,\"text\":\"1052. 爱生气的书店老板\",\"link\":\"/rust-leetcode/2019-12-19.html\"},{\"i\":\"51. N皇后\",\"date\":\"2019-12-18T03:57:03+08:00\",\"f\":1,\"text\":\"51. N皇后\",\"link\":\"/rust-leetcode/2019-12-18.html\"},{\"i\":\"121. 买卖股票的最佳时机\",\"date\":\"2019-12-17T03:57:03+08:00\",\"f\":1,\"text\":\"121. 买卖股票的最佳时机\",\"link\":\"/rust-leetcode/2019-12-17.html\"},{\"i\":\"84. 柱状图中最大的矩形\",\"date\":\"2019-12-16T03:57:03+08:00\",\"f\":1,\"text\":\"84. 柱状图中最大的矩形\",\"link\":\"/rust-leetcode/2019-12-16.html\"},{\"i\":\"632. 最小区间\",\"date\":\"2019-12-13T03:57:03+08:00\",\"f\":1,\"text\":\"632. 最小区间\",\"link\":\"/rust-leetcode/2019-12-13.html\"},{\"i\":\"560. 和为K的子数组-2\",\"date\":\"2019-12-12T03:57:03+08:00\",\"f\":1,\"text\":\"560. 和为K的子数组-2\",\"link\":\"/rust-leetcode/2019-12-12.html\"},{\"i\":\"560. 和为K的子数组\",\"date\":\"2019-12-11T03:57:03+08:00\",\"f\":1,\"text\":\"560. 和为K的子数组\",\"link\":\"/rust-leetcode/2019-12-11.html\"},{\"i\":\"554. 砖墙\",\"date\":\"2019-12-10T03:57:03+08:00\",\"f\":1,\"text\":\"554. 砖墙\",\"link\":\"/rust-leetcode/2019-12-10.html\"},{\"i\":\"535. TinyURL 的加密与解密\",\"date\":\"2019-12-09T03:57:03+08:00\",\"f\":1,\"text\":\"535. TinyURL 的加密与解密\",\"link\":\"/rust-leetcode/2019-12-09.html\"},{\"i\":\"525. 连续数组\",\"date\":\"2019-12-06T03:57:03+08:00\",\"f\":1,\"text\":\"525. 连续数组\",\"link\":\"/rust-leetcode/2019-12-06.html\"},{\"i\":\"454. 四数相加 II\",\"date\":\"2019-12-05T03:57:03+08:00\",\"f\":1,\"text\":\"454. 四数相加 II\",\"link\":\"/rust-leetcode/2019-12-05.html\"},{\"i\":\"438. 找到字符串中所有字母异位词\",\"date\":\"2019-12-04T03:57:03+08:00\",\"f\":1,\"text\":\"438. 找到字符串中所有字母异位词\",\"link\":\"/rust-leetcode/2019-12-04.html\"},{\"i\":\"30. 串联所有单词的子串\",\"date\":\"2019-12-03T03:57:03+08:00\",\"f\":1,\"text\":\"30. 串联所有单词的子串\",\"link\":\"/rust-leetcode/2019-12-03.html\"},{\"i\":\"463. 岛屿的周长\",\"date\":\"2019-12-02T03:57:03+08:00\",\"f\":1,\"text\":\"463. 岛屿的周长\",\"link\":\"/rust-leetcode/2019-12-02.html\"},{\"i\":\"409. 最长回文串\",\"date\":\"2019-11-29T03:57:03+08:00\",\"f\":1,\"text\":\"409. 最长回文串\",\"link\":\"/rust-leetcode/2019-11-29.html\"},{\"i\":\"389. 找不同\",\"date\":\"2019-11-28T03:57:03+08:00\",\"f\":1,\"text\":\"389. 找不同\",\"link\":\"/rust-leetcode/2019-11-28.html\"},{\"i\":\"290. 单词规律\",\"date\":\"2019-11-27T03:57:03+08:00\",\"f\":1,\"text\":\"290. 单词规律\",\"link\":\"/rust-leetcode/2019-11-27.html\"},{\"i\":\"149. 直线上最多的点数\",\"date\":\"2019-11-26T03:57:03+08:00\",\"f\":1,\"text\":\"149. 直线上最多的点数\",\"link\":\"/rust-leetcode/2019-11-26.html\"},{\"i\":\"1. 两数之和\",\"date\":\"2019-11-25T03:57:03+08:00\",\"f\":1,\"text\":\"1. 两数之和\",\"link\":\"/rust-leetcode/2019-11-25.html\"},{\"i\":\"30. 串联所有单词的子串\",\"date\":\"2019-11-22T03:57:03+08:00\",\"f\":1,\"text\":\"30. 串联所有单词的子串\",\"link\":\"/rust-leetcode/2019-11-22.html\"},{\"i\":\"36. 有效的数独\",\"date\":\"2019-11-21T03:57:03+08:00\",\"f\":1,\"text\":\"36. 有效的数独\",\"link\":\"/rust-leetcode/2019-11-21.html\"},{\"i\":\"49. 字母异位词分组\",\"date\":\"2019-11-20T03:57:03+08:00\",\"f\":1,\"text\":\"49. 字母异位词分组\",\"link\":\"/rust-leetcode/2019-11-20.html\"},{\"i\":\"232. 用栈实现队列\",\"date\":\"2019-11-19T03:57:03+08:00\",\"f\":1,\"text\":\"232. 用栈实现队列\",\"link\":\"/rust-leetcode/2019-11-19.html\"},{\"i\":\"155. 最小栈\",\"date\":\"2019-11-18T03:57:03+08:00\",\"f\":1,\"text\":\"155. 最小栈\",\"link\":\"/rust-leetcode/2019-11-18.html\"},{\"i\":\"220. 存在重复元素 III\",\"date\":\"2019-11-15T03:57:03+08:00\",\"f\":1,\"text\":\"220. 存在重复元素 III\",\"link\":\"/rust-leetcode/2019-11-15.html\"},{\"i\":\"173. 二叉搜索树迭代器\",\"date\":\"2019-11-14T03:57:03+08:00\",\"f\":1,\"text\":\"173. 二叉搜索树迭代器\",\"link\":\"/rust-leetcode/2019-11-14.html\"},{\"i\":\"1145. 二叉树着色游戏\",\"date\":\"2019-11-13T03:57:03+08:00\",\"f\":1,\"text\":\"1145. 二叉树着色游戏\",\"link\":\"/rust-leetcode/2019-11-13.html\"},{\"i\":\"1130. 叶值的最小代价生成树\",\"date\":\"2019-11-12T03:57:03+08:00\",\"f\":1,\"text\":\"1130. 叶值的最小代价生成树\",\"link\":\"/rust-leetcode/2019-11-12.html\"},{\"i\":\"1123. 最深叶节点的最近公共祖先\",\"date\":\"2019-11-11T03:57:03+08:00\",\"f\":1,\"text\":\"1123. 最深叶节点的最近公共祖先\",\"link\":\"/rust-leetcode/2019-11-11.html\"},{\"i\":\"1110. 删点成林\",\"date\":\"2019-11-08T03:57:03+08:00\",\"f\":1,\"text\":\"1110. 删点成林\",\"link\":\"/rust-leetcode/2019-11-08.html\"},{\"i\":\"1104. 二叉树寻路\",\"date\":\"2019-11-07T03:57:03+08:00\",\"f\":1,\"text\":\"1104. 二叉树寻路\",\"link\":\"/rust-leetcode/2019-11-07.html\"},{\"i\":\"1026. 节点与其祖先之间的最大差值\",\"date\":\"2019-11-06T03:57:03+08:00\",\"f\":1,\"text\":\"1026. 节点与其祖先之间的最大差值\",\"link\":\"/rust-leetcode/2019-11-06.html\"},{\"i\":\"1028. 从先序遍历还原二叉树\",\"date\":\"2019-11-05T03:57:03+08:00\",\"f\":1,\"text\":\"1028. 从先序遍历还原二叉树\",\"link\":\"/rust-leetcode/2019-11-05.html\"},{\"i\":\"987. 二叉树的垂序遍历\",\"date\":\"2019-11-04T03:57:03+08:00\",\"f\":1,\"text\":\"987. 二叉树的垂序遍历\",\"link\":\"/rust-leetcode/2019-11-04.html\"},{\"i\":\"958. 二叉树的完全性检验\",\"date\":\"2019-11-01T03:57:03+08:00\",\"f\":1,\"text\":\"958. 二叉树的完全性检验\",\"link\":\"/rust-leetcode/2019-11-01.html\"},{\"i\":\"662. 二叉树最大宽度\",\"date\":\"2019-10-31T03:57:03+08:00\",\"f\":1,\"text\":\"662. 二叉树最大宽度\",\"link\":\"/rust-leetcode/2019-10-31.html\"},{\"i\":\"865. 具有所有最深结点的最小子树-一遍遍历解法\",\"date\":\"2019-10-30T03:57:03+08:00\",\"f\":1,\"text\":\"865. 具有所有最深结点的最小子树-一遍遍历解法\",\"link\":\"/rust-leetcode/2019-10-30.html\"},{\"i\":\"865. 具有所有最深结点的最小子树\",\"date\":\"2019-10-29T03:57:03+08:00\",\"f\":1,\"text\":\"865. 具有所有最深结点的最小子树\",\"link\":\"/rust-leetcode/2019-10-29.html\"},{\"i\":\"1008. 先序遍历构造二叉树\",\"date\":\"2019-10-28T03:57:03+08:00\",\"f\":1,\"text\":\"1008. 先序遍历构造二叉树\",\"link\":\"/rust-leetcode/2019-10-28.html\"},{\"i\":\"919. 完全二叉树插入器\",\"date\":\"2019-10-25T03:57:03+08:00\",\"f\":1,\"text\":\"919. 完全二叉树插入器\",\"link\":\"/rust-leetcode/2019-10-25.html\"},{\"i\":\"889. 根据前序和后序遍历构造二叉树\",\"date\":\"2019-10-24T03:57:03+08:00\",\"f\":1,\"text\":\"889. 根据前序和后序遍历构造二叉树\",\"link\":\"/rust-leetcode/2019-10-24.html\"},{\"i\":\"872. 叶子相似的树\",\"date\":\"2019-10-23T03:57:03+08:00\",\"f\":1,\"text\":\"872. 叶子相似的树\",\"link\":\"/rust-leetcode/2019-10-23.html\"},{\"i\":\"889. 根据前序和后序遍历构造二叉树\",\"date\":\"2019-10-22T03:57:03+08:00\",\"f\":1,\"text\":\"889. 根据前序和后序遍历构造二叉树\",\"link\":\"/rust-leetcode/2019-10-22.html\"},{\"i\":\"863. 二叉树中所有距离为 K 的结点\",\"date\":\"2019-10-21T03:57:03+08:00\",\"f\":1,\"text\":\"863. 二叉树中所有距离为 K 的结点\",\"link\":\"/rust-leetcode/2019-10-21.html\"},{\"i\":\"814. 二叉树剪枝\",\"date\":\"2019-10-19T03:57:03+08:00\",\"f\":1,\"text\":\"814. 二叉树剪枝\",\"link\":\"/rust-leetcode/2019-10-19.html\"},{\"i\":\"701. 二叉搜索树中的插入操作\",\"date\":\"2019-10-18T03:57:03+08:00\",\"f\":1,\"text\":\"701. 二叉搜索树中的插入操作\",\"link\":\"/rust-leetcode/2019-10-18.html\"},{\"i\":\"655. 输出二叉树\",\"date\":\"2019-10-17T03:57:03+08:00\",\"f\":1,\"text\":\"655. 输出二叉树\",\"link\":\"/rust-leetcode/2019-10-17.html\"},{\"i\":\"654. 最大二叉树\",\"date\":\"2019-10-16T03:57:03+08:00\",\"f\":1,\"text\":\"654. 最大二叉树\",\"link\":\"/rust-leetcode/2019-10-16.html\"},{\"i\":\"623. 在二叉树中增加一行\",\"date\":\"2019-10-15T03:57:03+08:00\",\"f\":1,\"text\":\"623. 在二叉树中增加一行\",\"link\":\"/rust-leetcode/2019-10-14.html\"},{\"i\":\"652. 寻找重复的子树\",\"date\":\"2019-10-15T03:57:03+08:00\",\"f\":1,\"text\":\"652. 寻找重复的子树\",\"link\":\"/rust-leetcode/2019-10-15.html\"},{\"i\":\"572. 另一个树的子树\",\"date\":\"2019-10-11T03:57:03+08:00\",\"f\":1,\"text\":\"572. 另一个树的子树\",\"link\":\"/rust-leetcode/2019-10-11.html\"},{\"i\":\"543. 二叉树的直径\\\"\",\"date\":\"2019-10-10T03:57:03+08:00\",\"f\":1,\"text\":\"543. 二叉树的直径\\\"\",\"link\":\"/rust-leetcode/2019-10-10.html\"},{\"i\":\"538. 把二叉搜索树转换为累加树\",\"date\":\"2019-10-09T03:57:03+08:00\",\"f\":1,\"text\":\"538. 把二叉搜索树转换为累加树\",\"link\":\"/rust-leetcode/2019-10-09.html\"},{\"i\":\"538. 把二叉搜索树转换为累加树\",\"date\":\"2019-10-08T03:57:03+08:00\",\"f\":1,\"text\":\"538. 把二叉搜索树转换为累加树\",\"link\":\"/rust-leetcode/2019-10-08.html\"},{\"i\":\"530. 二叉搜索树的最小绝对差\",\"date\":\"2019-09-28T03:57:03+08:00\",\"f\":1,\"text\":\"530. 二叉搜索树的最小绝对差\",\"link\":\"/rust-leetcode/2019-09-28.html\"},{\"i\":\"515. 在每个树行中找最大值\",\"date\":\"2019-09-27T03:57:03+08:00\",\"f\":1,\"text\":\"515. 在每个树行中找最大值\",\"link\":\"/rust-leetcode/2019-09-27.html\"},{\"i\":\"513. 找树左下角的值\",\"date\":\"2019-09-26T03:57:03+08:00\",\"f\":1,\"text\":\"513. 找树左下角的值\",\"link\":\"/rust-leetcode/2019-09-26.html\"},{\"i\":\"337. 打家劫舍 III\",\"date\":\"2019-09-25T03:57:03+08:00\",\"f\":1,\"text\":\"337. 打家劫舍 III\",\"link\":\"/rust-leetcode/2019-09-25.html\"},{\"i\":\"297. 二叉树的序列化与反序列化\",\"date\":\"2019-09-24T03:57:03+08:00\",\"f\":1,\"text\":\"297. 二叉树的序列化与反序列化\",\"link\":\"/rust-leetcode/2019-09-24.html\"},{\"i\":\"257. 二叉树的所有路径\",\"date\":\"2019-09-23T03:57:03+08:00\",\"f\":1,\"text\":\"257. 二叉树的所有路径\",\"link\":\"/rust-leetcode/2019-09-23.html\"},{\"i\":\"230. 二叉搜索树中第K小的元素\",\"date\":\"2019-09-20T03:57:03+08:00\",\"f\":1,\"text\":\"230. 二叉搜索树中第K小的元素\",\"link\":\"/rust-leetcode/2019-09-20.html\"},{\"i\":\"226. 翻转二叉树\",\"date\":\"2019-09-19T03:57:03+08:00\",\"f\":1,\"text\":\"226. 翻转二叉树\",\"link\":\"/rust-leetcode/2019-09-19.html\"},{\"i\":\"199. 二叉树的右视图\",\"date\":\"2019-09-18T03:57:03+08:00\",\"f\":1,\"text\":\"199. 二叉树的右视图\",\"link\":\"/rust-leetcode/2019-09-18.html\"},{\"i\":\"124. 二叉树中的最大路径和-等效,但是更清晰\",\"date\":\"2019-09-17T03:57:03+08:00\",\"f\":1,\"text\":\"124. 二叉树中的最大路径和-等效,但是更清晰\",\"link\":\"/rust-leetcode/2019-09-17.html\"},{\"i\":\"124. 二叉树中的最大路径和-逻辑混乱的方法\",\"date\":\"2019-09-16T03:57:03+08:00\",\"f\":1,\"text\":\"124. 二叉树中的最大路径和-逻辑混乱的方法\",\"link\":\"/rust-leetcode/2019-09-16.html\"},{\"i\":\"129. 求根到叶子节点数字之和\",\"date\":\"2019-09-13T03:57:03+08:00\",\"f\":1,\"text\":\"129. 求根到叶子节点数字之和\",\"link\":\"/rust-leetcode/2019-09-13.html\"},{\"i\":\"144. 二叉树的前序遍历\",\"date\":\"2019-09-12T03:57:03+08:00\",\"f\":1,\"text\":\"144. 二叉树的前序遍历\",\"link\":\"/rust-leetcode/2019-09-12.html\"},{\"i\":\"113. 路径总和 II\",\"date\":\"2019-09-11T03:57:03+08:00\",\"f\":1,\"text\":\"113. 路径总和 II\",\"link\":\"/rust-leetcode/2019-09-11.html\"},{\"i\":\"112. 路径总和\",\"date\":\"2019-09-10T03:57:03+08:00\",\"f\":1,\"text\":\"112. 路径总和\",\"link\":\"/rust-leetcode/2019-09-10.html\"},{\"i\":\"111. 二叉树的最小深度\",\"date\":\"2019-09-09T03:57:03+08:00\",\"f\":1,\"text\":\"111. 二叉树的最小深度\",\"link\":\"/rust-leetcode/2019-09-09.html\"},{\"i\":\"110. 平衡二叉树\",\"date\":\"2019-09-06T03:57:03+08:00\",\"f\":1,\"text\":\"110. 平衡二叉树\",\"link\":\"/rust-leetcode/2019-09-06.html\"},{\"i\":\"108. 将有序数组转换为二叉搜索树\",\"date\":\"2019-09-05T03:57:03+08:00\",\"f\":1,\"text\":\"108. 将有序数组转换为二叉搜索树\",\"link\":\"/rust-leetcode/2019-09-05.html\"},{\"i\":\"101. 对称二叉树\",\"date\":\"2019-09-04T03:57:03+08:00\",\"f\":1,\"text\":\"101. 对称二叉树\",\"link\":\"/rust-leetcode/2019-09-04.html\"},{\"i\":\"100. 相同的树\",\"date\":\"2019-09-03T03:57:03+08:00\",\"f\":1,\"text\":\"100. 相同的树\",\"link\":\"/rust-leetcode/2019-09-03.html\"},{\"i\":\"99. 恢复二叉搜索树\",\"date\":\"2019-09-02T03:57:03+08:00\",\"f\":1,\"text\":\"99. 恢复二叉搜索树\",\"link\":\"/rust-leetcode/2019-09-02.html\"},{\"i\":\"107. 二叉树的层次遍历 II\",\"date\":\"2019-08-30T03:57:03+08:00\",\"f\":1,\"text\":\"107. 二叉树的层次遍历 II\",\"link\":\"/rust-leetcode/2019-08-30.html\"},{\"i\":\"104. 二叉树的最大深度\",\"date\":\"2019-08-29T03:57:03+08:00\",\"f\":1,\"text\":\"104. 二叉树的最大深度\",\"link\":\"/rust-leetcode/2019-08-29.html\"},{\"i\":\"103. 二叉树的锯齿形层次遍历\",\"date\":\"2019-08-28T03:57:03+08:00\",\"f\":1,\"text\":\"103. 二叉树的锯齿形层次遍历\",\"link\":\"/rust-leetcode/2019-08-28.html\"},{\"i\":\"102. 二叉树的层次遍历\",\"date\":\"2019-08-27T03:57:03+08:00\",\"f\":1,\"text\":\"102. 二叉树的层次遍历\",\"link\":\"/rust-leetcode/2019-08-27.html\"},{\"i\":\"641. 设计循环双端队列\",\"date\":\"2019-08-26T03:57:03+08:00\",\"f\":1,\"text\":\"641. 设计循环双端队列\",\"link\":\"/rust-leetcode/2019-08-26.html\"},{\"i\":\"29. 两数相除\",\"date\":\"2019-08-23T03:57:03+08:00\",\"f\":1,\"text\":\"29. 两数相除\",\"link\":\"/rust-leetcode/2019-08-23.html\"},{\"i\":\"925. 长按键入\",\"date\":\"2019-08-22T03:57:03+08:00\",\"f\":1,\"text\":\"925. 长按键入\",\"link\":\"/rust-leetcode/2019-08-22.html\"},{\"i\":\"713. 乘积小于K的子数组\",\"date\":\"2019-08-21T03:57:03+08:00\",\"f\":1,\"text\":\"713. 乘积小于K的子数组\",\"link\":\"/rust-leetcode/2019-08-21.html\"},{\"i\":\"146. LRU缓存机制-O(1)\",\"date\":\"2019-08-20T03:57:03+08:00\",\"f\":1,\"text\":\"146. LRU缓存机制-O(1)\",\"link\":\"/rust-leetcode/2019-08-20.html\"},{\"i\":\"146. LRU缓存机制\",\"date\":\"2019-08-19T03:57:03+08:00\",\"f\":1,\"text\":\"146. LRU缓存机制\",\"link\":\"/rust-leetcode/2019-08-19.html\"},{\"i\":\"402. 移掉K位数字\",\"date\":\"2019-08-18T03:57:03+08:00\",\"f\":1,\"text\":\"402. 移掉K位数字\",\"link\":\"/rust-leetcode/2019-08-18.html\"},{\"i\":\"106. 从中序与后序遍历序列构造二叉树\",\"date\":\"2019-08-17T03:57:03+08:00\",\"f\":1,\"text\":\"106. 从中序与后序遍历序列构造二叉树\",\"link\":\"/rust-leetcode/2019-08-17.html\"},{\"i\":\"105. 从前序与中序遍历序列构造二叉树\",\"date\":\"2019-08-16T03:57:03+08:00\",\"f\":1,\"text\":\"105. 从前序与中序遍历序列构造二叉树\",\"link\":\"/rust-leetcode/2019-08-16.html\"},{\"i\":\"114. 二叉树展开为链表\",\"date\":\"2019-08-15T03:57:03+08:00\",\"f\":1,\"text\":\"114. 二叉树展开为链表\",\"link\":\"/rust-leetcode/2019-08-15.html\"},{\"i\":\"120. 三角形最小路径和\",\"date\":\"2019-08-14T03:57:03+08:00\",\"f\":1,\"text\":\"120. 三角形最小路径和\",\"link\":\"/rust-leetcode/2019-08-14.html\"},{\"i\":\"704. 二分查找\",\"date\":\"2019-08-13T03:57:03+08:00\",\"f\":1,\"text\":\"704. 二分查找\",\"link\":\"/rust-leetcode/2019-08-13.html\"},{\"i\":\"145. 二叉树的后序遍历\",\"date\":\"2019-08-12T11:57:03+08:00\",\"f\":1,\"text\":\"145. 二叉树的后序遍历\",\"link\":\"/rust-leetcode/2019-08-12.html\"},{\"i\":\"94. 二叉树的中序遍历-非递归方式\",\"date\":\"2019-08-11T11:57:03+08:00\",\"f\":1,\"text\":\"94. 二叉树的中序遍历-非递归方式\",\"link\":\"/rust-leetcode/2019-08-11.html\"},{\"i\":\"94. 二叉树的中序遍历\",\"date\":\"2019-08-10T11:57:03+08:00\",\"f\":1,\"text\":\"94. 二叉树的中序遍历\",\"link\":\"/rust-leetcode/2019-08-10.html\"},{\"i\":\"60. 第k个排列\",\"date\":\"2019-08-04T09:57:03+08:00\",\"f\":1,\"text\":\"60. 第k个排列\",\"link\":\"/rust-leetcode/2019-08-04.html\"},{\"i\":\"32. 最长有效括号\",\"date\":\"2019-06-18T11:57:03+08:00\",\"f\":1,\"text\":\"32. 最长有效括号\",\"link\":\"/rust-leetcode/2019-06-18.html\"},{\"i\":\"98. 验证二叉搜索树\",\"date\":\"2019-06-17T11:57:03+08:00\",\"f\":1,\"text\":\"98. 验证二叉搜索树\",\"link\":\"/rust-leetcode/2019-06-17.html\"},{\"i\":\"222. 完全二叉树的节点个数\",\"date\":\"2019-06-15T11:57:03+08:00\",\"f\":1,\"text\":\"222. 完全二叉树的节点个数\",\"link\":\"/rust-leetcode/2019-06-15.html\"},{\"i\":\"380. 常数时间插入、删除和获取随机元素\",\"date\":\"2019-06-14T11:57:03+08:00\",\"f\":1,\"text\":\"380. 常数时间插入、删除和获取随机元素\",\"link\":\"/rust-leetcode/2019-06-14.html\"},{\"i\":\"47. 全排列 II\",\"date\":\"2019-06-11T11:57:03+08:00\",\"f\":1,\"text\":\"47. 全排列 II\",\"link\":\"/rust-leetcode/2019-06-11.html\"},{\"i\":\"71. 简化路径\",\"date\":\"2019-06-10T11:57:03+08:00\",\"f\":1,\"text\":\"71. 简化路径\",\"link\":\"/rust-leetcode/2019-06-10.html\"},{\"i\":\"91. 解码方法\",\"date\":\"2019-06-08T11:57:03+08:00\",\"f\":1,\"text\":\"91. 解码方法\",\"link\":\"/rust-leetcode/2019-06-08.html\"},{\"i\":\"622. 设计循环队列\",\"date\":\"2019-06-07T11:57:03+08:00\",\"f\":1,\"text\":\"622. 设计循环队列\",\"link\":\"/rust-leetcode/2019-06-07.html\"},{\"i\":\"96. 不同的二叉搜索树\",\"date\":\"2019-06-06T11:57:03+08:00\",\"f\":1,\"text\":\"96. 不同的二叉搜索树\",\"link\":\"/rust-leetcode/2019-06-06.html\"},{\"i\":\"字形变换\",\"date\":\"2019-06-06T03:57:03+08:00\",\"f\":1,\"text\":\"字形变换\",\"link\":\"/rust-leetcode/模板.html\"},{\"i\":\"5. 最长回文子串-另一种解法\",\"date\":\"2019-06-05T11:57:03+08:00\",\"f\":1,\"text\":\"5. 最长回文子串-另一种解法\",\"link\":\"/rust-leetcode/2019-06-05.html\"},{\"i\":\"5. 最长回文子串\",\"date\":\"2019-06-04T11:57:03+08:00\",\"f\":1,\"text\":\"5. 最长回文子串\",\"link\":\"/rust-leetcode/2019-06-04.html\"},{\"i\":\"109. 有序链表转换二叉搜索树\",\"date\":\"2019-06-03T11:57:03+08:00\",\"f\":1,\"text\":\"109. 有序链表转换二叉搜索树\",\"link\":\"/rust-leetcode/2019-06-03.html\"},{\"i\":\"6. Z 字形变换\",\"date\":\"2019-06-02T11:57:03+08:00\",\"f\":1,\"text\":\"6. Z 字形变换\",\"link\":\"/rust-leetcode/2019-06-02.html\"},{\"i\":\"2. 两数相加\",\"date\":\"2019-06-01T11:57:03+08:00\",\"f\":1,\"text\":\"2. 两数相加\",\"link\":\"/rust-leetcode/2019-06-01.html\"}],\"/rust/\":[{\"i\":\"rust中函数指针作为全局变量使用\",\"date\":\"2022-08-01T05:29:51+00:00\",\"f\":1,\"text\":\"rust中函数指针作为全局变量使用\",\"link\":\"/rust/rust_global_function_pointer.html\"},{\"i\":\"我对rust atomic的理解\",\"date\":\"2022-01-04T21:57:03+08:00\",\"f\":1,\"text\":\"我对rust atomic的理解\",\"link\":\"/rust/rust_atomic.html\"},{\"i\":\"Rust异步编程中我们应该用那种锁?\",\"date\":\"2020-12-31T11:57:03+08:00\",\"f\":1,\"text\":\"Rust异步编程中我们应该用那种锁?\",\"link\":\"/rust/rust_async_lock.html\"},{\"i\":\"Rust中enum和整数的互相转换\",\"date\":\"2020-12-03T07:57:03+08:00\",\"f\":1,\"text\":\"Rust中enum和整数的互相转换\",\"link\":\"/rust/convert_an_integer_to_an_enum.html\"},{\"i\":\"200行代码讲透Rust Futures的问题\",\"date\":\"2020-04-13T11:57:03+08:00\",\"f\":1,\"text\":\"200行代码讲透Rust Futures的问题\",\"link\":\"/rust/Futures_Explained_in_200_lines_of_Rust2.html\"},{\"i\":\"从头实现Rust异步执行器\",\"date\":\"2020-04-13T11:57:03+08:00\",\"f\":1,\"text\":\"从头实现Rust异步执行器\",\"link\":\"/rust/build_your_own_executor.html\"},{\"i\":\"从头实现Rust异步block_on\",\"date\":\"2020-04-12T11:57:03+08:00\",\"f\":1,\"text\":\"从头实现Rust异步block_on\",\"link\":\"/rust/build_your_own_block_on.html\"},{\"i\":\"200行代码讲透Rust Futures\",\"date\":\"2020-04-09T11:57:03+08:00\",\"f\":1,\"text\":\"200行代码讲透Rust Futures\",\"link\":\"/rust/Futures_Explained_in_200_lines_of_Rust.html\"},{\"i\":\"200行代码讲透Rust Futures-有bug版本\",\"date\":\"2020-04-09T11:57:03+08:00\",\"f\":1,\"text\":\"200行代码讲透Rust Futures-有bug版本\",\"link\":\"/rust/Futures_Explained_in_200_lines_of_Rust_with_error_version.html\"},{\"i\":\"Rust无锁编程\",\"date\":\"2020-03-16T11:57:03+08:00\",\"f\":1,\"text\":\"Rust无锁编程\",\"link\":\"/rust/lock-freedom-without-garbage-collection.html\"},{\"i\":\"rust开发工具 clion\",\"date\":\"2020-01-12T11:57:03+08:00\",\"f\":1,\"text\":\"rust开发工具 clion\",\"link\":\"/rust/rust开发工具.html\"},{\"i\":\"tokio async&await 初探\",\"date\":\"2019-12-05T03:57:03+08:00\",\"f\":1,\"text\":\"tokio async&await 初探\",\"link\":\"/rust/tokio_async_await 初探.html\"},{\"i\":\"在ubuntu 18.04上交叉编译rust 程序\",\"date\":\"2019-10-30T11:57:03+08:00\",\"f\":1,\"text\":\"在ubuntu 18.04上交叉编译rust 程序\",\"link\":\"/rust/交叉编译rust.html\"},{\"i\":\"tokio笔记.md\",\"date\":\"2019-07-03T11:57:03+08:00\",\"f\":1,\"text\":\"tokio笔记.md\",\"link\":\"/rust/tokio笔记.html\"},{\"i\":\"Ownership 101\",\"date\":\"2019-05-01T11:57:03+08:00\",\"f\":1,\"text\":\"Ownership 101\",\"link\":\"/rust/ownership101.html\"},{\"i\":\"rust学习笔记\",\"date\":\"2019-04-03T11:57:03+08:00\",\"f\":1,\"text\":\"rust学习笔记\",\"link\":\"/rust/my_note.html\"},{\"i\":\"从零实现消息中间件\",\"l\":\"/rust/rnats/\",\"date\":\"2019-01-30T11:57:03+08:00\",\"text\":\"从零实现消息中间件\",\"link\":\"/rust/rnats/\",\"children\":[{\"i\":\"从零实现消息中间件-client\",\"date\":\"2020-02-20T09:57:03+08:00\",\"f\":1,\"text\":\"从零实现消息中间件-client\",\"link\":\"/rust/rnats/6.client.html\"},{\"i\":\"从零实现消息中间件-server\",\"date\":\"2020-02-06T09:57:03+08:00\",\"f\":1,\"text\":\"从零实现消息中间件-server\",\"link\":\"/rust/rnats/4.server.html\"},{\"i\":\"从零实现消息中间件-sublist\",\"date\":\"2020-02-05T09:57:03+08:00\",\"f\":1,\"text\":\"从零实现消息中间件-sublist\",\"link\":\"/rust/rnats/3.sublist.html\"},{\"i\":\"从零实现消息中间件\",\"date\":\"2020-01-31T09:57:03+08:00\",\"f\":1,\"text\":\"从零实现消息中间件\",\"link\":\"/rust/rnats/1.start.html\"},{\"i\":\"从零实现消息中间件-parser\",\"date\":\"2020-01-31T09:57:03+08:00\",\"f\":1,\"text\":\"从零实现消息中间件-parser\",\"link\":\"/rust/rnats/2.parser.html\"},{\"i\":\"从零实现消息中间件-server.client\",\"date\":\"2020-01-31T09:57:03+08:00\",\"f\":1,\"text\":\"从零实现消息中间件-server.client\",\"link\":\"/rust/rnats/5.server.client.html\"},{\"i\":\"rnats ppt\",\"l\":\"/rust/rnats/ppt/\",\"date\":\"2020-01-31T09:57:03+08:00\",\"text\":\"rnats ppt\",\"link\":\"/rust/rnats/ppt/\",\"children\":[{\"i\":\"从零实现消息中间件-client\",\"date\":\"2020-01-31T09:57:03+08:00\",\"f\":1,\"text\":\"从零实现消息中间件-client\",\"link\":\"/rust/rnats/ppt/从零实现消息中间件-client.html\"},{\"i\":\"从零实现消息中间件-server.client\",\"date\":\"2020-01-31T09:57:03+08:00\",\"f\":1,\"text\":\"从零实现消息中间件-server.client\",\"link\":\"/rust/rnats/ppt/从零实现消息中间件-server.client.html\"},{\"i\":\"从零实现消息中间件-server\",\"date\":\"2020-01-31T09:57:03+08:00\",\"f\":1,\"text\":\"从零实现消息中间件-server\",\"link\":\"/rust/rnats/ppt/从零实现消息中间件-server.html\"}]}]}],\"/other/\":[{\"i\":\"rcore实验记录\",\"date\":\"2022-07-31T11:06:23+08:00\",\"f\":1,\"text\":\"rcore实验记录\",\"link\":\"/other/rcore_os_program.html\"},{\"i\":\"go语言的内存模型\",\"date\":\"2022-05-30T11:06:23+08:00\",\"f\":1,\"text\":\"go语言的内存模型\",\"link\":\"/other/go_memory_model.html\"},{\"i\":\"移植一个c项目到WebAssembly的体验\",\"date\":\"2022-03-28T11:06:23+08:00\",\"f\":1,\"text\":\"移植一个c项目到WebAssembly的体验\",\"link\":\"/other/webassembly_two_days_exercise.html\"},{\"i\":\"一个实用的分布式Go任务处理库\",\"date\":\"2022-01-29T05:29:51+00:00\",\"f\":1,\"text\":\"一个实用的分布式Go任务处理库\",\"link\":\"/other/asynq_introduction.html\"},{\"i\":\"opc 统一架构学习笔记\",\"date\":\"2022-01-08T01:19:42.000Z\",\"f\":1,\"text\":\"opc 统一架构学习笔记\",\"link\":\"/other/opc 统一架构学习笔记.html\"},{\"i\":\"opcua_cross_compile_for_raspeberry\",\"date\":\"2022-01-08T01:19:42.000Z\",\"f\":1,\"text\":\"opcua_cross_compile_for_raspeberry\",\"link\":\"/other/opcua_cross_compile_for_raspeberry.html\"},{\"i\":\"工具列表\",\"date\":\"2022-01-08T01:19:42.000Z\",\"f\":1,\"text\":\"工具列表\",\"link\":\"/other/工作中常用工具入门.html\"},{\"i\":\"typescript的一些高级语法\",\"date\":\"2022-01-010T21:57:03+08:00\",\"f\":1,\"text\":\"typescript的一些高级语法\",\"link\":\"/other/typescript_advanced_syntax.html\"},{\"i\":\"opcua Rust版本学习-client\",\"date\":\"2020-10-20T09:48:12+00:00\",\"f\":1,\"text\":\"opcua Rust版本学习-client\",\"link\":\"/other/opcua-rust.html\"},{\"i\":\"Windows下Hook C++ DLL\",\"date\":\"2020-10-15T11:06:23+08:00\",\"f\":1,\"text\":\"Windows下Hook C++ DLL\",\"link\":\"/other/windows_hook_thiscall.html\"},{\"i\":\"抛弃过时的SourceInsight 使用clion阅读linux内核代码\",\"date\":\"2020-08-25T07:06:23+08:00\",\"f\":1,\"text\":\"抛弃过时的SourceInsight 使用clion阅读linux内核代码\",\"link\":\"/other/read_kerenel_use_clion.html\"},{\"i\":\"grpcox教程\",\"date\":\"2020-08-22T11:06:23+08:00\",\"f\":1,\"text\":\"grpcox教程\",\"link\":\"/other/grpcox.html\"},{\"i\":\"ubuntu apt 安装指定版本的软件\",\"date\":\"2020-07-01T05:29:51+00:00\",\"f\":1,\"text\":\"ubuntu apt 安装指定版本的软件\",\"link\":\"/other/apt安装指定版本软件.html\"},{\"i\":\"高性能系统中使用go的注意事项\",\"date\":\"2019-12-25T07:06:23+08:00\",\"f\":1,\"text\":\"高性能系统中使用go的注意事项\",\"link\":\"/other/高性能go开发.html\"},{\"i\":\"hugo 博客写作技巧\",\"date\":\"2019-07-30T11:06:23+08:00\",\"f\":1,\"text\":\"hugo 博客写作技巧\",\"link\":\"/other/hugo博客写作.html\"},{\"i\":\"git以及github回退到指定版本\",\"date\":\"2019-06-30T11:06:23+08:00\",\"f\":1,\"text\":\"git以及github回退到指定版本\",\"link\":\"/other/git以及github回退.html\"},{\"i\":\"如何在mac上使用wireshark对安卓设备进行抓包\",\"date\":\"2019-06-28T07:06:23+08:00\",\"f\":1,\"text\":\"如何在mac上使用wireshark对安卓设备进行抓包\",\"link\":\"/other/capture_with_wireshark_for_android.html\"},{\"i\":\"使用clion调试开发比特币源码\",\"date\":\"2019-06-28T07:06:23+08:00\",\"f\":1,\"text\":\"使用clion调试开发比特币源码\",\"link\":\"/other/使用clion调试开发比特币源码.html\"},{\"i\":\"crossOver source insight 4.0使用\",\"date\":\"2019-05-10T02:23:17.437575+00:00\",\"f\":1,\"text\":\"crossOver source insight 4.0使用\",\"link\":\"/other/crossOver source insight 4.0使用.html\"},{\"i\":\"五个goland进行go开发的小技巧\",\"date\":\"2019-05-09T00:59:35.138044+00:00\",\"f\":1,\"text\":\"五个goland进行go开发的小技巧\",\"link\":\"/other/五个goland进行go开发的小技巧.html\"},{\"i\":\"brew安装指定版本boost\",\"date\":\"2019-03-22T05:29:51+00:00\",\"f\":1,\"text\":\"brew安装指定版本boost\",\"link\":\"/other/brew安装指定版本boost.html\"},{\"i\":\"不用外部插件启用u盘ntfs写功能\",\"date\":\"2018-11-23T06:01:02+00:00\",\"f\":1,\"text\":\"不用外部插件启用u盘ntfs写功能\",\"link\":\"/other/不用外部插件启用u盘ntfs写功能.html\"},{\"i\":\"使用ubuntu搭建时间机器备份服务\",\"date\":\"2018-11-20T04:15:04+00:00\",\"f\":1,\"text\":\"使用ubuntu搭建时间机器备份服务\",\"link\":\"/other/使用ubuntu搭建时间机器备份服务.html\"},{\"i\":\"learningPythonV4\",\"date\":\"2018-10-08T09:48:12+00:00\",\"f\":1,\"text\":\"learningPythonV4\",\"link\":\"/other/learningPythonV4.html\"},{\"i\":\"用 go 写 WebAssembly入门\",\"date\":\"2018-09-07T01:14:10+00:00\",\"f\":1,\"text\":\"用 go 写 WebAssembly入门\",\"link\":\"/other/用 go 写 WebAssembly入门.html\"},{\"i\":\"阈值签名笔记\",\"date\":\"2018-09-07T01:14:10+00:00\",\"f\":1,\"text\":\"阈值签名笔记\",\"link\":\"/other/阈值签名.html\"},{\"i\":\"一条命令深度清理你的mac\",\"date\":\"2018-05-01T11:06:23+08:00\",\"f\":1,\"text\":\"一条命令深度清理你的mac\",\"link\":\"/other/clean_mac.html\"},{\"i\":\"go 笔记\",\"date\":\"2018-04-28T11:06:23+08:00\",\"f\":1,\"text\":\"go 笔记\",\"link\":\"/other/learn_go.html\"},{\"i\":\"修改vscode caipeiyu.writeCnblog ,简化博客发布\",\"date\":\"2018-04-26T11:06:23+08:00\",\"f\":1,\"text\":\"修改vscode caipeiyu.writeCnblog ,简化博客发布\",\"link\":\"/other/vscode_cnblog_plugin.html\"}]}},\"locales\":{},\"scrollOffset\":90,\"cleanUrls\":false}")</script>
    
  </body>
</html>